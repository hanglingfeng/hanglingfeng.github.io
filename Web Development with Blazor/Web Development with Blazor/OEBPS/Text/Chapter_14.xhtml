<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en-US" xml:lang="en-US">
  <head>
    <title>Chapter_14</title>
    <!-- kobo-style -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../../stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="../../page_styles.css"/>
</head>
  <body id="Chapter_14" class="calibre">
<div class="calibre1" id="_idContainer064">
<h1 class="chapternumber"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.1.1">14</span></h1>
<h1 class="chaptertitle" id="_idParaDest-232"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.2.1">Deploying to Production</span></h1>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.3.1">In this chapter, we will take a look at the different options we have when deploying our Blazor application to production. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.3.2">Since there are many different options, going through them all would be a book all by itself.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.4.1">We won’t go into detail but rather cover the different things we need to think about so that we can deploy to any provider.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.5.1">In the end, deploying is what we need to do to make use of what we build.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.6.1">In this chapter, we will cover the following:</span></p>
<ul class="calibre4">
<li class="bulletlist"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.7.1">Continuous delivery options</span></li>
<li class="bulletlist1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.8.1">Hosting options</span></li>
</ul>
<h1 class="heading" id="_idParaDest-233"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.9.1">Technical requirements</span></h1>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.10.1">This chapter is about general deployment, so we won’t need any code.</span></p>
<h1 class="heading" id="_idParaDest-234"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.11.1">Continuous delivery options</span></h1>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.12.1">When </span><a id="_idIndexMarker548" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.13.1">deploying anything to production, we should think about making sure to remove uncertain factors. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.13.2">For example, if we are deploying from our own machine, how do we know it’s the latest version? </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.13.3">How do we know that our teammates didn’t recently solve a problem and we don’t have the fix in our branch? </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.13.4">To be honest, how do we even know that the version in source control is the same in production, or if the version in production even exists in source control? </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.13.5">You know the old saying: “Friends don’t let friends right-click and publish” (to production, that is)?</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.14.1">This is where </span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.15.1">Continuous Integration</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.16.1"> and </span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.17.1">Continuous Delivery/Deployment</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.18.1"> (</span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.19.1">CI/CD</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.20.1">) come into the picture. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.20.2">We make</span><a id="_idIndexMarker549" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.21.1"> sure that something else makes the deployment to production. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.21.2">Entire books could be written on deployment, so we won’t go that deep into the subject.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.22.1">GitHub Actions and Azure DevOps (or Azure Pipelines) are two products from Microsoft for CI/CD. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.22.2">There are many more, such as Jenkins, TeamCity, and GitLab – the list is long. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.22.3">If the CI/CD system we are currently using supports deploying ASP.NET, it will be able to handle Blazor because, in the end, Blazor is just an ASP.NET site.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.23.1">If we have tests (which we should have), we should also make sure to set up tests as part of our CI/CD pipeline. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.23.2">The nice thing is that we don’t need to add any specific hardware to test our components; it will work if our CI/CD pipeline can run unit tests.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.24.1">Since Blazor is</span><a id="_idIndexMarker550" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.25.1"> ASP.NET, nothing is stopping us from going even further with the automated testing of our site.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.26.1">There is also something </span><a id="_idIndexMarker551" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.27.1">called </span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.28.1">wasm-tools</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.29.1">, which we will take a look at in </span><em class="italic"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.30.1">Chapter 16</span></em><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.31.1">, </span><em class="italic"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.32.1">Going Deeper into WebAssembly</span></em><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.33.1">.</span></p>
<h1 class="heading" id="_idParaDest-235"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.34.1">Hosting options</span></h1>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.35.1">When it comes to hosting Blazor, there are many options. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.35.2">Any cloud service that can host ASP.NET Core sites should be able to run Blazor without any problems.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.36.1">We need to think about some things, so let’s go through the options one by one.</span></p>
<h2 class="heading1" id="_idParaDest-236"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.37.1">Hosting Blazor Server/InteractiveServer</span></h2>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.38.1">If the cloud provider </span><a id="_idIndexMarker552" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.39.1">can enable/disable WebSockets, we want to </span><a id="_idIndexMarker553" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.40.1">enable them since that’s the protocol used by SignalR.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.41.1">Sometimes, the cloud provider may support .NET Core 3.x but not .NET 8 out of the box. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.41.2">But don’t worry; by making sure to publish our application with the deployment mode as self-contained, we make sure the deployment also adds any files necessary to run the project (this might not be true for all hosting providers).</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.42.1">This is also a good thing to do to make sure that we are running on the exact framework version we expect.</span></p>
<h2 class="heading1" id="_idParaDest-237"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.43.1">Hosting InteractiveWebAssembly</span></h2>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.44.1">InteractiveWebAssembly is using </span><a id="_idIndexMarker554" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.45.1">a .NET Core backend (like we do for the blog), we are hosting a .NET Core website, so the same rules apply as with hosting </span><a id="_idIndexMarker555" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.46.1">Blazor Server. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.46.2">For our blog, we also added SignalR, so we need WebSockets enabled as well.</span></p>
<h2 class="heading1" id="_idParaDest-238"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.47.1">Hosting Blazor WebAssembly Standalone </span></h2>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.48.1">If we are using the Blazor</span><a id="_idIndexMarker556" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.49.1"> WebAssembly Standalone</span><a id="_idIndexMarker557" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.50.1"> template, we don’t need to think about .NET Core hosting. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.50.2">We can host our application in Azure Static Web Apps or even GitHub Pages. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.50.3">This is one of the upsides of doing a Blazor WebAssembly Standalone site.</span></p>
<h2 class="heading1" id="_idParaDest-239"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.51.1">Hosting on IIS</span></h2>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.52.1">We can also host our application </span><a id="_idIndexMarker558" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.53.1">on </span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.54.1">Internet Information Server</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.55.1"> (</span><strong class="screentext"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.56.1">IIS</span></strong><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.57.1">). </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.57.2">Install the</span><a id="_idIndexMarker559" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.58.1"> hosting bundle, and</span><a id="_idIndexMarker560" class="calibre3"></a><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.59.1"> it will also make sure to include the ASP.NET Core IIS module if installed on a machine with IIS.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.60.1">You need to make sure to enable the WebSocket protocol on the server.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.61.1">We currently run our sites on IIS and use Azure DevOps to deploy our sites. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.61.2">Since we are using Blazor Server, the downtime is very evident. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.61.3">As soon as the web loses the SignalR connection, the site will display a reconnect message.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.62.1">For the sites we are using, there are about 8 to 10 seconds of downtime when deploying a new version, which is pretty quick.</span></p>
<h1 class="heading" id="_idParaDest-240"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.63.1">Summary</span></h1>
<p class="normal"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.64.1">In this chapter, we talked about why we should use CI/CD since it makes a huge difference in ensuring the quality of the application. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.64.2">We looked at some of the things we need to do to run our Blazor app on any cloud provider supporting .NET 8.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.65.1">Deploying is perhaps the most important step when it comes to an application. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.65.2">Without deploying our application, it’s just code. </span><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.65.3">With the things we mentioned in this chapter, such as CI/CD, hosting, and deployment, we are now ready to deploy the code.</span></p>
<p class="normal1"><span xmlns="http://www.w3.org/1999/xhtml" class="kobospan" id="kobo.66.1">In the next chapter, we will dig deeper into how we can port a current site, use Blazor with other technologies, or use other technologies with Blazor.</span></p>
</div>
</body>
</html>
