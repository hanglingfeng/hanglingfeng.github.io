<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
  <title>Chapter_18</title>
  <link href="../Styles/syntax-highlighting.css" rel="stylesheet" type="text/css"/>
  <link href="../Styles/epub.css" rel="stylesheet" type="text/css"/>
</head>

<body id="Chapter_18" lang="en-US" xml:lang="en-US">
  <div id="_idContainer100" class="Basic-Text-Frame">
    <h1 class="chapterNumber">18</h1>
    <h1 id="_idParaDest-276" class="chapterTitle">Visiting .NET MAUI</h1>
    <p class="normal">So far, we have talked about Blazor WebAssembly and Blazor Server, but what about the third option?</p>
    <p class="normal">In this chapter, we will visit <strong class="keyWord">.NET MAUI</strong>, Microsoft’s new cross-platform development platform.</p>
    <p class="normal">This chapter will not be a deep dive into .NET MAUI, since that can be a book all in itself.</p>
    <p class="normal">In this chapter, we will cover the following:</p>
    <ul>
      <li class="bulletList">What is .NET MAUI?</li>
      <li class="bulletList">Creating a new project</li>
      <li class="bulletList">Looking at the template</li>
      <li class="bulletList">Developing for Android</li>
      <li class="bulletList">Developing for iOS</li>
      <li class="bulletList">Developing for macOS</li>
      <li class="bulletList">Developing for Windows</li>
      <li class="bulletList">Developing for Tizen</li>
    </ul>
    <p class="normal">The idea for this chapter is for you to use it as a reference, so that you will be able to implement a new project on your own.</p>
    <h1 id="_idParaDest-277" class="heading-1">Technical requirements</h1>
    <p class="normal">This chapter is a reference chapter and is not connected in any way with the book’s other chapters.</p>
    <p class="normal">You can find the source code for this chapter at <a href="https://github.com/PacktPublishing/Web-Development-with-Blazor-Second-Edition/tree/main/Chapter18"><span class="url">https://github.com/PacktPublishing/Web-Development-with-Blazor-Second-Edition/tree/main/Chapter18</span></a>.</p>
    <h1 id="_idParaDest-278" class="heading-1">What is .NET MAUI?</h1>
    <p class="normal">We’ll start with a bit of history.</p>
    <p class="normal">Xamarin<a id="_idIndexMarker625"></a> is a software company founded in May 2011 by the engineers who created Mono, a free and open-source version of .NET Framework. Microsoft acquired the company in 2016 and it is now a vital part of the .NET development platform, providing tools and services for building native cross-platform mobile apps using C# and .NET. Xamarin’s technology allows developers to write native iOS, Android, and Windows apps using a single shared code base, making it easier to develop and maintain apps for multiple platforms.</p>
    <p class="normal">.NET <strong class="keyWord">MAUI</strong> (<strong class="keyWord">Multi-Platform App UI</strong>) is the<a id="_idIndexMarker626"></a> new framework from Microsoft, which is an evolution of Xamarin.Forms.</p>
    <p class="normal">This is a way to create one UI, deploy it to many different platforms, and get native controls on each platform. .NET MAUI can also host Blazor, which is called Blazor Hybrid. We will not get native controls when we use Blazor Hybrid. It will render web content.</p>
    <p class="normal">Many years ago, I sat in a meeting with a bunch of consultants. The company I was working for wanted to invest in an app, and we turned to one of the big consultancy firms in Sweden to get some help on how we should proceed.</p>
    <p class="normal">After a week, we had another meeting where they presented their findings. Their recommendation was to build natively and not use any of the cross-platform frameworks.</p>
    <p class="normal">They had a bunch of arguments, but two that really stuck with me are as follows:</p>
    <ul>
      <li class="bulletList">Native apps look better and give the user a “real” device experience.</li>
      <li class="bulletList">Shared code (between platforms) means that if one platform has a bug, the same bug is now in all platforms.</li>
    </ul>
    <p class="normal">Since .NET MAUI (formerly Xamarin.Forms) uses native controls, there is no way for the users to know the difference between developing a native app and developing using .NET MAUI. In the end it will look and feel like a native app. This is not true for Blazor Hybrid, which uses web controls. So there are some valid arguments for the first point. Now, we must ask ourselves, how important is that native look and feel? Looking at the apps on my iPhone, not many apps look the same, so I would argue it is not that important as long as you uphold a good UX. The second argument made me so angry. Were they trying to convince us that sharing code was terrible? Yes, they were. Sharing code between platforms is fantastic; you only need to write the code once, fix a bug once, and fix it on all platforms.</p>
    <p class="normal">.NET MAUI gives<a id="_idIndexMarker627"></a> us both options. We can use native UI with C# code or use Blazor Hybrid to get web controls.</p>
    <h1 id="_idParaDest-279" class="heading-1">Creating a new project</h1>
    <p class="normal">To develop cross-platform applications, we must install cross-platform tools in Visual Studio.</p>
    <p class="normal">If you haven’t done that, please open the Visual Studio installer and select the <strong class="screenText">.NET Multi-Platform App UI</strong> development workflow.</p>
    <p class="normal">.NET MAUI has a couple of templates: <strong class="screenText">.NET MAUI App</strong>, <strong class="screenText">.NET MAUI Blazor App</strong>, and <strong class="screenText">.NET MAUI Class Library</strong>.</p>
    <h2 id="_idParaDest-280" class="heading-2">.NET MAUI App</h2>
    <p class="normal">The .NET MAUI template<a id="_idIndexMarker628"></a> uses XAML to create applications.</p>
    <p class="normal">XAML is also <a id="_idIndexMarker629"></a>used for <strong class="keyWord">WPF</strong> (<strong class="keyWord">Windows Presentation Foundation</strong>) and <strong class="keyWord">UWP</strong> (<strong class="keyWord">Universal Windows Platform</strong>). Every XAML version differs just a bit but if you have<a id="_idIndexMarker630"></a> worked with WPF or UWP before, they should feel familiar.</p>
    <p class="normal">The XAML is converted into native elements. This way, if our app runs on Windows, it will have the look and feel of a Windows application. If we run it on an iOS device, it will look and feel like a native iOS app.</p>
    <p class="normal">This is probably our best option if we want to use our C# skills to create a cross-platform application. Using this approach, we will get the native feel without the need to write native code in Kotlin or Swift.</p>
    <h2 id="_idParaDest-281" class="heading-2">.NET MAUI Class Library</h2>
    <p class="normal"> .NET MAUI Class Library is<a id="_idIndexMarker631"></a> used to share content, classes, and functionality between applications.</p>
    <h2 id="_idParaDest-282" class="heading-2">.NET MAUI Blazor App</h2>
    <p class="normal">Since this is a <a id="_idIndexMarker632"></a>book about Blazor, we will focus on the <strong class="keyWord">.NET MAUI Blazor App</strong> template. This is a template that embeds a Blazor application inside of a native shell.</p>
    <p class="normal">For the .NET MAUI Blazor App project, we need at least:</p>
    <ul>
      <li class="bulletList">Android 7.0 (API 24) or higher</li>
      <li class="bulletList">iOS 14 or higher</li>
      <li class="bulletList">macOS 11 or higher, using Mac Catalyst</li>
    </ul>
    <p class="normal">The .NET MAUI Blazor App project uses BlazorWebView to render the Blazor content. It is not the same as Blazor Server and does not run WebAssembly; it is simply the third option we have for hosting Blazor applications.</p>
    <p class="normal">Let’s start a new project and dig a bit deeper:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In Visual Studio, create a new .NET MAUI Blazor App project.</li>
      <li class="numberedList">Name the project <code class="inlineCode">BlazorHybridApp</code>, and make sure you select <strong class="screenText">.NET 7</strong>.</li>
      <li class="numberedList">At the top of Visual Studio, select <strong class="screenText">Windows Machine</strong> and run the project.</li>
    </ol>
    <p class="normal">That’s it. We now have our first cross-platform Blazor Hybrid app!</p>
    <figure class="mediaobject"><img src="../Images/B18549_18_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.1: .NET MAUI app running on Windows</p>
    <p class="normal">Great! We now have a project. In the next section, we will take a look at what the template looks like.</p>
    <h1 id="_idParaDest-283" class="heading-1">Looking at the template</h1>
    <p class="normal">When running the project, we <a id="_idIndexMarker633"></a>should recognize the UI. It is the same <em class="italic">Hello, world!</em> page, the same counter, and the same weather forecast.</p>
    <p class="normal">If we take a look in the <code class="inlineCode">Pages</code> folder, we’ll find the Razor components, and if we open the <code class="inlineCode">Counter.razor</code> file, we will find a familiar component that looks like this:</p>
    <pre class="programlisting code"><code class="hljs-code">@page "/counter"
<span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>Counter<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag"> </span><span class="hljs-attr">role</span><span class="hljs-tag">=</span><span class="hljs-string">"status"</span><span class="hljs-tag">&gt;</span>Current count: @currentCount<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"btn btn-primary"</span><span class="hljs-tag"> @</span><span class="hljs-attr">onclick</span><span class="hljs-tag">=</span><span class="hljs-string">"IncrementCount"</span><span class="hljs-tag">&gt;</span>Click me<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
@code {
    private int currentCount = 0;
    private void IncrementCount()
    {
        currentCount++;
    }
}
</code></pre>
    <p class="normal">To create a Blazor Hybrid app, adding components like this is what you need to know to get started, but let’s dig a bit deeper. The template is .NET MAUI App with some added Blazor startup code.</p>
    <p class="normal">To understand what is happening, we will start in the <code class="inlineCode">Platforms</code> folder. In the <code class="inlineCode">platforms</code> folder, we will find different a folder for each platform we can develop for Android, iOS, Mac Catalyst, Tizen, and Windows.</p>
    <p class="normal">This is the starting point for each platform, and they have a bit of a different implementation, but in the end, they all point to the file <code class="inlineCode">MauiProgram</code> located at the project’s root.</p>
    <p class="normal">The <code class="inlineCode">MauiProgram</code> class sets everything up, like fonts, dependency injection, etc.</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">BlazorHybridApp</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MauiProgram</span>
{
    <span class="hljs-keyword">public</span><span class="hljs-function"> </span><span class="hljs-keyword">static</span><span class="hljs-function"> MauiApp </span><span class="hljs-title">CreateMauiApp</span><span class="hljs-function">()</span>
    {
        <span class="hljs-keyword">var</span> builder = MauiApp.CreateBuilder();
        builder
            .UseMauiApp&lt;App&gt;()
            .ConfigureFonts(fonts =&gt;
            {
                fonts.AddFont(<span class="hljs-string">"OpenSans-Regular.ttf"</span>, <span class="hljs-string">"OpenSansRegular"</span>);
            });
        builder.Services.AddMauiBlazorWebView();
<span class="hljs-meta">#</span><span class="hljs-keyword">if</span><span class="hljs-meta"> DEBUG</span>
        builder.Services.AddBlazorWebViewDeveloperTools();
        builder.Logging.AddDebug();
<span class="hljs-meta">#</span><span class="hljs-keyword">endif</span>
        builder.Services.AddSingleton&lt;WeatherForecastService&gt;();
        <span class="hljs-keyword">return</span> builder.Build();
    }
}
</code></pre>
    <p class="normal">The essential thing in the file is <code class="inlineCode">UseMauiApp&lt;App&gt;</code>, which gives us a clue about what is happening next. The next step is to load the <code class="inlineCode">App.xaml</code>.</p>
    <p class="normal">The <code class="inlineCode">App.xaml</code> file has a bunch of <a id="_idIndexMarker634"></a>resources for styling. The Blazor magic starts to happen in <code class="inlineCode">App.xaml.cs</code>:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">namespace</span> <span class="hljs-title">BlazorHybridApp</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">App</span> : <span class="hljs-title">Application</span>
{
    <span class="hljs-keyword">public</span><span class="hljs-function"> </span><span class="hljs-title">App</span><span class="hljs-function">()</span>
    {
        InitializeComponent();
        MainPage = <span class="hljs-keyword">new</span> MainPage();
    }
}
</code></pre>
    <p class="normal">It sets the application <code class="inlineCode">MainPage</code> to an instance of the class <code class="inlineCode">MainPage</code>. In <code class="inlineCode">MainPage.xaml</code>, we have reached the first Blazor reference in the app, the <code class="inlineCode">BlazorWebView</code>:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">BlazorWebView</span><span class="hljs-tag"> </span><span class="hljs-attr">x:Name</span><span class="hljs-tag">=</span><span class="hljs-string">"blazorWebView"</span><span class="hljs-tag"> </span><span class="hljs-attr">HostPage</span><span class="hljs-tag">=</span><span class="hljs-string">"wwwroot/index.html"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">BlazorWebView.RootComponents</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">RootComponent</span><span class="hljs-tag"> </span><span class="hljs-attr">Selector</span><span class="hljs-tag">=</span><span class="hljs-string">"#app"</span><span class="hljs-tag"> </span><span class="hljs-attr">ComponentType</span><span class="hljs-tag">=</span><span class="hljs-string">"{x:Type local:Main}"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">BlazorWebView.RootComponents</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">BlazorWebView</span><span class="hljs-tag">&gt;</span>
</code></pre>
    <p class="normal">In this case, we are <a id="_idIndexMarker635"></a>referring to <code class="inlineCode">index.html</code>, located in the <code class="inlineCode">wwwroot</code> folder, and also set up the root component (similar to what we do in <code class="inlineCode">Program.cs</code> in Blazor Server and Blazor WebAssembly).</p>
    <p class="normal">Here, we can also add XAML components, which makes it possible to mix XAML and Blazor components. Even though the implementation looks different, we should be familiar with the concepts.</p>
    <p class="normal">The <code class="inlineCode">index.html</code> is almost the same as in Blazor WebAssembly:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta">&lt;!DOCTYPE </span><span class="hljs-keyword">html</span><span class="hljs-meta">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">html</span><span class="hljs-tag"> </span><span class="hljs-attr">lang</span><span class="hljs-tag">=</span><span class="hljs-string">"en"</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">head</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span><span class="hljs-tag"> </span><span class="hljs-attr">charset</span><span class="hljs-tag">=</span><span class="hljs-string">"utf-8"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">meta</span><span class="hljs-tag"> </span><span class="hljs-attr">name</span><span class="hljs-tag">=</span><span class="hljs-string">"viewport"</span><span class="hljs-tag"> </span><span class="hljs-attr">content</span><span class="hljs-tag">=</span><span class="hljs-string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">title</span><span class="hljs-tag">&gt;</span>BlazorHybridApp<span class="hljs-tag">&lt;/</span><span class="hljs-name">title</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">base</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"/"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span><span class="hljs-tag"> </span><span class="hljs-attr">rel</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">stylesheet"</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"css/bootstrap/bootstrap.min.css"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"css/app.css"</span><span class="hljs-tag"> </span><span class="hljs-attr">rel</span><span class="hljs-tag">=</span><span class="hljs-string">"stylesheet"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">link</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">"BlazorHybridApp.styles.css"</span><span class="hljs-tag"> </span><span class="hljs-attr">rel</span><span class="hljs-tag">=</span><span class="hljs-string">"stylesheet"</span><span class="hljs-tag"> /&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">head</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">body</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"status-bar-safe-area"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"app"</span><span class="hljs-tag">&gt;</span>Loading...<span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"blazor-error-ui"</span><span class="hljs-tag">&gt;</span>
        An unhandled error has occurred.
        <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">href</span><span class="hljs-tag">=</span><span class="hljs-string">""</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"reload"</span><span class="hljs-tag">&gt;</span>Reload<span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">a</span><span class="hljs-tag"> </span><span class="hljs-attr">class</span><span class="hljs-tag">=</span><span class="hljs-string">"dismiss"</span><span class="hljs-tag">&gt;</span><img src="../Images/B18549_18_001.png" alt=""/><span class="hljs-tag">&lt;/</span><span class="hljs-name">a</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">script</span><span class="hljs-tag"> </span><span class="hljs-attr">src</span><span class="hljs-tag">=</span><span class="hljs-string">"_framework/blazor.webview.js"</span><span class="hljs-tag"> </span><span class="hljs-attr">autostart</span><span class="hljs-tag">=</span><span class="hljs-string">"false"</span><span class="hljs-tag">&gt;&lt;/</span><span class="hljs-name">script</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">body</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">html</span><span class="hljs-tag">&gt;</span>
</code></pre>
    <p class="normal">The only difference worth mentioning is the JavaScript that differs from the others (Blazor Server and Blazor WebAssembly implementations). From this point, the application is now running pure Blazor.</p>
    <p class="normal">As we can see in the <code class="inlineCode">MainPage.xaml</code>, we are loading a Razor file called <code class="inlineCode">Main</code>. The same file in Blazor Server and Blazor WebAssembly is called <code class="inlineCode">App.razor</code>. The <code class="inlineCode">Main.razor</code> file should also feel familiar:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag">&lt;</span><span class="hljs-name">Router</span><span class="hljs-tag"> </span><span class="hljs-attr">AppAssembly</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@typeof(Main).Assembly"</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">Found</span><span class="hljs-tag"> </span><span class="hljs-attr">Context</span><span class="hljs-tag">=</span><span class="hljs-string">"routeData"</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">RouteView</span><span class="hljs-tag"> </span><span class="hljs-attr">RouteData</span><span class="hljs-tag">=</span><span class="hljs-string">"@routeData"</span><span class="hljs-tag"> </span><span class="hljs-attr">DefaultLayout</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-string">@typeof(MainLayout)"</span><span class="hljs-tag"> /&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">FocusOnNavigate</span><span class="hljs-tag"> </span><span class="hljs-attr">RouteData</span><span class="hljs-tag">=</span><span class="hljs-string">"@routeData"</span><span class="hljs-tag"> </span><span class="hljs-attr">Selector</span><span class="hljs-tag">=</span><span class="hljs-string">"h1"</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">Found</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">NotFound</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">LayoutView</span><span class="hljs-tag"> </span><span class="hljs-attr">Layout</span><span class="hljs-tag">=</span><span class="hljs-string">"@typeof(MainLayout)"</span><span class="hljs-tag">&gt;</span>
            <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag"> </span><span class="hljs-attr">role</span><span class="hljs-tag">=</span><span class="hljs-string">"alert"</span><span class="hljs-tag">&gt;</span>Sorry, there's nothing at this address.<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">LayoutView</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">NotFound</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">Router</span><span class="hljs-tag">&gt;</span>
</code></pre>
    <p class="normal">This is where we find the router, where we configure where to find the Razor components, and handle the requests that are not found.</p>
    <p class="normal">We will not go deeper into the Blazor parts because everything past our router is the same as any other Blazor hosting model (Blazor Server and Blazor WebAssembly). There is a <code class="inlineCode">MainLayout</code>, <code class="inlineCode">NavMenu</code>, and component for each function (<code class="inlineCode">Hello, world!</code>, <code class="inlineCode">Counter</code>, and <code class="inlineCode">Weather</code>).</p>
    <p class="normal">With Blazor Server and Blazor <a id="_idIndexMarker636"></a>WebAssembly, we need to make JavaScript calls to access local resources like Bluetooth, a battery, and a flashlight, to name a few. Blazor Hybrid adds the ability to write code that directly accesses local resources. We can access the flashlight (because we all love things that light up) by using this code:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">try</span>
{
    <span class="hljs-keyword">if</span> (FlashlightSwitch.IsToggled)
        <span class="hljs-keyword">await</span> Flashlight.Default.TurnOnAsync();
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">await</span> Flashlight.Default.TurnOffAsync();
}
<span class="hljs-keyword">catch</span> (FeatureNotSupportedException ex)
{
    <span class="hljs-comment">// Handle not supported on device exception</span>
}
<span class="hljs-keyword">catch</span> (PermissionException ex)
{
    <span class="hljs-comment">// Handle permission exception</span>
}
<span class="hljs-keyword">catch</span> (Exception ex)
{
    <span class="hljs-comment">// Unable to turn on/off flashlight</span>
}
</code></pre>
    <p class="normal">This code will not work if we run a Blazor Server or Blazor WebAssembly app.</p>
    <p class="normal">Next, we will get our amazing app to run on Android.</p>
    <h1 id="_idParaDest-284" class="heading-1">Developing for Android</h1>
    <p class="normal">There are two<a id="_idIndexMarker637"></a> options when it comes to developing for Android. We can run our application in an <em class="italic">emulator</em> or on a <em class="italic">physical device</em>.</p>
    <p class="normal">To publish our application we need to have a Google Developer license, but for development and testing we don’t need one.</p>
    <h2 id="_idParaDest-285" class="heading-2">Running in an emulator</h2>
    <p class="normal">We first need to install an<a id="_idIndexMarker638"></a> emulator to run our app on an Android emulator:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In Visual Studio, open the menu <strong class="screenText">Tools</strong> | <strong class="screenText">Android</strong> | <strong class="screenText">Android Device Manager</strong>.</li>
      <li class="numberedList">Press the <strong class="screenText">New</strong> button, and configure a new device (the default settings should be OK):</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18549_18_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.2: Android device configuration</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Click <strong class="screenText">Create</strong> to download a device image and configure it.</li>
      <li class="numberedList">Select <a id="_idIndexMarker639"></a>the newly created emulator at the top of Visual Studio and run the project. Starting the emulator will take a couple of minutes. When developing, make sure not to close the emulator for a faster deployment time.
    <p class="normal">To get the emulator to run fast, we can enable hardware acceleration, depending on the processor we use.</p>
    <p class="normal">To enable hardware acceleration, please refer to the official documentation: <a href="https://learn.microsoft.com/en-us/xamarin/android/get-started/installation/android-emulator/hardware-acceleration?pivots=windows"><span class="url">https://learn.microsoft.com/en-us/xamarin/android/get-started/installation/android-emulator/hardware-acceleration?pivots=windows</span></a></p>
    <p class="normal">Great, we now have our app running inside an Android emulator:</p>
    <figure class="mediaobject"><img src="../Images/B18549_18_03.png" alt="No description available."/></figure>
    <p class="packt_figref">Figure 18.3: App running inside an Android emulator</p></li>
    </ol>
    <p class="normal">Next, we will run the application on a physical device.</p>
    <h2 id="_idParaDest-286" class="heading-2">Running on a physical device</h2>
    <p class="normal">If we want <a id="_idIndexMarker640"></a>to try our application on a physical device, we need to do a few things on our Android device. This may differ from device to device.</p>
    <p class="normal">First, we need to make sure the phone is developer-unlocked:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Go to the <strong class="screenText">Settings</strong> screen.</li>
      <li class="numberedList">Select <strong class="screenText">About phone</strong>.</li>
      <li class="numberedList">Tap <strong class="screenText">Build Number</strong> seven times until <strong class="screenText">You are now a developer!</strong> is visible.</li>
    </ol>
    <p class="normal">Second, we need to enable USB debugging:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Go to the <strong class="screenText">Settings</strong> screen.</li>
      <li class="numberedList">Select <strong class="screenText">Developer options</strong>.</li>
      <li class="numberedList">Turn on the <strong class="screenText">USB debugging</strong> option.</li>
      <li class="numberedList">Some devices also need to enable <strong class="screenText">Install via USB</strong>.</li>
    </ol>
    <p class="normal">We are now all set to try our app on a physical device.</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In the menu at the top of Visual Studio, click the arrow under <strong class="screenText">Android local devices</strong> and select your device.</li>
      <li class="numberedList">Press <strong class="screenText">Run</strong>, and Visual Studio will deploy the application to the device.</li>
    </ol>
    <p class="normal">We should now have our <a id="_idIndexMarker641"></a>application running on our device.</p>
    <p class="normal">It is an extraordinary feeling to run code on another device. Over the years, I have developed over 100 applications for Windows 8 and Windows Phone. However, to this day, it still gives me the same feeling to see my application deploy to another physical device.</p>
    <p class="normal">Next, we will look at what options we have for developing iOS.</p>
    <h1 id="_idParaDest-287" class="heading-1">Developing for iOS</h1>
    <p class="normal">Apple does not <a id="_idIndexMarker642"></a>allow iOS code to be compiled on something that is not an Apple computer. There are also cloud options like MacinCloud and MacStadium, but we won’t go into those options in this book.</p>
    <p class="normal">This means we must own a Mac (to use the simulator) or have an Apple Developer license (to use <strong class="keyWord">hot restart</strong>).</p>
    <h2 id="_idParaDest-288" class="heading-2">Hot restart</h2>
    <p class="normal">To test our<a id="_idIndexMarker643"></a> application on a physical device, we can use <a id="_idIndexMarker644"></a>hot restart. The hot restart feature is only designed for us to test our application while we are developing it, and we will not be able to publish the application.</p>
    <p class="normal">First, we need to have iTunes installed. If you don’t have iTunes, you can install that from the Windows store.</p>
    <p class="normal">In the top menu in Visual Studio, if we select <strong class="screenText">iOS Local Device</strong>, we will get a nice wizard telling us precisely what we need to do. The first steps are informative and let us install iTunes.</p>
    <p class="normal">Next, it’s time to enter our App Store Connect API key information. To be able to supply that information, we need to have an Apple Developer account. At the time of writing, it costs $99.</p>
    <p class="normal">There are<a id="_idIndexMarker645"></a> excellent instructions on where to find that information.</p>
    <p class="normal">You will be prompted with this screen:</p>
    <figure class="mediaobject"><img src="../Images/B18549_18_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.4: Apple Connect API Key information screen</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">You can create a new key by going to <a href="https://appstoreconnect.apple.com/access/api"><span class="url">https://appstoreconnect.apple.com/access/api</span></a>.</li>
      <li class="numberedList">Click <strong class="screenText">Request API key</strong> and then <strong class="screenText">Generate API Key</strong>.</li>
      <li class="numberedList">Enter the name <code class="inlineCode">Visual Studio</code> and select <strong class="screenText">Access Developer</strong>.</li>
      <li class="numberedList">Copy the different values to Visual Studio, download the API key, and select the file as the <strong class="screenText">Private key path</strong>.</li>
      <li class="numberedList">Next, select a team, and we are all set.</li>
      <li class="numberedList">Run the application <a id="_idIndexMarker646"></a>and see it run on your iPhone:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18549_18_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.5: Application running on an iPhone</p>
    <p class="normal">Next, we will look at how to set up a simulator.</p>
    <h3 id="_idParaDest-289" class="heading-3">Simulator</h3>
    <p class="normal">A simulator<a id="_idIndexMarker647"></a> runs the app on a Mac but shows the result on a PC. A simulator differs from an emulator. An emulator<a id="_idIndexMarker648"></a> runs the code on the machine (in our case, a PC). A simulator runs on top of the native OS (macOS), mimicking an iPad or an iPhone.</p>
    <p class="normal">To get simulators <a id="_idIndexMarker649"></a>to work, we need to have an Apple computer on the same network. Visual Studio will help us along the way to set everything up. We must install two things on the Apple computer, Xcode and Visual Studio for Mac or Mono. I went for Xcode and Visual Studio for Mac:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">On your Mac, install Xcode from the App Store.</li>
      <li class="numberedList">Install Visual Studio for Mac. You will find the installation files here: <a href="https://visualstudio.microsoft.com/vs/mac/"><span class="url">https://visualstudio.microsoft.com/vs/mac/</span></a>.</li>
    </ol>
    <p class="normal">We also need to open remote access to the Mac. We can do that by doing the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">On the Mac, invoke Spotlight by pressing <em class="keystroke">cmd</em> + <em class="keystroke">space</em>, searching for <code class="inlineCode">remote login</code>, and then opening the <strong class="screenText">Sharing System Preferences</strong>.</li>
      <li class="numberedList">Enable the <strong class="screenText">Remote Login</strong> option to allow Visual Studio to connect to the Mac.</li>
      <li class="numberedList">Set access for <strong class="screenText">Only these users</strong> and ensure your machine user is included in the list or group.</li>
    </ol>
    <p class="normal">We now have everything prepared on the Mac. In Visual Studio on the PC, we can now pair our Mac.</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Select <strong class="screenText">Tools</strong> | <strong class="screenText">iOS</strong> | <strong class="screenText">Pair to Mac</strong>.</li>
      <li class="numberedList">Follow the instructions in the wizard (same as above).</li>
      <li class="numberedList">Select the Mac from the list, and click <strong class="screenText">Connect</strong>. Visual Studio can now help you install any versions of Mono you may need.</li>
      <li class="numberedList">In the dropdown at the top of Visual Studio, we can select <strong class="screenText">iOS Simulators</strong>, and then<a id="_idIndexMarker650"></a> choose a device to run our app.</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18549_18_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.6: Device selection in Visual Studio</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">Run the app and the simulator will start. This is what the app would look like if we run it on an iPad Mini:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18549_18_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.7: App running in iPad simulator</p>
    <p class="normal">We now have two ways of running and testing on iOS devices. We can also connect an iPhone directly to the Mac and run the application over Wi-Fi. There is more information on debugging over Wi-Fi in the official docs: <a href="https://learn.microsoft.com/en-us/xamarin/ios/deploy-test/wireless-deployment"><span class="url">https://learn.microsoft.com/en-us/xamarin/ios/deploy-test/wireless-deployment</span></a>.</p>
    <p class="normal">Next, we will build an app for macOS.</p>
    <h1 id="_idParaDest-290" class="heading-1">Developing for macOS</h1>
    <p class="normal">We don’t have an option for<a id="_idIndexMarker651"></a> macOS to run or deploy from a Windows machine. To run our application on the Mac, follow these steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">On the Mac, open our project in Visual Studio for Mac.</li>
      <li class="numberedList">Run the project, and our app will show up:</li>
    </ol>
    <figure class="mediaobject"><img src="../Images/B18549_18_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 18.8: App running on macOS</p>
    <p class="normal">In this case, we are<a id="_idIndexMarker652"></a> running the application on the same platform, with no emulators or simulators, which is much less complicated than running it on a separate device.</p>
    <p class="normal">Next, we will run our application on Windows.</p>
    <h1 id="_idParaDest-291" class="heading-1">Developing for Windows</h1>
    <p class="normal">Running the application on <a id="_idIndexMarker653"></a>Windows is what we did in <em class="italic">step 3</em> of the <em class="italic">.NET MAUI Blazor App</em> section. To reiterate, perform the following step:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Change the dropdown to <strong class="screenText">Windows Machine</strong> and run the project. We can see the result in <em class="italic">Figure 18.1</em> at the beginning of the chapter.</li>
    </ol>
    <p class="normal">As with macOS, we run the application on the same platform, with no emulators or simulators, which is much less complicated than running it on a separate device.</p>
    <p class="normal">Next, we will take a look at Tizen.</p>
    <h1 id="_idParaDest-292" class="heading-1">Developing for Tizen</h1>
    <p class="normal">Tizen<a id="_idIndexMarker654"></a> is an operating system mainly for TVs and watches. My Samsung Gear S3 runs Tizen. Samsung manages Tizen and not Microsoft. This ability for other manufacturers to hook into the platform just shows how great the .NET MAUI platform is.</p>
    <p class="normal">At the time of writing, the Tizen experience lags a bit. Since this is not an official platform and because of the state of the tooling, I have decided not to include a guide.</p>
    <p class="normal">But Tizen is working on the tooling, so if you want to transfer your app to TVs running Tizen, you should look into it.</p>
    <h1 id="_idParaDest-293" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we looked at cross-platform development with Blazor Hybrid. I mentioned this before in this chapter, but it is worth mentioning again that running code on a phone or a device that is not a computer is such a fun thing to do. You can’t beat that feeling. Even if you don’t intend to develop for mobile devices, give it a try.</p>
    <p class="normal">With .NET MAUI, we can leverage our existing C# knowledge and, perhaps more importantly, our Blazor knowledge to create mobile applications.</p>
  </div>
</body>
</html>