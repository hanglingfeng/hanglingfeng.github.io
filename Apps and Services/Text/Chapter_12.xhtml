<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<title>Chapter_12</title>
<link href="../Styles/syntax-highlighting.css" rel="stylesheet" type="text/css"/>
<link href="../Styles/epub.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body id="Chapter_12" lang="en-US" xml:lang="en-US">
<div class="Basic-Text-Frame" id="_idContainer394">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">12</span></h1>
<h1 class="chapterTitle" id="_idParaDest-436"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Combining Data Sources Using GraphQL</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you will be introduced to GraphQL, a service technology that provides a more modern approach to combining data from various sources and then providing a standard way to query that data.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">This chapter will cover the following topics:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">Understanding GraphQL</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">Building a service that supports GraphQL</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">Defining GraphQL queries for EF Core models</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Building .NET clients for a GraphQL service</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">Implementing GraphQL mutations</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">Implementing GraphQL subscriptions</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-437"><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">Understanding GraphQL</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 8</span></em><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">, </span><em class="italic"><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">Building and Securing Web Services Using Minimal APIs</span></em><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">, you learned how to define a Web API service</span><a id="_idIndexMarker1208"/><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml"> by mapping request path endpoints to lambda expressions or methods that return the response. </span><span class="koboSpan" id="kobo.17.2" xmlns="http://www.w3.org/1999/xhtml">Any parameters and the format of responses are under the control of the service. </span><span class="koboSpan" id="kobo.17.3" xmlns="http://www.w3.org/1999/xhtml">A client cannot ask for what they exactly need or use more efficient data formats.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">If you completed the online-only section, </span><em class="italic"><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">Exposing Data via the Web Using OData</span></em><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">, then you know that OData has a built-in query language for the client to control what data they want to be returned. </span><span class="koboSpan" id="kobo.20.2" xmlns="http://www.w3.org/1999/xhtml">However, OData has a rather old-fashioned approach and is tied to the HTTP standard, for example, using query strings in an HTTP request.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">If you would prefer to use a more modern and flexible technology to combine and expose your data as a service, then a good alternative is </span><strong class="keyWord"><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL</span></strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Like OData, GraphQL is a standard</span><a id="_idIndexMarker1209"/><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml"> for describing your data and then querying it that gives the client control over exactly what they need. </span><span class="koboSpan" id="kobo.25.2" xmlns="http://www.w3.org/1999/xhtml">It was developed internally by Facebook in 2012 before being open sourced in 2015, and it is now managed by the GraphQL Foundation.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Some of the key benefits</span><a id="_idIndexMarker1210"/><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml"> of GraphQL over OData are:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL does not require HTTP because it is transport-agnostic, so you could use alternative transport protocols like WebSockets or TCP.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL has more client libraries for different platforms than OData has.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL has a single endpoint, usually simply </span><code class="inlineCode"><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">/graphql</span></code><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-438"><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL query document format</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL uses its own document</span><a id="_idIndexMarker1211"/><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml"> format for its queries, which are a bit like JSON, but GraphQL queries do not require commas between field names, as shown in the following query, which requests some fields and related data for the product with an ID of </span><code class="inlineCode"><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">23</span></code><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">
  product (productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">23</span></span><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">
    productId
    productName
    unitPrice
    supplier </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">
      companyName
      country
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">The official media type for GraphQL query documents is </span><code class="inlineCode"><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">application/graphql</span></code><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h3 class="heading-3" id="_idParaDest-439"><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">Requesting fields</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">The most basic GraphQL query requests</span><a id="_idIndexMarker1212"/><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml"> one or more fields from a type, for example, requesting three fields for each </span><code class="inlineCode"><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">customer</span></code><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml"> entity, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml"># The query keyword is optional. </span><span class="koboSpan" id="kobo.58.2" xmlns="http://www.w3.org/1999/xhtml">Comments are prefixed with #.
</span><span class="koboSpan" id="kobo.58.3" xmlns="http://www.w3.org/1999/xhtml">query </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">
  customer </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">
    customerId
    companyName
    country
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">The response is in the JSON format, for example, an array of </span><code class="inlineCode"><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">customer</span></code><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"> objects, as shown in the following document:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">"data"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">"customerId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">"ALFKI"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">"companyName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">"Alfreds Futterkiste"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">"country"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">"Germany"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">},</span></span><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">
  ...
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<h3 class="heading-3" id="_idParaDest-440"><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">Specifying filters and arguments</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">With an HTTP or REST-style API, the caller</span><a id="_idIndexMarker1213"/><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml"> is limited to only passing parameters</span><a id="_idIndexMarker1214"/><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"> when the API predefines that. </span><span class="koboSpan" id="kobo.91.2" xmlns="http://www.w3.org/1999/xhtml">With GraphQL, you can set parameters anywhere in the query, for example, filtering orders by order date and by the country of the customer who made the order, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">query GetOrdersByDateAndCountry </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">
  order(orderDate</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">"23/04/1998"</span></span><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">
    orderId
    orderDate
    customer(country</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">"UK"</span></span><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">
      companyName
      country
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">Note that although GraphQL uses camelCase for entity, property, and parameter names, you should use PascalCase for query names.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">You might want to pass values</span><a id="_idIndexMarker1215"/><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"> for named parameters instead of hardcoding </span><a id="_idIndexMarker1216"/><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">them, as shown in the following code:</span></p>
<pre class="programlisting gen"><code class="hljs"><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">query GetOrdersByDateAndCountry($country: String, $orderDate: String) {
  order(orderDate: $orderDate) {
    orderId
    orderDate
    customer(country: $country) {
      companyName
      country
    }
  }
}
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">You can learn more about</span><a id="_idIndexMarker1217"/><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"> the GraphQL query language at the following link: </span><a href="https://graphql.org/learn/queries/"><span class="url"><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">https://graphql.org/learn/queries/</span></span></a><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-441"><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml">Understanding other GraphQL capabilities</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">As well as queries, other standard GraphQL features are mutations and subscriptions:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">Mutations</span></strong><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml"> enable you to create, update, and</span><a id="_idIndexMarker1218"/><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml"> delete</span><a id="_idIndexMarker1219"/><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml"> resources.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">Subscriptions</span></strong><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml"> enable a client to get notified</span><a id="_idIndexMarker1220"/><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml"> when resources change. </span><span class="koboSpan" id="kobo.125.2" xmlns="http://www.w3.org/1999/xhtml">They work</span><a id="_idIndexMarker1221"/><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml"> best with additional communication technologies like WebSockets.</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-442"><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">Understanding the ChilliCream GraphQL platform</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL.NET is one of the most popular platforms </span><a id="_idIndexMarker1222"/><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">for implementing GraphQL with .NET. </span><span class="koboSpan" id="kobo.129.2" xmlns="http://www.w3.org/1999/xhtml">In my opinion, GraphQL.NET requires too much configuration for even the most basic example, and the documentation is frustrating. </span><span class="koboSpan" id="kobo.129.3" xmlns="http://www.w3.org/1999/xhtml">I have a feeling that, although it is powerful, it implements the GraphQL specification in a one-to-one manner instead of rethinking how a .NET platform could make it easier to get started.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">You can learn</span><a id="_idIndexMarker1223"/><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml"> about GraphQL.NET at the following link: </span><a href="https://graphql-dotnet.github.io/"><span class="url"><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">https://graphql-dotnet.github.io/</span></span></a><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">For this book, I looked for alternatives, and I found exactly what I was looking for. </span><span class="koboSpan" id="kobo.134.2" xmlns="http://www.w3.org/1999/xhtml">ChilliCream is a company that has created a whole platform to work with GraphQL:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">Hot Chocolate</span></strong><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"> enables you to create</span><a id="_idIndexMarker1224"/><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml"> GraphQL services for .NET.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">Strawberry Shake</span></strong><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml"> enables you to create</span><a id="_idIndexMarker1225"/><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"> GraphQL clients for .NET.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"> enables you to run queries</span><a id="_idIndexMarker1226"/><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml"> and explore a GraphQL endpoint using a Monaco-based GraphQL IDE.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">Green Donut</span></strong><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml"> enables better performance</span><a id="_idIndexMarker1227"/><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml"> when loading data.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">Unlike some other packages that can be used to add support for GraphQL, ChilliCream packages are designed to be as easy to implement as possible, using conventions and simple POCO classes instead of complex types and special schemas. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">It works in a similar way to how Microsoft might have built a GraphQL platform for .NET, with sensible defaults and conventions rather than lots of boilerplate code and configuration.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">As ChilliCream says</span><a id="_idIndexMarker1228"/><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml"> on its home page, </span><em class="italic"><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">“We at ChilliCream build the ultimate GraphQL platform. </span><span class="koboSpan" id="kobo.150.2" xmlns="http://www.w3.org/1999/xhtml">Most of our code is open-source and will forever remain open-source.”</span></em></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">The GitHub repository for Hot Chocolate is at the following link: </span><a href="https://github.com/ChilliCream/hotchocolate"><span class="url"><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">https://github.com/ChilliCream/hotchocolate</span></span></a><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h1 class="heading-1" id="_idParaDest-443"><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">Building a service that supports GraphQL</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">There is no </span><code class="inlineCode"><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">dotnet</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">new</span></code><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml"> project template</span><a id="_idIndexMarker1229"/><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml"> for GraphQL, so we will use the </span><strong class="screenText"><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core Empty</span></strong><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"> project</span><a id="_idIndexMarker1230"/><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml"> template. </span><span class="koboSpan" id="kobo.162.2" xmlns="http://www.w3.org/1999/xhtml">Even though GraphQL does not have to be hosted on a web server because it is not tied to HTTP, it is a sensible choice to get started. </span><span class="koboSpan" id="kobo.162.3" xmlns="http://www.w3.org/1999/xhtml">We will then add a package reference for GraphQL support:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to add a new project, as defined in the following list:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core Empty</span></strong><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">web</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">Chapter12</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Other Visual Studio 2022 options: </span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">Configure for HTTPS</span></strong><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml">: Selected</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">Enable Docker</span></strong><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">: Cleared</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">Do not use top-level statements</span></strong><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">: Cleared</span></li>
</ul>
</li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">In the project file, add a package reference for Hot Chocolate hosted in ASP.NET Core, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">"HotChocolate.AspNetCore"</span></span><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"> Version=</span><span class="hljs-string"><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">"13.5.1"</span></span><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">Version 13.6.0 was in preview at the time of writing. </span><span class="koboSpan" id="kobo.185.2" xmlns="http://www.w3.org/1999/xhtml">To use the most recent preview version, you can set it to </span><code class="inlineCode"><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">13.6-*</span></code><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.187.2" xmlns="http://www.w3.org/1999/xhtml">But I recommend that you go to the following link</span><a id="_idIndexMarker1231"/><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml"> and then reference the latest GA version: </span><a href="https://www.nuget.org/packages/HotChocolate.AspNetCore/"><span class="url"><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">https://www.nuget.org/packages/HotChocolate.AspNetCore/</span></span></a><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml">In the project file, treat</span><a id="_idIndexMarker1232"/><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml"> warnings as errors and disable </span><a id="_idIndexMarker1233"/><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">the warning </span><code class="inlineCode"><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">AD0001</span></code><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">, as highlighted in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">&lt;PropertyGroup&gt;
  &lt;TargetFramework&gt;net8</span><span class="hljs-number"><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">.0</span></span><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/TargetFramework&gt;
  &lt;Nullable&gt;enable&lt;/Nullable&gt;
  &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;TreatWarningsAsErrors&gt;</span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">true</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/TreatWarningsAsErrors&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;NoWarn&gt;AD0001&lt;/NoWarn&gt;</span></strong></span><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">
&lt;/PropertyGroup&gt;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">Properties</span></code><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml"> folder, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">launchSettings.json</span></code><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">, for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml"> profile, modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">applicationUrl</span></code><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml"> to use port </span><code class="inlineCode"><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">5121</span></code><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml"> and port </span><code class="inlineCode"><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">5122</span></code><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">http</span></code><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.220.2" xmlns="http://www.w3.org/1999/xhtml">Then, add a </span><code class="inlineCode"><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">launchUrl</span></code><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><code class="inlineCode"><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">graphql</span></code><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">, as</span><a id="_idIndexMarker1234"/><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"> highlighted in the following configuration:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">"https"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">{</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">"commandName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">"Project"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">"dotnetRunMessages"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">"launchBrowser"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">"launchUrl"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">"</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">graphql"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">"applicationUrl"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5121;http://localhost:5122"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">"environmentVariables"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">"ASPNETCORE_ENVIRONMENT"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">"Development"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">Build</span><a id="_idIndexMarker1235"/><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml"> project.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-444"><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">Defining the GraphQL schema for Hello World</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">The first task is to define what we want</span><a id="_idIndexMarker1236"/><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml"> to expose as GraphQL models</span><a id="_idIndexMarker1237"/><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml"> in the web service.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">Let’s define a GraphQL query for the most basic </span><code class="inlineCode"><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">Hello World</span></code><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml"> example, which will respond with plain text when a request for a greeting is made:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"> project/folder, add a class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">Query.cs</span></code><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">Modify the class to have a method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">GetGreeting</span></code><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml"> that returns the plain text </span><code class="inlineCode"><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">"Hello, World!"</span></code><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></span><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">GetGreeting</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span><span class="hljs-string"><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">"Hello, World!"</span></span><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">;
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">, import the namespace where we defined the </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></code><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"> class, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.GraphQL.Service; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">// To use Query.</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">In the section to configure services, after the call to </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">CreateBuilder</span></code><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml">, add a statement to add GraphQL server-side support, and add the query type to the collection of registered services, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services
  .AddGraphQLServer()
  .AddQueryType&lt;Query&gt;();
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">Modify the statement that maps a </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"> request to return a more useful plain text message, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">app.MapGet(</span><span class="hljs-string"><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml">"/"</span></span><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">, () =&gt; </span><span class="hljs-string"><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">"Navigate to: https://localhost:5121/graphql"</span></span><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">);
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">In the section to configure</span><a id="_idIndexMarker1238"/><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml"> the HTTP</span><a id="_idIndexMarker1239"/><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml"> pipeline, before the call to </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">, add a statement to map GraphQL as an endpoint, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">app.MapGraphQL();
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml"> web project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio 2022, then select the </span><strong class="screenText"><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">https</span></strong><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> profile, start the project without debugging, and note that the browser starts automatically.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio Code, then enter the command </span><code class="inlineCode"><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">dotnet run --launch-profile https</span></code><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">, start Chrome manually, and navigate to </span><code class="inlineCode"><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost:5121/graphql</span></code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">Note the </span><strong class="screenText"><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">BananaCakePop</span></strong><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml"> user interface, and then click the </span><strong class="screenText"><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">Create Document</span></strong><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml"> button.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">In the top-right corner, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">Connection Settings</span></strong><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml"> button, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.1</span></em><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.1: A new BananaCakePop document and connection settings button</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="10"><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">Connection Settings</span></strong><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml">, confirm</span><a id="_idIndexMarker1240"/><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"> that the </span><strong class="screenText"><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">Schema Endpoint</span></strong><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml"> is correct, and then</span><a id="_idIndexMarker1241"/><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml"> click </span><strong class="screenText"><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">Cancel</span></strong><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.2</span></em><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.2: Reviewing the BananaCakePop connection settings</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="11"><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">At the top of the </span><strong class="screenText"><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">untitled 1</span></strong><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml"> document, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">Schema Reference</span></strong><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml"> tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><strong class="screenText"><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">Schema Reference</span></strong><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml"> tab, note “The </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></code><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml"> type is a special type that defines the entry point of every GraphQL query”, and it has a field named </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">greeting</span></code><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"> that returns a </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">String!</span></code><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"> value. </span><span class="koboSpan" id="kobo.369.2" xmlns="http://www.w3.org/1999/xhtml">The exclamation mark indicates that the value will </span><em class="italic"><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">not</span></em><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml"> be </span><code class="inlineCode"><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">null</span></code><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">Schema Definition</span></strong><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and note there is only</span><a id="_idIndexMarker1242"/><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml"> one type defined, the special </span><code class="inlineCode"><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></code><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml"> object with its </span><code class="inlineCode"><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">greeting</span></code><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"> field, which is a non-null </span><code class="inlineCode"><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">String</span></code><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> value, as shown</span><a id="_idIndexMarker1243"/><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">type Query {
  greeting: String!
</span><span class="koboSpan" id="kobo.385.2" xmlns="http://www.w3.org/1999/xhtml">}
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-445"><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">Writing and executing GraphQL queries</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">Now that we know</span><a id="_idIndexMarker1244"/><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml"> the schema, we can write</span><a id="_idIndexMarker1245"/><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml"> and run a query:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">, in the </span><strong class="screenText"><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">untitled 1</span></strong><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml"> document, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"> tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml">On the left-hand side, type an open curly brace, </span><code class="inlineCode"><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">{</span></code><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">, and note that a close curly brace, </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">}</span></code><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">, is written for you.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">Type the letter </span><code class="inlineCode"><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">g</span></code><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml"> , and note that the autocomplete shows it recognizes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">greeting</span></code><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml"> field, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.3</span></em><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.3: Autocomplete for the greeting field</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">Press </span><em class="keystroke"><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">Enter</span></em><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml"> to accept the autocomplete suggestion.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml"> button and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "greeting": "Hello, World!"
  </span><span class="koboSpan" id="kobo.417.2" xmlns="http://www.w3.org/1999/xhtml">}
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and shut down</span><a id="_idIndexMarker1246"/><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml"> the web</span><a id="_idIndexMarker1247"/><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"> server.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-446"><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">Naming GraphQL queries aka operations</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">The query that we wrote</span><a id="_idIndexMarker1248"/><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> was unnamed. </span><span class="koboSpan" id="kobo.423.2" xmlns="http://www.w3.org/1999/xhtml">We could also have created it as a named</span><a id="_idIndexMarker1249"/><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"> query, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">query QueryNameGoesHere {
  greeting
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">Named queries allow clients to identify</span><a id="_idIndexMarker1250"/><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml"> queries and responses for telemetry </span><a id="_idIndexMarker1251"/><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">purposes, for example, when hosting in Microsoft Azure cloud services and monitoring using Application Insights.</span></p>
<h2 class="heading-2" id="_idParaDest-447"><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">Understanding field conventions</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">The C# method we created</span><a id="_idIndexMarker1252"/><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></code><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml"> class was named </span><code class="inlineCode"><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">GetGreeting</span></code><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">, but when querying it, we used </span><code class="inlineCode"><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">greeting</span></code><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.437.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">Get</span></code><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml"> prefix on method names that represent fields in GraphQL is optional. </span><span class="koboSpan" id="kobo.439.2" xmlns="http://www.w3.org/1999/xhtml">Let’s see some more examples:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">Query.cs</span></code><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">, add two more methods without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">Get</span></code><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml"> prefix, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></span><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">GetGreeting</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span><span class="hljs-string"><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">"Hello, World!"</span></span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"> </strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">string</span></strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">Farewell</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">()</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">"Ciao! </span><span class="koboSpan" id="kobo.464.2" xmlns="http://www.w3.org/1999/xhtml">Ciao!"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"> </strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">int</span></strong><strong class="hljs-function-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml">RollTheDie</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">()</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; Random.Shared.Next(</span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">1</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">, </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">7</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">);</span></strong></span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">Schema Definition</span></strong><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and note the updated schema, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">type Query {
  greeting: String!
  </span><span class="koboSpan" id="kobo.484.2" xmlns="http://www.w3.org/1999/xhtml">farewell: String!
  </span><span class="koboSpan" id="kobo.484.3" xmlns="http://www.w3.org/1999/xhtml">rollTheDie: Int!
</span><span class="koboSpan" id="kobo.484.4" xmlns="http://www.w3.org/1999/xhtml">}
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">C# methods use PascalCase. </span><span class="koboSpan" id="kobo.485.2" xmlns="http://www.w3.org/1999/xhtml">GraphQL fields use camelCase.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and modify the query to specify a name and request the </span><code class="inlineCode"><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">rollTheDie</span></code><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml"> field, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">query GetNumber {
  rollTheDie
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml"> again multiple times. </span><span class="koboSpan" id="kobo.494.2" xmlns="http://www.w3.org/1999/xhtml">Note that the responses contain a random number between 1 and 6, and a history of requests and responses is stored for the current browser session, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.4</span></em><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.4: Executing a named query and the history of requests and responses</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and shut down</span><a id="_idIndexMarker1253"/><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml"> the web server.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-448"><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml">Defining GraphQL queries for EF Core models</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have a basic GraphQL service</span><a id="_idIndexMarker1254"/><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml"> operating successfully, let’s extend</span><a id="_idIndexMarker1255"/><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml"> it to enable querying the Northwind database.</span></p>
<h2 class="heading-2" id="_idParaDest-449"><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml">Adding support for EF Core</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">We must add another Hot Chocolate</span><a id="_idIndexMarker1256"/><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml"> package to allow easy dependency service integration of our EF Core database context with GraphQL query classes:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">Add a package reference for Hot Chocolate integration with EF Core and a project reference to the Northwind database</span><a id="_idIndexMarker1257"/><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml"> context project, as highlighted in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">"HotChocolate.AspNetCore"</span></span><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml"> Version=</span><span class="hljs-string"><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">"13.5.1"</span></span><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;PackageReference Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">"HotChocolate.Data.EntityFramework"</span></strong><strong class="hljs-slc"> </strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">                    Version=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">"13.5.1"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml">
&lt;/ItemGroup&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;ProjectReference Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml">"..\..\Chapter03\Northwind.Common.DataContext</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">.SqlServer\Northwind.Common.DataContext.SqlServer.csproj"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/ItemGroup&gt;</span></strong></span>
</code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">The path to the project must not have a line break. </span><span class="koboSpan" id="kobo.527.2" xmlns="http://www.w3.org/1999/xhtml">All Hot Chocolate packages should have the same version number.</span></p>
</div>
</li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">Build the </span><code class="inlineCode"><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQLService</span></code><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml"> project at the command prompt or terminal using </span><code class="inlineCode"><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml">dotnet build</span></code><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">.
    </span><div class="note">
<p class="normal"><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml">When you reference a project outside of the current solution, you must build the project at least once at the command prompt or terminal before you can use the Visual Studio 2022 </span><strong class="screenText"><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">Build</span></strong><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml"> menu to compile it.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml">, import the namespace to work with our EF Core model for the Northwind database, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">// To use AddNorthwindContext method.</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml">Add a statement after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml">CreateBuilder</span></code><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml"> method to register the </span><code class="inlineCode"><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml">Northwind</span></code><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml"> database context class, and add a statement after adding the GraphQL server support to register the </span><code class="inlineCode"><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindContent</span></code><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml"> class for dependency injection, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services.AddNorthwindContext();</span></strong></span><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml">
builder.Services
  .AddGraphQLServer()
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">  .RegisterDbContext&lt;NorthwindContext&gt;()</span></strong></span><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">
  .AddQueryType&lt;Query&gt;();
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">Query.cs</span></code><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">, add statements</span><a id="_idIndexMarker1258"/><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> to define an object graph type that has some types of queries to return a list of categories, a single category, products for a category, products with a minimum unit price, and all products, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml">using</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.EntityFrameworkCore; </span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">// To use Include method.</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">using</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">// To use NorthwindContext.</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></span><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">GetGreeting</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span><span class="hljs-string"><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">"Hello, World!"</span></span><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">Farewell</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span><span class="hljs-string"><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">"Ciao! </span><span class="koboSpan" id="kobo.582.2" xmlns="http://www.w3.org/1999/xhtml">Ciao!"</span></span><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">RollTheDie</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; Random.Shared.Next(</span><span class="hljs-number"><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">7</span></span><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">);
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Category&gt; </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">GetCategories</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindContext db</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">)</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">    db.Categories.Include(c =&gt; c.Products);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml"> Category? </span><span class="koboSpan" id="kobo.602.2" xmlns="http://www.w3.org/1999/xhtml">GetCategory(NorthwindContext db, </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">int</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml"> categoryId)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml">  {</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">    Category? </span><span class="koboSpan" id="kobo.606.2" xmlns="http://www.w3.org/1999/xhtml">category = db.Categories.Find(categoryId);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml"> (category == </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml">) </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml">    db.Entry(category).Collection(c =&gt; c.Products).Load();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml"> category;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml">  }</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Product&gt; </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml">GetProducts</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindContext db</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml">)</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">    db.Products.Include(p =&gt; p.Category);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Product&gt; </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml">GetProductsInCategory</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml">    NorthwindContext db, </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml">int</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml"> categoryId</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml">)</span></strong></span> <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml">=&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml">      db.Products.Where(p =&gt; p.CategoryId == categoryId);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml">public</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Product&gt; </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">GetProductsByUnitPrice</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml">    NorthwindContext db, </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml">decimal</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml"> minimumUnitPrice</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml">)</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml">      db.Products.Where(p =&gt; p.UnitPrice &gt;= minimumUnitPrice);</span></strong></span><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-450"><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml">Exploring GraphQL queries with Northwind</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">Now we can test writing GraphQL queries</span><a id="_idIndexMarker1259"/><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml"> for the categories and products </span><a id="_idIndexMarker1260"/><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">in the Northwind database:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">If your database server is not running, for example, because you are hosting it in Docker, a virtual machine, or the cloud, then make sure to start it.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">Schema Definition</span></strong><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and note the query and type definitions for </span><code class="inlineCode"><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">Category</span></code><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">, as partially shown in </span><em class="italic"><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.5</span></em><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.5: Schema for querying the Northwind categories and products using GraphQL</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">Note the full</span><a id="_idIndexMarker1261"/><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml"> definitions in the following</span><a id="_idIndexMarker1262"/><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml"> code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">type Query </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml">
  greeting</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.678.2" xmlns="http://www.w3.org/1999/xhtml">farewell</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.680.2" xmlns="http://www.w3.org/1999/xhtml">rollTheDie</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml"> Int!
  </span><span class="koboSpan" id="kobo.682.2" xmlns="http://www.w3.org/1999/xhtml">categories</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml">Category!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml">!
  </span><span class="koboSpan" id="kobo.687.2" xmlns="http://www.w3.org/1999/xhtml">category(categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml"> Int!)</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml"> Category
  products</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">Product!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml">!
  </span><span class="koboSpan" id="kobo.696.2" xmlns="http://www.w3.org/1999/xhtml">productsInCategory(categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml"> Int!)</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">Product!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml">!
  </span><span class="koboSpan" id="kobo.703.2" xmlns="http://www.w3.org/1999/xhtml">productsByUnitPrice(minimumUnitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml"> Decimal!)</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml">Product!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">
type Category </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">
  categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml"> Int!
  </span><span class="koboSpan" id="kobo.716.2" xmlns="http://www.w3.org/1999/xhtml">categoryName</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.718.2" xmlns="http://www.w3.org/1999/xhtml">description</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml"> String
  picture</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml">Byte!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml">
  products</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">Product!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">
type Product </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">
  productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml"> Int!
  </span><span class="koboSpan" id="kobo.736.2" xmlns="http://www.w3.org/1999/xhtml">productName</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.738.2" xmlns="http://www.w3.org/1999/xhtml">supplierId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  quantityPerUnit</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml"> String
  unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml"> Decimal
  unitsInStock</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  unitsOnOrder</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  reorderLevel</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  discontinued</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml"> Boolean!
  </span><span class="koboSpan" id="kobo.754.2" xmlns="http://www.w3.org/1999/xhtml">category</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml"> Category
  orderDetails</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml">OrderDetail!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml">!
  </span><span class="koboSpan" id="kobo.761.2" xmlns="http://www.w3.org/1999/xhtml">supplier</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml"> Supplier
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and write a named query to request the ID, name, and description fields for all categories, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">query AllCategories </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">
  categories </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">
    categoryId
    categoryName
    description
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">, and note</span><a id="_idIndexMarker1263"/><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml"> the response, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.6</span></em><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml"> and the following</span><a id="_idIndexMarker1264"/><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml"> partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "categories": [
      {
        "categoryId": 1,
        "categoryName": "Beverages",
        "description": "Soft drinks, coffees, teas, beers, and ales"
      },
      {
        "categoryId": 2,
        "categoryName": "Condiments",
        "description": "Sweet and savory sauces, relishes, spreads, and seasonings"
      },
      ...
</span></code></pre>
</li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.6: Getting all categories</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="8"><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml"> to open a tab for a new document named </span><strong class="screenText"><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml">untitled 2</span></strong><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">, and write a query to request the category with ID </span><code class="inlineCode"><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml">2</span></code><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml">, including the ID, name, and price of its products, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml">query Condiments </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml">
  category (categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml">2</span></span><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">
    categoryId
    categoryName
    products </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
      unitPrice
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml">Make sure that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">I</span></code><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><code class="inlineCode"><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">categoryId</span></code><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml"> is uppercase.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml">, and note</span><a id="_idIndexMarker1265"/><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml"> the response, as shown in the following</span><a id="_idIndexMarker1266"/><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml"> partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "category": {
      "categoryId": 2,
      "categoryName": "Condiments",
      "products": [
        {
          "productId": 3,
          "productName": "Aniseed Syrup",
          "unitPrice": 10
        },
        {
          "productId": 4,
          "productName": "Chef Anton's Cajun Seasoning",
          "unitPrice": 22
        },
        ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">In the GraphQL web service command prompt or terminal, note the SQL statements executed for this query, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml">info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (68ms) [Parameters=[@__p_0='?' </span><span class="koboSpan" id="kobo.817.2" xmlns="http://www.w3.org/1999/xhtml">(DbType = Int32)], CommandType='Text', CommandTimeout='30']
      SELECT TOP(1) [c].[CategoryId], [c].[CategoryName], [c].[Description], [c].[Picture]
      FROM [Categories] AS [c]
      WHERE [c].[CategoryId] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__p_0='?' </span><span class="koboSpan" id="kobo.817.3" xmlns="http://www.w3.org/1999/xhtml">(DbType = Int32)], CommandType='Text', CommandTimeout='30']
      SELECT [p].[ProductId], [p].[CategoryId], [p].[Discontinued], [p].[ProductName], [p].[QuantityPerUnit], [p].[ReorderLevel], [p].[SupplierId], [p].[UnitPrice], [p].[UnitsInStock], [p].[UnitsOnOrder]
      FROM [Products] AS [p]
      WHERE [p].[CategoryId] = @__p_0
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml">Although the GraphQL query did not need the picture of each category and only needed the ID, name, and unit price, the dynamically-generated queries from EF Core returned all properties.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="11"><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml"> tab to open</span><a id="_idIndexMarker1267"/><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml"> a new tab, and write a query</span><a id="_idIndexMarker1268"/><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml"> to request the ID, name, and units in stock of the products in the category with ID </span><code class="inlineCode"><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml">1</span></code><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">query BeverageProducts </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml">
  productsInCategory (categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml">
    productId
    productName
    unitsInStock
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "productsInCategory": [
      {
        "productId": 1,
        "productName": "Chai",
        "unitsInStock": 39
      },
      {
        "productId": 2,
        "productName": "Chang",
        "unitsInStock": 17
      },
      ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml"> tab to open</span><a id="_idIndexMarker1269"/><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml"> a new tab, and write a query</span><a id="_idIndexMarker1270"/><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml"> to request the ID, name, and units in stock of products, along with their category names, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">query ProductsWithCategoryNames </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml">
  products </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml">
    productId
    productName
    category </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml">
      categoryName
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">
    unitsInStock
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": [
      {
        "productId": 1,
        "productName": "Chai",
        "category": {
          "categoryName": "Beverages"
        },
        "unitsInStock": 39
      },
      {
        "productId": 2,
        "productName": "Chang",
        "category": {
          "categoryName": "Beverages"
        },
        "unitsInStock": 17
      },
      ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml"> tab to open a new tab, and write a query</span><a id="_idIndexMarker1271"/><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml"> to request the ID and name of a category, select the category</span><a id="_idIndexMarker1272"/><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml"> by specifying its category ID, and include the ID and name for each of its products. </span><span class="koboSpan" id="kobo.864.2" xmlns="http://www.w3.org/1999/xhtml">The ID of the category will be set using a variable, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml">query CategoryAndItsProducts($id: Int!){
  category(categoryId: $id) {
    categoryId
    categoryName
    products {
      productId
      productName
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><strong class="screenText"><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">Variables</span></strong><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml"> section, define a value for the variable, as shown in the following code and in </span><em class="italic"><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.7</span></em><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml">:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">id"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.7: Executing a GraphQL query with a variable</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="17"><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml">, and note</span><a id="_idIndexMarker1273"/><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml"> the response, as shown in the following</span><a id="_idIndexMarker1274"/><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml"> partial output:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml">"data"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">"category"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">"categoryId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml">"categoryName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">"Beverages"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">"products"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml">"productId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">"productName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">"Chai"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml">},</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml">productId"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml">2</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">"productName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml">"Chang"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">},</span></span><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">
        ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml"> tab to open a new tab, write a query to request the ID and name of a category, select the category</span><a id="_idIndexMarker1275"/><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml"> by specifying its category ID, and include</span><a id="_idIndexMarker1276"/><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml"> the ID and name for each of its products. </span><span class="koboSpan" id="kobo.926.2" xmlns="http://www.w3.org/1999/xhtml">The ID of the category will be set using a variable, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">query ProductsWithMinimumPrice($unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml"> Decimal!)</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml">
  productsByUnitPrice(minimumUnitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml"> $unitPrice) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
      unitPrice
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><strong class="screenText"><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml">Variables</span></strong><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml"> section, define a value for the variable, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml">"unitPrice"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">100</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "productsByUnitPrice": [
      {
        "productId": 29,
        "productName": "Thüringer Rostbratwurst",
        "unitPrice": 123.79
      },
      {
        "productId": 38,
        "productName": "Côte de Blaye",
        "unitPrice": 263.5
      }
    ]
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and</span><a id="_idIndexMarker1277"/><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml"> shut down</span><a id="_idIndexMarker1278"/><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml"> the web server.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-451"><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">Implementing paging support</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml">When we request products </span><a id="_idIndexMarker1279"/><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml">using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml">GetProducts</span></code><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml"> method (the </span><code class="inlineCode"><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml">products</span></code><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml"> query), all 77 products</span><a id="_idIndexMarker1280"/><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml"> are returned. </span><span class="koboSpan" id="kobo.960.2" xmlns="http://www.w3.org/1999/xhtml">Let’s add paging support:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml">Query.cs</span></code><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml">, add statements to define a query to return all products, using paging, and note that its implementation is the same as the query for products without paging, but it is decorated with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml">[UsePaging]</span></code><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"> attribute, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-selector-attr"><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">[UsePaging]</span></span><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml">
public IQueryable&lt;Product&gt; GetProductsWithPaging(NorthwindContext db) =&gt;
  db</span><span class="hljs-selector-attr"><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml">.Products.Include</span></span><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-selector-tag"><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt; </span><span class="hljs-selector-tag"><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-selector-attr"><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml">.Category</span></span><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml">);
</span></code></pre>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">Good Practice</span></strong><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">: The </span><code class="inlineCode"><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">[UsePaging]</span></code><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml">[UseFiltering]</span></code><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml">[UseSorting]</span></code><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml"> attributes must be decorated onto a query method that returns </span><code class="inlineCode"><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml">IQueryable&lt;T&gt;</span></code><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml"> , allowing GraphQL to dynamically configure the LINQ query before executing it against the data store.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml">Schema Definition</span></strong><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and note the queries named </span><code class="inlineCode"><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml">products</span></code><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml"> (without paging) and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml">productsWithPaging</span></code><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml">, which documents how to use the query to request a page of products, as shown in the following output:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml">products: [Product!]!
</span><span class="koboSpan" id="kobo.1002.2" xmlns="http://www.w3.org/1999/xhtml">productsInCategory(categoryId: Int!): [Product!]!
</span><span class="koboSpan" id="kobo.1002.3" xmlns="http://www.w3.org/1999/xhtml">productsByUnitPrice(minimumUnitPrice: Decimal!): [Product!]!
</span><span class="koboSpan" id="kobo.1002.4" xmlns="http://www.w3.org/1999/xhtml">productsWithPaging(
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml">"""</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml">  Returns the first _n_ elements from the list.</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml">  """</span></span><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">
  first: Int
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml">"""</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml">  Returns the elements in the list that come after the specified cursor.</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml">  """</span></span><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">
  after: String
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml">"""</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">  Returns the last _n_ elements from the list.</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">  """</span></span><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml">
  last: Int
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">"""</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml">  Returns the elements in the list that come before the specified cursor.</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml">  """</span></span><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">
  before: String
): ProductsWithPagingConnection
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and write</span><a id="_idIndexMarker1281"/><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml"> a named query to request</span><a id="_idIndexMarker1282"/><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml"> the first page of 10 products, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml">query FirstTenProducts </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">
  productsWithPaging(first</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">10</span></span><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">
    pageInfo </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml">
      hasPreviousPage
      hasNextPage
      startCursor
      endCursor
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml">
    nodes </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">pageInfo</span></code><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml"> section, which tells us that there is another page of products and the cursor for this page ranges from </span><code class="inlineCode"><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml">MA==</span></code><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml">OQ==</span></code><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "productsWithPaging": {
      "pageInfo": {
        "hasPreviousPage": false,
        "hasNextPage": true,
        "startCursor": "MA==",
        "endCursor": "OQ=="
      },
      "nodes": [
        {
          "productId": 1,
          "productName": "Chai"
        },
...
</span><span class="koboSpan" id="kobo.1050.2" xmlns="http://www.w3.org/1999/xhtml">{
          "productId": 10,
          "productName": "Ikura"
        }
      ]
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab, and write</span><a id="_idIndexMarker1283"/><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml"> a named query to request</span><a id="_idIndexMarker1284"/><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml"> the second page of 10 products, by specifying that we want the cursor that starts after </span><code class="inlineCode"><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml">OQ==</span></code><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml">query SecondTenProducts </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml">
  productsWithPaging(after</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml">OQ=="</span></span><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml">
    pageInfo </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml">
      hasPreviousPage
      hasNextPage
      startCursor
      endCursor
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml">
    nodes </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml">pageInfo</span></code><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml"> section, which tells us that there is another page of products and the cursor for this page ranges from </span><code class="inlineCode"><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml">MTA=</span></code><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml">MTk=</span></code><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following partial output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "productsWithPaging": {
      "pageInfo": {
        "hasPreviousPage": true,
        "hasNextPage": true,
        "startCursor": "MTA=",
        "endCursor": "MTk="
      },
      "nodes": [
        {
          "productId": 11,
          "productName": "Queso Cabrales"
        },
...
</span><span class="koboSpan" id="kobo.1085.2" xmlns="http://www.w3.org/1999/xhtml">{
          "productId": 20,
          "productName": "Sir Rodney's Marmalade"
        }
      ]
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and shut down</span><a id="_idIndexMarker1285"/><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml"> the web</span><a id="_idIndexMarker1286"/><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml"> server.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-452"><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml">Implementing filtering support</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml">When we explored queries earlier</span><a id="_idIndexMarker1287"/><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml"> in this chapter, we predefined</span><a id="_idIndexMarker1288"/><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml"> some queries with parameters, for example, a query that returns all the products in a category by passing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml">categoryId</span></code><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml"> parameter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml">However, what if you do not know ahead of time what filtering you want to perform?</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">Let’s add filtering support to our GraphQL queries:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml">, add a call to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">AddFiltering</span></code><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml"> after calling </span><code class="inlineCode"><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml">AddGraphQLServer</span></code><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services
  .AddGraphQLServer()
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml">  .AddFiltering()</span></strong></span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml">
  .RegisterDbContext&lt;NorthwindContext&gt;()
  .AddQueryType&lt;Query&gt;();
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">Query.cs</span></code><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml">, decorate the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml">GetProducts</span></code><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml"> method with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">[UseFiltering]</span></code><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml"> attribute, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml">[</span></strong><strong class="hljs-meta-slc"><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml">UseFiltering</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml">]</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Product&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml">GetProducts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt;
  db.Products.Include(p =&gt; p.Category);
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">Scheme Definition</span></strong><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml"> , and note</span><a id="_idIndexMarker1289"/><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml"> that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml">products</span></code><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml"> query</span><a id="_idIndexMarker1290"/><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml"> now accepts a filter input, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml">products(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml">where</span></span><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml">: ProductFilterInput): [Product!]!
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml">Scroll down the schema definition to find </span><code class="inlineCode"><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml">ProductFilterInput</span></code><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml">, and note the filtering options include Boolean operators like </span><code class="inlineCode"><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml">and</span></code><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml">or</span></code><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml">, as well as field filters like </span><code class="inlineCode"><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml">IntOperationFilterInput</span></code><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml">StringOperationFilterInput</span></code><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following markup:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml">input ProductFilterInput {
  and: [ProductFilterInput!]
  or: [ProductFilterInput!]
  productId: IntOperationFilterInput
  productName: StringOperationFilterInput
  supplierId: IntOperationFilterInput
  categoryId: IntOperationFilterInput
  quantityPerUnit: StringOperationFilterInput
  unitPrice: DecimalOperationFilterInput
  unitsInStock: ShortOperationFilterInput
  unitsOnOrder: ShortOperationFilterInput
  reorderLevel: ShortOperationFilterInput
  discontinued: BooleanOperationFilterInput
  category: CategoryFilterInput
  orderDetails: ListFilterInputTypeOfOrderDetailFilterInput
  supplier: SupplierFilterInput
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">Scroll down the schema definition</span><a id="_idIndexMarker1291"/><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml"> to find </span><code class="inlineCode"><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml">IntOperationFilterInput</span></code><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml">StringOperationFilterInput</span></code><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">, and note the operations</span><a id="_idIndexMarker1292"/><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"> you can use with them, like equals (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml">eq</span></code><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml">), not equals (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">neq</span></code><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml">), in an array (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml">in</span></code><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml">), greater than (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml">gt</span></code><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml">), </span><code class="inlineCode"><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml">contains</span></code><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml">startsWith</span></code><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following markup:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">input IntOperationFilterInput {
  eq: Int
  neq: Int
  in: [Int]
  nin: [Int]
  gt: Int
  ngt: Int
  gte: Int
  ngte: Int
  lt: Int
  nlt: Int
  lte: Int
  nlte: Int
}
input StringOperationFilterInput {
  and: [StringOperationFilterInput!]
  or: [StringOperationFilterInput!]
  eq: String
  neq: String
  contains: String
  ncontains: String
  in: [String]
  nin: [String]
  startsWith: String
  nstartsWith: String
  endsWith: String
  nendsWith: String
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">, and then write a named query to request products with more than </span><code class="inlineCode"><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">120</span></code><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml"> units in stock, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">query ProductsWithMoreThan40InStock {
  products(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml">where</span></span><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml">: { unitsInStock: { gt: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">120</span></span><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml"> } }) {
    productId
    productName
    unitsInStock
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": [
      {
        "productId": 40,
        "productName": "Boston Crab Meat",
        "unitsInStock": 123
      },
      {
        "productId": 75,
        "productName": "Rhönbräu Klosterbier",
        "unitsInStock": 125
      }
    ]
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab, click </span><strong class="screenText"><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml">, and then write a named query to request products whose</span><a id="_idIndexMarker1293"/><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml"> names start with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">Cha</span></code><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml">, as shown</span><a id="_idIndexMarker1294"/><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml"> in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml">query ProductNamesCha {
  products(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml">where</span></span><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml">: { productName: { startsWith: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml">"Cha"</span></span><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml"> } }) {
    productId
    productName
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": [
      {
        "productId": 1,
        "productName": "Chai"
      },
      {
        "productId": 2,
        "productName": "Chang"
      },
      {
        "productId": 39,
        "productName": "Chartreuse verte"
      }
    ]
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml">In the GraphQL service command prompt or terminal, note the EF Core-generated SQL filters using parameters, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml">info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (2ms) [Parameters=[@__p_0_rewritten='?' </span><span class="koboSpan" id="kobo.1209.2" xmlns="http://www.w3.org/1999/xhtml">(Size = 40)], CommandType='Text', CommandTimeout='30']
      SELECT [p].[ProductId], [p].[CategoryId], [p].[Discontinued], [p].[ProductName], [p].[QuantityPerUnit], [p].[ReorderLevel], [p].[SupplierId], [p].[UnitPrice], [p].[UnitsInStock], [p].[UnitsOnOrder], [c].[CategoryId], [c].[CategoryName], [c].[Description], [c].[Picture]
      FROM [Products] AS [p]
      LEFT JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[CategoryId]
      WHERE [p].[ProductName] LIKE @__p_0_rewritten ESCAPE N'\'
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and</span><a id="_idIndexMarker1295"/><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml"> shut down</span><a id="_idIndexMarker1296"/><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml"> the web server.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-453"><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml">Implementing sorting support</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml">To enable sorting</span><a id="_idIndexMarker1297"/><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml"> with a GraphQL service, call </span><a id="_idIndexMarker1298"/><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml">AddSorting</span></code><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml"> method, as highlighted in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services
  .AddGraphQLServer()
  .AddFiltering()
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml">  .AddSorting()</span></strong></span><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml">
  .RegisterDbContext&lt;NorthwindContext&gt;()
  .AddQueryType&lt;Query&gt;();
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml">Then, decorate a query method that returns </span><code class="inlineCode"><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml">IQueryable&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml">[UseSorting]</span></code><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml"> attribute, as highlighted in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml">[</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml">UseFiltering</span></span><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">]
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml">[</span></strong><strong class="hljs-meta-slc"><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml">UseSorting</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml">]</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml"> IQueryable&lt;Product&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">GetProducts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml"> =&gt;
  db.Products.Include(p =&gt; p.Category);
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml">In a query, apply one or more sort orders, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml">query ProductsSortedByMostExpensive {
  products(order: [ { unitPrice: DESC } ]) {
    productId
    productName
    unitPrice
  }
}
</span></code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">SortEnumType</span></code><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml"> has two values, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in"><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml">enum</span></span><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml"> SortEnumType {
  ASC
  DESC
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml">I will leave adding sorting capabilities</span><a id="_idIndexMarker1299"/><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml"> to your GraphQL service</span><a id="_idIndexMarker1300"/><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml"> to you.</span></p>
<h1 class="heading-1" id="_idParaDest-454"><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml">Building .NET clients for a GraphQL service</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have explored some queries</span><a id="_idIndexMarker1301"/><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml"> with the </span><strong class="screenText"><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml"> tool, let’s see how a client</span><a id="_idIndexMarker1302"/><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml"> could call the GraphQL service. </span><span class="koboSpan" id="kobo.1254.2" xmlns="http://www.w3.org/1999/xhtml">Although the </span><strong class="screenText"><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml"> tool is convenient, it runs in the same domain as the service, so some issues might not become apparent until we create a separate client.</span></p>
<h2 class="heading-2" id="_idParaDest-455"><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml">Choosing GraphQL request formats</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">Most GraphQL services process </span><code class="inlineCode"><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml"> requests</span><a id="_idIndexMarker1303"/><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml"> in either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">application/graphql</span></code><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">application/json</span></code><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml"> media formats. </span><span class="koboSpan" id="kobo.1267.2" xmlns="http://www.w3.org/1999/xhtml">An </span><code class="inlineCode"><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml">application/graphql</span></code><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml"> request would only contain a query document. </span><span class="koboSpan" id="kobo.1269.2" xmlns="http://www.w3.org/1999/xhtml">The benefit of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml">application/json</span></code><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml"> is that as well as the query document, you can specify operations when you have more than one, and define and set variables, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">{
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml">"query"</span></span><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml">"..."</span></span><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml">"operationName"</span></span><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">"..."</span></span><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml">"variables"</span></span><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml">: { </span><span class="hljs-string"><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml">variable1"</span></span><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml">"value1"</span></span><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml">, ... </span><span class="koboSpan" id="kobo.1287.2" xmlns="http://www.w3.org/1999/xhtml">}
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml">We will use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">application/json</span></code><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml"> media format so that we can pass variables and their values.</span></p>
<h2 class="heading-2" id="_idParaDest-456"><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">Understanding the GraphQL response format</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">A GraphQL service should return a JSON document</span><a id="_idIndexMarker1304"/><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml"> containing the expected data object and maybe some errors in an array, with the following structure:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">{
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">"data"</span></span><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">: { ... </span><span class="koboSpan" id="kobo.1296.2" xmlns="http://www.w3.org/1999/xhtml">},
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">"errors"</span></span><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml">: [ ... </span><span class="koboSpan" id="kobo.1298.2" xmlns="http://www.w3.org/1999/xhtml">]
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml">errors</span></code><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml"> array should only be in the document if there are errors.</span></p>
<h2 class="heading-2" id="_idParaDest-457"><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml">Using REST Client as a GraphQL client</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml">Before we write code as a client</span><a id="_idIndexMarker1305"/><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml"> to the GraphQL service, it would be good</span><a id="_idIndexMarker1306"/><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml"> to test it with your code editor’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml">.http</span></code><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml"> file support. </span><span class="koboSpan" id="kobo.1307.2" xmlns="http://www.w3.org/1999/xhtml">This is so that if our .NET client app does not work, we know the problem is in our client code rather than the service:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio Code and have not already installed REST Client by Huachao Mao (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml">humao.rest-client</span></code><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml">), then install it now.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml">In your preferred code editor, start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml"> project web service, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging, and leave it running.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml">In your code editor, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml">HttpRequests</span></code><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml"> folder, create a file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml">graphql-queries.http</span></code><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">, and modify</span><a id="_idIndexMarker1307"/><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml"> its contents to contain</span><a id="_idIndexMarker1308"/><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml"> a request to get products in the seafood category, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">### Configure a variable for the GraphQL service base address.</span></span><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml">
@base_address = https:</span><span class="hljs-comment"><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">//localhost:5121/graphql</span></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml">### Get all products in the specified category.</span></span><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">
POST {{base_address}}
Content-Type: application/json
{
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">"query"</span></span><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml"> : </span><span class="hljs-string"><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">"{productsInCategory(categoryId:8){productId productName unitsInStock}}"</span></span><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml">Send the query request, and note the response, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.8</span></em><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.8: Requesting seafood products using REST Client</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml">Add a query to make a request to get the ID, name, and description of all categories, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">### Get all categories.</span></span><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml">
POST {{base_address}}
Content-Type: application/json
{
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml">"query"</span></span><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml"> : </span><span class="hljs-string"><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml">"{categories{categoryId categoryName description}}"</span></span><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml">Send the query request, and note</span><a id="_idIndexMarker1309"/><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml"> the response contains the eight categories</span><a id="_idIndexMarker1310"/><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml"> in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml">data</span></code><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml"> property.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">In the query document, change </span><code class="inlineCode"><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">categoryId</span></code><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml">Send the query request, and note the response contains an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml">errors</span></code><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml"> array, as shown in the following response:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">Response time: 60 ms
Status code: BadRequest (400)
Alt-Svc: h3=":5121"; ma=86400
Transfer-Encoding: chunked
Date: Tue, 06 Jun 2023 16:35:18 GMT
Server: Kestrel
Content-Type: application/graphql-response+json; charset=utf-8
Content-Length: 338
------------------------------------------------
Content:
{
  "errors": [
    {
      "message": "The field `id` does not exist on the type `Category`.",
      "locations": [
        {
          "line": 1,
          "column": 13
        }
      ],
      "path": [
        "categories"
      ],
      "extensions": {
        "type": "Category",
        "field": "id",
        "responseName": "id",
        "specifiedBy": "http://spec.graphql.org/October2021/#sec-Field-Selections-on-Objects-Interfaces-and-Unions-Types"
      }
    }
  ]
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml">In the query document, change </span><code class="inlineCode"><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml"> back to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml">categoryId</span></code><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml">Add a query to request</span><a id="_idIndexMarker1311"/><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml"> to get the ID and name of a category</span><a id="_idIndexMarker1312"/><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml"> specified by a parameter for its ID, along with the ID and name of each of its products, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">### Get a category and its products using a variable.</span></span><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml">
POST {{base_address}}
Content-Type: application/json
{
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">"query"</span></span><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">"query categoryAndItsProducts($id: Int!){category(categoryId: $id){categoryId categoryName products{productId productName}}}"</span></span><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">"variables"</span></span><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml">: {</span><span class="hljs-string"><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml">"id"</span></span><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">:</span><span class="hljs-number"><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml">}
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">Send the query request, and note the response contains category </span><code class="inlineCode"><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">1</span></code><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml">Beverages</span></code><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml">, with its products in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">data</span></code><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml"> property.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml">Change the ID to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml">4</span></code><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml">, send the request, and note the response contains category </span><code class="inlineCode"><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml">4</span></code><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml">Dairy Products</span></code><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">, with its products in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml">data</span></code><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml"> property.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have done some basic</span><a id="_idIndexMarker1313"/><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml"> testing of the service and its responses</span><a id="_idIndexMarker1314"/><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml"> to queries that we want to run, we can build a client to make those queries and process the JSON responses.</span></p>
<h2 class="heading-2" id="_idParaDest-458"><span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml">Using an ASP.NET Core MVC project as a GraphQL client</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml">We will create a model class to make</span><a id="_idIndexMarker1315"/><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml"> it easy to deserialize</span><a id="_idIndexMarker1316"/><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml"> the response:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to add a new project, as defined in the following list:</span><ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core Web App (Model-View-Controller)</span></strong><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">mvc</span></code></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml">Chapter12</span></code></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">Other Visual Studio 2022 options: </span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml">Authentication Type</span></strong><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml">: None</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml">Configure for HTTPS</span></strong><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml">: Selected</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml">Enable Docker</span></strong><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml">: Cleared</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml">Do not use top-level statements</span></strong><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml">: Cleared</span></li>
</ul>
</li>
</ol>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml">In Visual Studio 2022, set the startup project with the current selection.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a project reference to the Northwind entity models project, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;ProjectReference Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml">"..\..\Chapter03\Northwind.Common.EntityModels</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml">.SqlServer\Northwind.Common.EntityModels.SqlServer.csproj"</span></span><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml">The path to the project must not have a line break.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml">Build the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml"> project at the command prompt or terminal.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">Properties</span></code><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml"> folder, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml">launchSettings.json</span></code><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml">, modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">applicationUrl</span></code><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml"> to use port </span><code class="inlineCode"><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml">5123</span></code><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml"> and port </span><code class="inlineCode"><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml">5124</span></code><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml">http</span></code><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml">, as highlighted in the following configuration:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml">"https"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">{</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml">"commandName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml">"Project"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml">"dotnetRunMessages"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml">"launchBrowser"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml">"applicationUrl"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5123;http://localhost:5124"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml">"environmentVariables"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml">"ASPNETCORE_ENVIRONMENT"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1469.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1470.1" xmlns="http://www.w3.org/1999/xhtml">"Development"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1471.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1472.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1473.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.1474.1" xmlns="http://www.w3.org/1999/xhtml"> project, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1475.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></code><span class="koboSpan" id="kobo.1476.1" xmlns="http://www.w3.org/1999/xhtml"> folder, add</span><a id="_idIndexMarker1317"/><span class="koboSpan" id="kobo.1477.1" xmlns="http://www.w3.org/1999/xhtml"> a new class file</span><a id="_idIndexMarker1318"/><span class="koboSpan" id="kobo.1478.1" xmlns="http://www.w3.org/1999/xhtml"> named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1479.1" xmlns="http://www.w3.org/1999/xhtml">ResponseErrors.cs</span></code><span class="koboSpan" id="kobo.1480.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1481.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1482.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc.Models</span></span><span class="koboSpan" id="kobo.1483.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1484.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1485.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1486.1" xmlns="http://www.w3.org/1999/xhtml">ResponseErrors</span></span><span class="koboSpan" id="kobo.1487.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1488.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1489.1" xmlns="http://www.w3.org/1999/xhtml"> Error[]? </span><span class="koboSpan" id="kobo.1489.2" xmlns="http://www.w3.org/1999/xhtml">Errors { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1490.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1491.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1492.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1493.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1494.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1495.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1496.1" xmlns="http://www.w3.org/1999/xhtml">Error</span></span><span class="koboSpan" id="kobo.1497.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1498.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1499.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1500.1" xmlns="http://www.w3.org/1999/xhtml"> Message { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1501.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1502.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1503.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1504.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1505.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.1506.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1507.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1508.1" xmlns="http://www.w3.org/1999/xhtml"> Location[] Locations { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1509.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1510.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1511.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1512.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1513.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.1514.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1515.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1516.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1517.1" xmlns="http://www.w3.org/1999/xhtml">[] Path { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1518.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1519.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1520.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1521.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1522.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.1523.1" xmlns="http://www.w3.org/1999/xhtml">!;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1524.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1525.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1526.1" xmlns="http://www.w3.org/1999/xhtml">Location</span></span><span class="koboSpan" id="kobo.1527.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1528.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1529.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.1530.1" xmlns="http://www.w3.org/1999/xhtml"> Line { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1531.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1532.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1533.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1534.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1535.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1536.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.1537.1" xmlns="http://www.w3.org/1999/xhtml"> Column { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1538.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1539.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1540.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1541.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1542.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1543.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></code><span class="koboSpan" id="kobo.1544.1" xmlns="http://www.w3.org/1999/xhtml"> folder, add a new class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1545.1" xmlns="http://www.w3.org/1999/xhtml">ResponseProducts.cs</span></code><span class="koboSpan" id="kobo.1546.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1547.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1548.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1549.1" xmlns="http://www.w3.org/1999/xhtml">// To use Product.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1550.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1551.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc.Models</span></span><span class="koboSpan" id="kobo.1552.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1553.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1554.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1555.1" xmlns="http://www.w3.org/1999/xhtml">ResponseProducts</span></span><span class="koboSpan" id="kobo.1556.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1557.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1558.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1559.1" xmlns="http://www.w3.org/1999/xhtml">DataProducts</span></span><span class="koboSpan" id="kobo.1560.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1561.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1562.1" xmlns="http://www.w3.org/1999/xhtml"> Product[]? </span><span class="koboSpan" id="kobo.1562.2" xmlns="http://www.w3.org/1999/xhtml">ProductsInCategory { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1563.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1564.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1565.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1566.1" xmlns="http://www.w3.org/1999/xhtml">; }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1567.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1568.1" xmlns="http://www.w3.org/1999/xhtml"> DataProducts? </span><span class="koboSpan" id="kobo.1568.2" xmlns="http://www.w3.org/1999/xhtml">Data { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1569.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1570.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1571.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1572.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1573.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1574.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></code><span class="koboSpan" id="kobo.1575.1" xmlns="http://www.w3.org/1999/xhtml"> folder, add a new</span><a id="_idIndexMarker1319"/><span class="koboSpan" id="kobo.1576.1" xmlns="http://www.w3.org/1999/xhtml"> class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1577.1" xmlns="http://www.w3.org/1999/xhtml">ResponseCategories.cs</span></code><span class="koboSpan" id="kobo.1578.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following</span><a id="_idIndexMarker1320"/><span class="koboSpan" id="kobo.1579.1" xmlns="http://www.w3.org/1999/xhtml"> code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1580.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1581.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1582.1" xmlns="http://www.w3.org/1999/xhtml">// To use Category.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1583.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1584.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc.Models</span></span><span class="koboSpan" id="kobo.1585.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1586.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1587.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1588.1" xmlns="http://www.w3.org/1999/xhtml">ResponseCategories</span></span><span class="koboSpan" id="kobo.1589.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1590.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1591.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1592.1" xmlns="http://www.w3.org/1999/xhtml">DataCategories</span></span><span class="koboSpan" id="kobo.1593.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1594.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1595.1" xmlns="http://www.w3.org/1999/xhtml"> Category[]? </span><span class="koboSpan" id="kobo.1595.2" xmlns="http://www.w3.org/1999/xhtml">Categories { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1596.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1597.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1598.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1599.1" xmlns="http://www.w3.org/1999/xhtml">; }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1600.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1601.1" xmlns="http://www.w3.org/1999/xhtml"> DataCategories? </span><span class="koboSpan" id="kobo.1601.2" xmlns="http://www.w3.org/1999/xhtml">Data { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1602.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1603.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1604.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1605.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1606.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1607.1" xmlns="http://www.w3.org/1999/xhtml">Models</span></code><span class="koboSpan" id="kobo.1608.1" xmlns="http://www.w3.org/1999/xhtml"> folder, add a new class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1609.1" xmlns="http://www.w3.org/1999/xhtml">IndexViewModel.cs</span></code><span class="koboSpan" id="kobo.1610.1" xmlns="http://www.w3.org/1999/xhtml"> , which will have properties to store all the data that we might want to show in the view, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1611.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1612.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1613.1" xmlns="http://www.w3.org/1999/xhtml">// To use Product.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1614.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1615.1" xmlns="http://www.w3.org/1999/xhtml"> System.Net; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1616.1" xmlns="http://www.w3.org/1999/xhtml">// To use HttpStatusCode.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1617.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1618.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc.Models</span></span><span class="koboSpan" id="kobo.1619.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1620.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1621.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1622.1" xmlns="http://www.w3.org/1999/xhtml">IndexViewModel</span></span><span class="koboSpan" id="kobo.1623.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1624.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1625.1" xmlns="http://www.w3.org/1999/xhtml"> HttpStatusCode Code { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1626.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1627.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1628.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1629.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1630.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1631.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1632.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.1632.2" xmlns="http://www.w3.org/1999/xhtml">RawResponseBody { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1633.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1634.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1635.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1636.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1637.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1638.1" xmlns="http://www.w3.org/1999/xhtml"> Product[]? </span><span class="koboSpan" id="kobo.1638.2" xmlns="http://www.w3.org/1999/xhtml">Products { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1639.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1640.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1641.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1642.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1643.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1644.1" xmlns="http://www.w3.org/1999/xhtml"> Category[]? </span><span class="koboSpan" id="kobo.1644.2" xmlns="http://www.w3.org/1999/xhtml">Categories { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1645.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1646.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1647.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1648.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1649.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.1650.1" xmlns="http://www.w3.org/1999/xhtml"> Error[]? </span><span class="koboSpan" id="kobo.1650.2" xmlns="http://www.w3.org/1999/xhtml">Errors { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1651.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.1652.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1653.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.1654.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1655.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.1656.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1657.1" xmlns="http://www.w3.org/1999/xhtml">, import the namespace to set HTTP headers, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1658.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1659.1" xmlns="http://www.w3.org/1999/xhtml"> System.Net.Http.Headers; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1660.1" xmlns="http://www.w3.org/1999/xhtml">// To use MediaTypeWithQualityHeaderValue.</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1661.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.1662.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1663.1" xmlns="http://www.w3.org/1999/xhtml">, after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1664.1" xmlns="http://www.w3.org/1999/xhtml">CreateBuilder</span></code><span class="koboSpan" id="kobo.1665.1" xmlns="http://www.w3.org/1999/xhtml"> method call, add statements to register an HTTP client for the GraphQL service, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1666.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services.AddHttpClient(name: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1667.1" xmlns="http://www.w3.org/1999/xhtml">"Northwind.GraphQL.Service"</span></span><span class="koboSpan" id="kobo.1668.1" xmlns="http://www.w3.org/1999/xhtml">,
  configureClient: options =&gt;
  {
    options.BaseAddress = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1669.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1670.1" xmlns="http://www.w3.org/1999/xhtml"> Uri(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1671.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5121/"</span></span><span class="koboSpan" id="kobo.1672.1" xmlns="http://www.w3.org/1999/xhtml">);
    options.DefaultRequestHeaders.Accept.Add(
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1673.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1674.1" xmlns="http://www.w3.org/1999/xhtml"> MediaTypeWithQualityHeaderValue(
      </span><span class="hljs-string"><span class="koboSpan" id="kobo.1675.1" xmlns="http://www.w3.org/1999/xhtml">"application/json"</span></span><span class="koboSpan" id="kobo.1676.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1677.1" xmlns="http://www.w3.org/1999/xhtml">1.0</span></span><span class="koboSpan" id="kobo.1678.1" xmlns="http://www.w3.org/1999/xhtml">));
  });
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1679.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1680.1" xmlns="http://www.w3.org/1999/xhtml">Controllers</span></code><span class="koboSpan" id="kobo.1681.1" xmlns="http://www.w3.org/1999/xhtml"> folder, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1682.1" xmlns="http://www.w3.org/1999/xhtml">HomeController.cs</span></code><span class="koboSpan" id="kobo.1683.1" xmlns="http://www.w3.org/1999/xhtml">, import the namespace</span><a id="_idIndexMarker1321"/><span class="koboSpan" id="kobo.1684.1" xmlns="http://www.w3.org/1999/xhtml"> to work with text encodings</span><a id="_idIndexMarker1322"/><span class="koboSpan" id="kobo.1685.1" xmlns="http://www.w3.org/1999/xhtml"> and for the local project models, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1686.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1687.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.Mvc.GraphQLClient.Models; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1688.1" xmlns="http://www.w3.org/1999/xhtml">// To use IndexViewModel.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1689.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1690.1" xmlns="http://www.w3.org/1999/xhtml"> System.Text; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1691.1" xmlns="http://www.w3.org/1999/xhtml">// To use Encoding.</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1692.1" xmlns="http://www.w3.org/1999/xhtml">Define a field to store the registered HTTP client factory, and set it in the constructor, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1693.1" xmlns="http://www.w3.org/1999/xhtml">protected</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1694.1" xmlns="http://www.w3.org/1999/xhtml">readonly</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1695.1" xmlns="http://www.w3.org/1999/xhtml"> IHttpClientFactory _clientFactory;</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1696.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1697.1" xmlns="http://www.w3.org/1999/xhtml">HomeController</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1698.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1699.1" xmlns="http://www.w3.org/1999/xhtml">ILogger&lt;HomeController&gt; logger</span></span><span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1700.1" xmlns="http://www.w3.org/1999/xhtml">, </span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1701.1" xmlns="http://www.w3.org/1999/xhtml">  IHttpClientFactory clientFactory</span></strong></span><span class="hljs-function"><span class="koboSpan" id="kobo.1702.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1703.1" xmlns="http://www.w3.org/1999/xhtml">
{
  _logger = logger;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1704.1" xmlns="http://www.w3.org/1999/xhtml">  _clientFactory = clientFactory;</span></strong></span><span class="koboSpan" id="kobo.1705.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1706.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1707.1" xmlns="http://www.w3.org/1999/xhtml">Index</span></code><span class="koboSpan" id="kobo.1708.1" xmlns="http://www.w3.org/1999/xhtml"> action method, modify the method to be asynchronous. </span><span class="koboSpan" id="kobo.1708.2" xmlns="http://www.w3.org/1999/xhtml">Then, add statements to call the GraphQL service, and note that the HTTP request is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1709.1" xmlns="http://www.w3.org/1999/xhtml">POST</span></code><span class="koboSpan" id="kobo.1710.1" xmlns="http://www.w3.org/1999/xhtml">, the media type is for an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1711.1" xmlns="http://www.w3.org/1999/xhtml">application/json</span></code><span class="koboSpan" id="kobo.1712.1" xmlns="http://www.w3.org/1999/xhtml"> document that contains a GraphQL query, and the query requests the ID, name, and number of units in stock for all products in a given category, passed as a parameter</span><a id="_idIndexMarker1323"/><span class="koboSpan" id="kobo.1713.1" xmlns="http://www.w3.org/1999/xhtml"> named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1714.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.1715.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following</span><a id="_idIndexMarker1324"/><span class="koboSpan" id="kobo.1716.1" xmlns="http://www.w3.org/1999/xhtml"> code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1717.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1718.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1719.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;IActionResult&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1720.1" xmlns="http://www.w3.org/1999/xhtml">Index</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1721.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1722.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1723.1" xmlns="http://www.w3.org/1999/xhtml"> id = </span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1724.1" xmlns="http://www.w3.org/1999/xhtml">"1"</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1725.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1726.1" xmlns="http://www.w3.org/1999/xhtml">
{
  IndexViewModel model = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1727.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1728.1" xmlns="http://www.w3.org/1999/xhtml">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1729.1" xmlns="http://www.w3.org/1999/xhtml">try</span></span><span class="koboSpan" id="kobo.1730.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    HttpClient client = _clientFactory.CreateClient(
      name: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1731.1" xmlns="http://www.w3.org/1999/xhtml">"Northwind.GraphQL.Service"</span></span><span class="koboSpan" id="kobo.1732.1" xmlns="http://www.w3.org/1999/xhtml">);
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1733.1" xmlns="http://www.w3.org/1999/xhtml">// First, try a simple GET request to service root.</span></span><span class="koboSpan" id="kobo.1734.1" xmlns="http://www.w3.org/1999/xhtml">
    HttpRequestMessage request = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1735.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1736.1" xmlns="http://www.w3.org/1999/xhtml">(
      method: HttpMethod.Get, requestUri: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1737.1" xmlns="http://www.w3.org/1999/xhtml">"/"</span></span><span class="koboSpan" id="kobo.1738.1" xmlns="http://www.w3.org/1999/xhtml">);
    HttpResponseMessage response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1739.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1740.1" xmlns="http://www.w3.org/1999/xhtml"> client.SendAsync(request);
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1741.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.1742.1" xmlns="http://www.w3.org/1999/xhtml"> (!response.IsSuccessStatusCode)
    {
      model.Code = response.StatusCode;
      model.Errors = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1743.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1744.1" xmlns="http://www.w3.org/1999/xhtml">[] { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1745.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1746.1" xmlns="http://www.w3.org/1999/xhtml"> Error { Message = 
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.1747.1" xmlns="http://www.w3.org/1999/xhtml">"Service is not successfully responding to GET requests."</span></span><span class="koboSpan" id="kobo.1748.1" xmlns="http://www.w3.org/1999/xhtml"> } };
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1749.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.1750.1" xmlns="http://www.w3.org/1999/xhtml"> View(model);
    }
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1751.1" xmlns="http://www.w3.org/1999/xhtml">// Next, make a request to the GraphQL endpoint.</span></span><span class="koboSpan" id="kobo.1752.1" xmlns="http://www.w3.org/1999/xhtml">
    request = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1753.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1754.1" xmlns="http://www.w3.org/1999/xhtml">(
      method: HttpMethod.Post, requestUri: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1755.1" xmlns="http://www.w3.org/1999/xhtml">"graphql"</span></span><span class="koboSpan" id="kobo.1756.1" xmlns="http://www.w3.org/1999/xhtml">);
    request.Content = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1757.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1758.1" xmlns="http://www.w3.org/1999/xhtml"> StringContent(content: $$</span><span class="hljs-string"><span class="koboSpan" id="kobo.1759.1" xmlns="http://www.w3.org/1999/xhtml">$"""</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1760.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1761.1" xmlns="http://www.w3.org/1999/xhtml">  "</span></span><span class="koboSpan" id="kobo.1762.1" xmlns="http://www.w3.org/1999/xhtml">query</span><span class="hljs-string"><span class="koboSpan" id="kobo.1763.1" xmlns="http://www.w3.org/1999/xhtml">": "</span></span><span class="koboSpan" id="kobo.1764.1" xmlns="http://www.w3.org/1999/xhtml">{productsInCategory(categoryId:{{{id}}}){productId productName unitsInStock}}</span><span class="hljs-string"><span class="koboSpan" id="kobo.1765.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1766.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1767.1" xmlns="http://www.w3.org/1999/xhtml">      """</span></span><span class="koboSpan" id="kobo.1768.1" xmlns="http://www.w3.org/1999/xhtml">,
      encoding: Encoding.UTF8,
      mediaType: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1769.1" xmlns="http://www.w3.org/1999/xhtml">"application/json"</span></span><span class="koboSpan" id="kobo.1770.1" xmlns="http://www.w3.org/1999/xhtml">);
    response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1771.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1772.1" xmlns="http://www.w3.org/1999/xhtml"> client.SendAsync(request);
    model.Code = response.StatusCode;
    model.RawResponseBody = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1773.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1774.1" xmlns="http://www.w3.org/1999/xhtml"> response.Content.ReadAsStringAsync();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1775.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.1776.1" xmlns="http://www.w3.org/1999/xhtml"> (response.IsSuccessStatusCode)
    {
      model.Products = (</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1777.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1778.1" xmlns="http://www.w3.org/1999/xhtml"> response.Content
        .ReadFromJsonAsync&lt;ResponseProducts&gt;())?.Data?.ProductsInCategory;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1779.1" xmlns="http://www.w3.org/1999/xhtml">else</span></span><span class="koboSpan" id="kobo.1780.1" xmlns="http://www.w3.org/1999/xhtml">
    {
      model.Errors = (</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1781.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1782.1" xmlns="http://www.w3.org/1999/xhtml"> response.Content
        .ReadFromJsonAsync&lt;ResponseErrors&gt;())?.Errors;
    }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1783.1" xmlns="http://www.w3.org/1999/xhtml">catch</span></span><span class="koboSpan" id="kobo.1784.1" xmlns="http://www.w3.org/1999/xhtml"> (Exception ex)
  {
    _logger.LogWarning(
      </span><span class="hljs-string"><span class="koboSpan" id="kobo.1785.1" xmlns="http://www.w3.org/1999/xhtml">$"Northwind.GraphQL.Service exception: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1786.1" xmlns="http://www.w3.org/1999/xhtml">{ex.Message}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1787.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.1788.1" xmlns="http://www.w3.org/1999/xhtml">);
    model.Errors = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1789.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1790.1" xmlns="http://www.w3.org/1999/xhtml">[] { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1791.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1792.1" xmlns="http://www.w3.org/1999/xhtml"> Error { Message = ex.Message } };
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1793.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.1794.1" xmlns="http://www.w3.org/1999/xhtml"> View(model);
}
</span></code></pre>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.1795.1" xmlns="http://www.w3.org/1999/xhtml">Good Practice</span></strong><span class="koboSpan" id="kobo.1796.1" xmlns="http://www.w3.org/1999/xhtml">: To set the content of our request, we will use the C# 11 or later raw interpolated string literal syntax of three-dollar signs and three double quotes. </span><span class="koboSpan" id="kobo.1796.2" xmlns="http://www.w3.org/1999/xhtml">This allows us to embed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1797.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.1798.1" xmlns="http://www.w3.org/1999/xhtml"> variable using three curly braces, which should not be confused with the two curly braces after </span><code class="inlineCode"><span class="koboSpan" id="kobo.1799.1" xmlns="http://www.w3.org/1999/xhtml">unitsInStock</span></code><span class="koboSpan" id="kobo.1800.1" xmlns="http://www.w3.org/1999/xhtml">, which end the query itself.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="15"><span class="koboSpan" id="kobo.1801.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1802.1" xmlns="http://www.w3.org/1999/xhtml">Views/Home</span></code><span class="koboSpan" id="kobo.1803.1" xmlns="http://www.w3.org/1999/xhtml"> folder, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1804.1" xmlns="http://www.w3.org/1999/xhtml">Index.cshtml</span></code><span class="koboSpan" id="kobo.1805.1" xmlns="http://www.w3.org/1999/xhtml">, delete</span><a id="_idIndexMarker1325"/><span class="koboSpan" id="kobo.1806.1" xmlns="http://www.w3.org/1999/xhtml"> its existing markup, and then</span><a id="_idIndexMarker1326"/><span class="koboSpan" id="kobo.1807.1" xmlns="http://www.w3.org/1999/xhtml"> add markup to render the seafood products, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1808.1" xmlns="http://www.w3.org/1999/xhtml">@using Northwind.EntityModels
@using Northwind.GraphQL.Client.Mvc.Models @* for VS Code only *@
@model IndexViewModel
@{
  ViewData["Title"] = "Products from GraphQL service";
}
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1809.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1810.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1811.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1812.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1813.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1814.1" xmlns="http://www.w3.org/1999/xhtml">text-center"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1815.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1816.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1817.1" xmlns="http://www.w3.org/1999/xhtml">h1</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1818.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1819.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1820.1" xmlns="http://www.w3.org/1999/xhtml">"display-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1821.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1822.1" xmlns="http://www.w3.org/1999/xhtml">@ViewData["Title"]</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1823.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1824.1" xmlns="http://www.w3.org/1999/xhtml">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1825.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1826.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1827.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1828.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1829.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1830.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1831.1" xmlns="http://www.w3.org/1999/xhtml">card card-body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1832.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1833.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1834.1" xmlns="http://www.w3.org/1999/xhtml">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1835.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1836.1" xmlns="http://www.w3.org/1999/xhtml">
      Enter a category id
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1837.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1838.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1839.1" xmlns="http://www.w3.org/1999/xhtml">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1840.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1841.1" xmlns="http://www.w3.org/1999/xhtml">"id"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1842.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1843.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1844.1" xmlns="http://www.w3.org/1999/xhtml">"1"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1845.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1846.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1847.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1848.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1849.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1850.1" xmlns="http://www.w3.org/1999/xhtml">"submit"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1851.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1852.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1853.1" xmlns="http://www.w3.org/1999/xhtml">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1854.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1855.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1856.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1857.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1858.1" xmlns="http://www.w3.org/1999/xhtml">
  @if (Model.Errors is not null)
  {
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1859.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1860.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1861.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1862.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1863.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1864.1" xmlns="http://www.w3.org/1999/xhtml">alert alert-danger"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1865.1" xmlns="http://www.w3.org/1999/xhtml">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1866.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1867.1" xmlns="http://www.w3.org/1999/xhtml">"alert"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1868.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1869.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1870.1" xmlns="http://www.w3.org/1999/xhtml">table</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1871.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1872.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1873.1" xmlns="http://www.w3.org/1999/xhtml">"table table-striped"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1874.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1875.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1876.1" xmlns="http://www.w3.org/1999/xhtml">thead</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1877.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1878.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1879.1" xmlns="http://www.w3.org/1999/xhtml">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1880.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1881.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1882.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1883.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1884.1" xmlns="http://www.w3.org/1999/xhtml">Message</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1885.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1886.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1887.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1888.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1889.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1890.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1891.1" xmlns="http://www.w3.org/1999/xhtml">Path</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1892.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1893.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1894.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1895.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1896.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1897.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1898.1" xmlns="http://www.w3.org/1999/xhtml">Locations</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1899.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1900.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1901.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1902.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1903.1" xmlns="http://www.w3.org/1999/xhtml">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1904.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1905.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1906.1" xmlns="http://www.w3.org/1999/xhtml">thead</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1907.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1908.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1909.1" xmlns="http://www.w3.org/1999/xhtml">tbody</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1910.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1911.1" xmlns="http://www.w3.org/1999/xhtml">
          @foreach (Error error in Model.Errors)
          {
            </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1912.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1913.1" xmlns="http://www.w3.org/1999/xhtml">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1914.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1915.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1916.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1917.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1918.1" xmlns="http://www.w3.org/1999/xhtml">@error.Message</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1919.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1920.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1921.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1922.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1923.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1924.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1925.1" xmlns="http://www.w3.org/1999/xhtml">
                @if (error.Path is not null)
                {
                  @foreach (string path in error.Path)
                  {
                    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1926.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1927.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1928.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1929.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1930.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1931.1" xmlns="http://www.w3.org/1999/xhtml">badge bg-danger"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1932.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1933.1" xmlns="http://www.w3.org/1999/xhtml">@path</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1934.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1935.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1936.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1937.1" xmlns="http://www.w3.org/1999/xhtml">
                  }
                }
              </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1938.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1939.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1940.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1941.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1942.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1943.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1944.1" xmlns="http://www.w3.org/1999/xhtml">
                @if (error.Locations is not null)
                {
                  @foreach (Location location in error.Locations)
                  {
                    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1945.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1946.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1947.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1948.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1949.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1950.1" xmlns="http://www.w3.org/1999/xhtml">badge bg-danger"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1951.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1952.1" xmlns="http://www.w3.org/1999/xhtml">
                      @location.Line, @location.Column
                    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1953.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1954.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1955.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1956.1" xmlns="http://www.w3.org/1999/xhtml">
                  }
                }
              </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1957.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1958.1" xmlns="http://www.w3.org/1999/xhtml">td</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1959.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1960.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1961.1" xmlns="http://www.w3.org/1999/xhtml">tr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1962.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1963.1" xmlns="http://www.w3.org/1999/xhtml">
          }
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1964.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1965.1" xmlns="http://www.w3.org/1999/xhtml">tbody</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1966.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1967.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1968.1" xmlns="http://www.w3.org/1999/xhtml">table</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1969.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1970.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1971.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1972.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1973.1" xmlns="http://www.w3.org/1999/xhtml">
  }
  @if (Model.Categories is not null)
  {
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1974.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1975.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1976.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1977.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1978.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1979.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1980.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1981.1" xmlns="http://www.w3.org/1999/xhtml">"alert alert-success"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1982.1" xmlns="http://www.w3.org/1999/xhtml">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1983.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1984.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1985.1" xmlns="http://www.w3.org/1999/xhtml">alert"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1986.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1987.1" xmlns="http://www.w3.org/1999/xhtml">
        There are @Model.Categories.Count() products.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1988.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1989.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1990.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1991.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1992.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1993.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.1994.1" xmlns="http://www.w3.org/1999/xhtml">
        @foreach (Category category in Model.Categories)
        {
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1995.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1996.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1997.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1998.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1999.1" xmlns="http://www.w3.org/1999/xhtml">"badge bg-dark"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2000.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2001.1" xmlns="http://www.w3.org/1999/xhtml">
            @category.CategoryId
            @category.CategoryName
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2002.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2003.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2004.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2005.1" xmlns="http://www.w3.org/1999/xhtml">
        }
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2006.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2007.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2008.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2009.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2010.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2011.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2012.1" xmlns="http://www.w3.org/1999/xhtml">
  }
  @if (Model.Products is not null)
  {
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2013.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2014.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2015.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2016.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2017.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2018.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2019.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2020.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2021.1" xmlns="http://www.w3.org/1999/xhtml">alert alert-success"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2022.1" xmlns="http://www.w3.org/1999/xhtml">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2023.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2024.1" xmlns="http://www.w3.org/1999/xhtml">"alert"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2025.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2026.1" xmlns="http://www.w3.org/1999/xhtml">
        There are @Model.Products.Count() products.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2027.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2028.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2029.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2030.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2031.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2032.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2033.1" xmlns="http://www.w3.org/1999/xhtml">
        @foreach (Product p in Model.Products)
        {
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2034.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2035.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2036.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2037.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2038.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2039.1" xmlns="http://www.w3.org/1999/xhtml">badge bg-dark"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2040.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2041.1" xmlns="http://www.w3.org/1999/xhtml">
            @p.ProductId
            @p.ProductName
            -
            @(p.UnitsInStock is null ? </span><span class="koboSpan" id="kobo.2041.2" xmlns="http://www.w3.org/1999/xhtml">"0" : p.UnitsInStock.Value) in stock
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2042.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2043.1" xmlns="http://www.w3.org/1999/xhtml">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2044.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2045.1" xmlns="http://www.w3.org/1999/xhtml">
        }
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2046.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2047.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2048.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2049.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2050.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2051.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2052.1" xmlns="http://www.w3.org/1999/xhtml">
  }
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2053.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2054.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2055.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2056.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2057.1" xmlns="http://www.w3.org/1999/xhtml">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2058.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2059.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2060.1" xmlns="http://www.w3.org/1999/xhtml">"btn btn-primary"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2061.1" xmlns="http://www.w3.org/1999/xhtml">data-bs-toggle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2062.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2063.1" xmlns="http://www.w3.org/1999/xhtml">"collapse"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2064.1" xmlns="http://www.w3.org/1999/xhtml">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2065.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2066.1" xmlns="http://www.w3.org/1999/xhtml">"#collapseExample"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2067.1" xmlns="http://www.w3.org/1999/xhtml">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2068.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2069.1" xmlns="http://www.w3.org/1999/xhtml">"button"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2070.1" xmlns="http://www.w3.org/1999/xhtml">aria-expanded</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2071.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2072.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2073.1" xmlns="http://www.w3.org/1999/xhtml">false"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2074.1" xmlns="http://www.w3.org/1999/xhtml">aria-controls</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2075.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2076.1" xmlns="http://www.w3.org/1999/xhtml">"collapseExample"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2077.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2078.1" xmlns="http://www.w3.org/1999/xhtml">
      Show/Hide Details
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2079.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2080.1" xmlns="http://www.w3.org/1999/xhtml">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2081.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2082.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2083.1" xmlns="http://www.w3.org/1999/xhtml">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2084.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2085.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2086.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2087.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2088.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2089.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2090.1" xmlns="http://www.w3.org/1999/xhtml">collapse"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2091.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2092.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2093.1" xmlns="http://www.w3.org/1999/xhtml">"collapseExample"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2094.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2095.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2096.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2097.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2098.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2099.1" xmlns="http://www.w3.org/1999/xhtml">"card card-body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2100.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.2101.1" xmlns="http://www.w3.org/1999/xhtml">
      Status code @((int)Model.Code): @Model.Code
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2102.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2103.1" xmlns="http://www.w3.org/1999/xhtml">hr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2104.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span><span class="koboSpan" id="kobo.2105.1" xmlns="http://www.w3.org/1999/xhtml">
      @Model.RawResponseBody
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2106.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2107.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2108.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2109.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2110.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2111.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2112.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2113.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2114.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
</code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-459"><span class="koboSpan" id="kobo.2115.1" xmlns="http://www.w3.org/1999/xhtml">Testing the .NET client</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2116.1" xmlns="http://www.w3.org/1999/xhtml">Now, we can test</span><a id="_idIndexMarker1327"/><span class="koboSpan" id="kobo.2117.1" xmlns="http://www.w3.org/1999/xhtml"> our .NET client:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2118.1" xmlns="http://www.w3.org/1999/xhtml">If your database server is not running, for example, because you are hosting it in Docker, a virtual machine, or in the cloud, then make sure to start it.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2119.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2120.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.2121.1" xmlns="http://www.w3.org/1999/xhtml"> project, using its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2122.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2123.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2124.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2125.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.2126.1" xmlns="http://www.w3.org/1999/xhtml"> project, using its </span><code class="inlineCode"><span class="koboSpan" id="kobo.2127.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2128.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2129.1" xmlns="http://www.w3.org/1999/xhtml">Note that products are successfully retrieved using GraphQL, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.2130.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.9</span></em><span class="koboSpan" id="kobo.2131.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2132.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2133.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.9: Products in the Beverages category from the GraphQL service</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.2134.1" xmlns="http://www.w3.org/1999/xhtml">Enter another category</span><a id="_idIndexMarker1328"/><span class="koboSpan" id="kobo.2135.1" xmlns="http://www.w3.org/1999/xhtml"> ID that exists, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2136.1" xmlns="http://www.w3.org/1999/xhtml">4</span></code><span class="koboSpan" id="kobo.2137.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2138.1" xmlns="http://www.w3.org/1999/xhtml">Enter a category ID that is out of range, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2139.1" xmlns="http://www.w3.org/1999/xhtml">13</span></code><span class="koboSpan" id="kobo.2140.1" xmlns="http://www.w3.org/1999/xhtml">, and note that there are 0 products returned.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2141.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and shut down the web server for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2142.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.2143.1" xmlns="http://www.w3.org/1999/xhtml"> project.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2144.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2145.1" xmlns="http://www.w3.org/1999/xhtml">HomeController.cs</span></code><span class="koboSpan" id="kobo.2146.1" xmlns="http://www.w3.org/1999/xhtml">, modify the query to make a deliberate mistake, like changing </span><code class="inlineCode"><span class="koboSpan" id="kobo.2147.1" xmlns="http://www.w3.org/1999/xhtml">productId</span></code><span class="koboSpan" id="kobo.2148.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2149.1" xmlns="http://www.w3.org/1999/xhtml">productid</span></code><span class="koboSpan" id="kobo.2150.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2151.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2152.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Mvc</span></code><span class="koboSpan" id="kobo.2153.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2154.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2155.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2156.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2157.1" xmlns="http://www.w3.org/1999/xhtml">Show/Hide Details</span></strong><span class="koboSpan" id="kobo.2158.1" xmlns="http://www.w3.org/1999/xhtml"> button, and note the error message and response details, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2159.1" xmlns="http://www.w3.org/1999/xhtml">{"errors":[{"message":"The field \u0060productid\u0060 
does not exist on the type \u0060Product\u0060.",
 "locations":[{"line":1,"column":35}],
 "path":["productsInCategory"],
 "extensions":{"type":"Product","field":"productid",
 "responseName":"productid",
 "specifiedBy":"http://spec.graphql.org/October2021/
#sec-Field-Selections-on-Objects-Interfaces-and-Unions-Types"}}]}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2160.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome, and shut down both web servers.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2161.1" xmlns="http://www.w3.org/1999/xhtml">Fix the mistake</span><a id="_idIndexMarker1329"/><span class="koboSpan" id="kobo.2162.1" xmlns="http://www.w3.org/1999/xhtml"> in the query!</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-460"><span class="koboSpan" id="kobo.2163.1" xmlns="http://www.w3.org/1999/xhtml">Creating a console app client using Strawberry Shake</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2164.1" xmlns="http://www.w3.org/1999/xhtml">Instead of using ordinary</span><a id="_idIndexMarker1330"/><span class="koboSpan" id="kobo.2165.1" xmlns="http://www.w3.org/1999/xhtml"> HTTP clients, ChilliCream has a GraphQL client</span><a id="_idIndexMarker1331"/><span class="koboSpan" id="kobo.2166.1" xmlns="http://www.w3.org/1999/xhtml"> library to more easily build .NET clients to GraphQL services.</span></p>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.2167.1" xmlns="http://www.w3.org/1999/xhtml">More Information</span></strong><span class="koboSpan" id="kobo.2168.1" xmlns="http://www.w3.org/1999/xhtml">: You can learn more about Strawberry Shake</span><a id="_idIndexMarker1332"/><span class="koboSpan" id="kobo.2169.1" xmlns="http://www.w3.org/1999/xhtml"> at the following link: </span><a href="https://chillicream.com/docs/strawberryshake"><span class="url"><span class="koboSpan" id="kobo.2170.1" xmlns="http://www.w3.org/1999/xhtml">https://chillicream.com/docs/strawberryshake</span></span></a></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.2171.1" xmlns="http://www.w3.org/1999/xhtml">Now, let’s create another client using Strawberry Shake so that you can see the benefits:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2172.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to add a new </span><strong class="screenText"><span class="koboSpan" id="kobo.2173.1" xmlns="http://www.w3.org/1999/xhtml">Console App</span></strong><span class="koboSpan" id="kobo.2174.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.2175.1" xmlns="http://www.w3.org/1999/xhtml">console</span></code><span class="koboSpan" id="kobo.2176.1" xmlns="http://www.w3.org/1999/xhtml"> project, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2177.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2178.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2179.1" xmlns="http://www.w3.org/1999/xhtml">At the command prompt or terminal for the project folder, create a tools manifest file, as shown in the following command:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2180.1" xmlns="http://www.w3.org/1999/xhtml">dotnet new tool-manifest
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2181.1" xmlns="http://www.w3.org/1999/xhtml">At the command line or terminal, install the Strawberry Shake tools, as shown in the following command:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2182.1" xmlns="http://www.w3.org/1999/xhtml">dotnet tool install StrawberryShake.Tools --local
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2183.1" xmlns="http://www.w3.org/1999/xhtml">Note Strawberry Shake is installed, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2184.1" xmlns="http://www.w3.org/1999/xhtml">You can invoke the tool from this directory using the following commands:
'dotnet tool run dotnet-graphql' or 'dotnet dotnet-graphql'.
</span><span class="koboSpan" id="kobo.2184.2" xmlns="http://www.w3.org/1999/xhtml">Tool 'strawberryshake.tools' (version '13.5.1') was successfully installed.
</span><span class="koboSpan" id="kobo.2184.3" xmlns="http://www.w3.org/1999/xhtml">Entry is added to the manifest file C:\apps-services-net8\Chapter12\
Northwind.GraphQL.Client.Console\.config\dotnet-tools.json.
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2185.1" xmlns="http://www.w3.org/1999/xhtml">In the project, treat warnings</span><a id="_idIndexMarker1333"/><span class="koboSpan" id="kobo.2186.1" xmlns="http://www.w3.org/1999/xhtml"> as errors, add references to NuGet packages for Microsoft extensions for dependency injection, working with HTTP, and Strawberry Shake code</span><a id="_idIndexMarker1334"/><span class="koboSpan" id="kobo.2187.1" xmlns="http://www.w3.org/1999/xhtml"> generation, and then globally and statically import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2188.1" xmlns="http://www.w3.org/1999/xhtml">Console</span></code><span class="koboSpan" id="kobo.2189.1" xmlns="http://www.w3.org/1999/xhtml"> class, as highlighted in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2190.1" xmlns="http://www.w3.org/1999/xhtml">&lt;Project Sdk=</span><span class="hljs-string"><span class="koboSpan" id="kobo.2191.1" xmlns="http://www.w3.org/1999/xhtml">"Microsoft.NET.Sdk"</span></span><span class="koboSpan" id="kobo.2192.1" xmlns="http://www.w3.org/1999/xhtml">&gt;
  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net8</span><span class="hljs-number"><span class="koboSpan" id="kobo.2193.1" xmlns="http://www.w3.org/1999/xhtml">.0</span></span><span class="koboSpan" id="kobo.2194.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/TargetFramework&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2195.1" xmlns="http://www.w3.org/1999/xhtml">    &lt;TreatWarningsAsErrors&gt;</span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.2196.1" xmlns="http://www.w3.org/1999/xhtml">true</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2197.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/TreatWarningsAsErrors&gt;</span></strong></span><span class="koboSpan" id="kobo.2198.1" xmlns="http://www.w3.org/1999/xhtml">
  &lt;/PropertyGroup&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2199.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;ItemGroup&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2200.1" xmlns="http://www.w3.org/1999/xhtml">    &lt;PackageReference Version=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2201.1" xmlns="http://www.w3.org/1999/xhtml">"</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2202.1" xmlns="http://www.w3.org/1999/xhtml">8.0.0"</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2203.1" xmlns="http://www.w3.org/1999/xhtml">      Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2204.1" xmlns="http://www.w3.org/1999/xhtml">"Microsoft.Extensions.DependencyInjection"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2205.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2206.1" xmlns="http://www.w3.org/1999/xhtml">    &lt;PackageReference Version=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2207.1" xmlns="http://www.w3.org/1999/xhtml">"8.0.0"</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2208.1" xmlns="http://www.w3.org/1999/xhtml">      Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2209.1" xmlns="http://www.w3.org/1999/xhtml">"Microsoft.Extensions.Http"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2210.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2211.1" xmlns="http://www.w3.org/1999/xhtml">    &lt;PackageReference Version=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2212.1" xmlns="http://www.w3.org/1999/xhtml">"13.5.1"</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2213.1" xmlns="http://www.w3.org/1999/xhtml">      Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2214.1" xmlns="http://www.w3.org/1999/xhtml">"StrawberryShake.Server"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2215.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2216.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;/ItemGroup&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2217.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;ItemGroup&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2218.1" xmlns="http://www.w3.org/1999/xhtml">    &lt;Using Include=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2219.1" xmlns="http://www.w3.org/1999/xhtml">"System.Console"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2220.1" xmlns="http://www.w3.org/1999/xhtml"> Static=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2221.1" xmlns="http://www.w3.org/1999/xhtml">"true"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2222.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2223.1" xmlns="http://www.w3.org/1999/xhtml">  &lt;/ItemGroup&gt;</span></strong></span><span class="koboSpan" id="kobo.2224.1" xmlns="http://www.w3.org/1999/xhtml">
&lt;/Project&gt;
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.2225.1" xmlns="http://www.w3.org/1999/xhtml">You need to use different Strawberry Shake packages for different types of .NET project. </span><span class="koboSpan" id="kobo.2225.2" xmlns="http://www.w3.org/1999/xhtml">For console apps and ASP.NET Core apps, reference </span><code class="inlineCode"><span class="koboSpan" id="kobo.2226.1" xmlns="http://www.w3.org/1999/xhtml">StrawberryShake.Server</span></code><span class="koboSpan" id="kobo.2227.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2227.2" xmlns="http://www.w3.org/1999/xhtml">For Blazor WebAssembly apps, reference </span><code class="inlineCode"><span class="koboSpan" id="kobo.2228.1" xmlns="http://www.w3.org/1999/xhtml">StrawberryShake.Blazor</span></code><span class="koboSpan" id="kobo.2229.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2229.2" xmlns="http://www.w3.org/1999/xhtml">For .NET MAUI apps, reference </span><code class="inlineCode"><span class="koboSpan" id="kobo.2230.1" xmlns="http://www.w3.org/1999/xhtml">StrawberryShake.Maui</span></code><span class="koboSpan" id="kobo.2231.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.2232.1" xmlns="http://www.w3.org/1999/xhtml">Build the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2233.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2234.1" xmlns="http://www.w3.org/1999/xhtml"> project to restore packages.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2235.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2236.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.2237.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2238.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2239.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging, and leave it running so that the Strawberry Shake tool can talk to it.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2240.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2241.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2242.1" xmlns="http://www.w3.org/1999/xhtml"> project, at the command prompt or terminal, add a client for your GraphQL service, as shown in the following command:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2243.1" xmlns="http://www.w3.org/1999/xhtml">dotnet graphql init https://localhost:5121/graphql/ -n NorthwindClient
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2244.1" xmlns="http://www.w3.org/1999/xhtml">Note the results, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2245.1" xmlns="http://www.w3.org/1999/xhtml">Download schema started.
</span><span class="koboSpan" id="kobo.2245.2" xmlns="http://www.w3.org/1999/xhtml">Download schema completed in 189 ms
Client configuration started.
</span><span class="koboSpan" id="kobo.2245.3" xmlns="http://www.w3.org/1999/xhtml">Client configuration completed in 83 ms
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2246.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2247.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2248.1" xmlns="http://www.w3.org/1999/xhtml"> project, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2249.1" xmlns="http://www.w3.org/1999/xhtml">.graphqlrc.json</span></code><span class="koboSpan" id="kobo.2250.1" xmlns="http://www.w3.org/1999/xhtml"> file, add an entry to control</span><a id="_idIndexMarker1335"/><span class="koboSpan" id="kobo.2251.1" xmlns="http://www.w3.org/1999/xhtml"> the C# namespace used</span><a id="_idIndexMarker1336"/><span class="koboSpan" id="kobo.2252.1" xmlns="http://www.w3.org/1999/xhtml"> during code generation, as highlighted in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2253.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2254.1" xmlns="http://www.w3.org/1999/xhtml">"schema"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2255.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2256.1" xmlns="http://www.w3.org/1999/xhtml">"schema.graphql"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2257.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2258.1" xmlns="http://www.w3.org/1999/xhtml">"documents"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2259.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2260.1" xmlns="http://www.w3.org/1999/xhtml">"**/*.graphql"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2261.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2262.1" xmlns="http://www.w3.org/1999/xhtml">"extensions"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2263.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2264.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2265.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2266.1" xmlns="http://www.w3.org/1999/xhtml">strawberryShake"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2267.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2268.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2269.1" xmlns="http://www.w3.org/1999/xhtml">"name"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2270.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2271.1" xmlns="http://www.w3.org/1999/xhtml">"NorthwindClient"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2272.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2273.1" xmlns="http://www.w3.org/1999/xhtml">"namespace"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.2274.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2275.1" xmlns="http://www.w3.org/1999/xhtml">"Northwind.GraphQL.Client.Console"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.2276.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2277.1" xmlns="http://www.w3.org/1999/xhtml">"url"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2278.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2279.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5111/graphql/"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2280.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2281.1" xmlns="http://www.w3.org/1999/xhtml">"records"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2282.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2283.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2284.1" xmlns="http://www.w3.org/1999/xhtml">"inputs"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2285.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2286.1" xmlns="http://www.w3.org/1999/xhtml">false</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2287.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2288.1" xmlns="http://www.w3.org/1999/xhtml">"entities"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2289.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2290.1" xmlns="http://www.w3.org/1999/xhtml">false</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2291.1" xmlns="http://www.w3.org/1999/xhtml">},</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2292.1" xmlns="http://www.w3.org/1999/xhtml">"transportProfiles"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2293.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2294.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2295.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2296.1" xmlns="http://www.w3.org/1999/xhtml">"default"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2297.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2298.1" xmlns="http://www.w3.org/1999/xhtml">"Http"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2299.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.2300.1" xmlns="http://www.w3.org/1999/xhtml">"subscription"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2301.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2302.1" xmlns="http://www.w3.org/1999/xhtml">"WebSocket"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2303.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2304.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2305.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2306.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2307.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2308.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2309.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2310.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a new file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2311.1" xmlns="http://www.w3.org/1999/xhtml">seafoodProducts.graphql</span></code><span class="koboSpan" id="kobo.2312.1" xmlns="http://www.w3.org/1999/xhtml">, which defines a query to get seafood products, as shown in the following document:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2313.1" xmlns="http://www.w3.org/1999/xhtml">query SeafoodProducts </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2314.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2315.1" xmlns="http://www.w3.org/1999/xhtml">
  productsInCategory(categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2316.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="hljs-number"><span class="koboSpan" id="kobo.2317.1" xmlns="http://www.w3.org/1999/xhtml">8</span></span><span class="koboSpan" id="kobo.2318.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2319.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2320.1" xmlns="http://www.w3.org/1999/xhtml">
    productId 
    productName 
    unitsInStock
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2321.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2322.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.2323.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL queries used by Strawberry Shake must be named.</span></p>
</div>
</li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="12"><span class="koboSpan" id="kobo.2324.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio 2022, it might automatically modify the project file to explicitly remove this file from the build process because it does not recognize it. </span><span class="koboSpan" id="kobo.2324.2" xmlns="http://www.w3.org/1999/xhtml">If it has, then delete</span><a id="_idIndexMarker1337"/><span class="koboSpan" id="kobo.2325.1" xmlns="http://www.w3.org/1999/xhtml"> or comment out that element, as shown</span><a id="_idIndexMarker1338"/><span class="koboSpan" id="kobo.2326.1" xmlns="http://www.w3.org/1999/xhtml"> in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2327.1" xmlns="http://www.w3.org/1999/xhtml">&lt;!-- An element like this will remove the file from the build process.</span></strong></span><span class="koboSpan" id="kobo.2328.1" xmlns="http://www.w3.org/1999/xhtml">
&lt;ItemGroup&gt;
  &lt;GraphQL Remove=</span><span class="hljs-string"><span class="koboSpan" id="kobo.2329.1" xmlns="http://www.w3.org/1999/xhtml">"seafoodProducts.graphql"</span></span><span class="koboSpan" id="kobo.2330.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2331.1" xmlns="http://www.w3.org/1999/xhtml">--&gt;</span></strong></span>
</code></pre>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.2332.1" xmlns="http://www.w3.org/1999/xhtml">Good Practice</span></strong><span class="koboSpan" id="kobo.2333.1" xmlns="http://www.w3.org/1999/xhtml">: There must be at least one </span><code class="inlineCode"><span class="koboSpan" id="kobo.2334.1" xmlns="http://www.w3.org/1999/xhtml">.graphql</span></code><span class="koboSpan" id="kobo.2335.1" xmlns="http://www.w3.org/1999/xhtml"> file for the Strawberry Shake tool to be able to generate its code automatically. </span><span class="koboSpan" id="kobo.2335.2" xmlns="http://www.w3.org/1999/xhtml">An element like the proceeding one will prevent the Strawberry Shake tool from generating its code, and you will later get compile errors. </span><span class="koboSpan" id="kobo.2335.3" xmlns="http://www.w3.org/1999/xhtml">You should delete or comment out that element.</span></p>
</div>
</li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="13"><span class="koboSpan" id="kobo.2336.1" xmlns="http://www.w3.org/1999/xhtml">Build the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2337.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Client.Console</span></code><span class="koboSpan" id="kobo.2338.1" xmlns="http://www.w3.org/1999/xhtml"> project to make Strawberry Shake process the GraphQL query file and generate proxy classes.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2339.1" xmlns="http://www.w3.org/1999/xhtml">Note the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2340.1" xmlns="http://www.w3.org/1999/xhtml">obj\Debug\net8.0\berry</span></code><span class="koboSpan" id="kobo.2341.1" xmlns="http://www.w3.org/1999/xhtml"> folder that was autogenerated, the file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2342.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindClient.Client.cs</span></code><span class="koboSpan" id="kobo.2343.1" xmlns="http://www.w3.org/1999/xhtml">, and the dozen or so types defined by it, including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2344.1" xmlns="http://www.w3.org/1999/xhtml">INorthwindClient</span></code><span class="koboSpan" id="kobo.2345.1" xmlns="http://www.w3.org/1999/xhtml"> interface, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.2346.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.10</span></em><span class="koboSpan" id="kobo.2347.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2348.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2349.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.10: The generated class file for the Northwind GraphQL service</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="15"><span class="koboSpan" id="kobo.2350.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2351.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.2352.1" xmlns="http://www.w3.org/1999/xhtml">, delete the existing</span><a id="_idIndexMarker1339"/><span class="koboSpan" id="kobo.2353.1" xmlns="http://www.w3.org/1999/xhtml"> statements. </span><span class="koboSpan" id="kobo.2353.2" xmlns="http://www.w3.org/1999/xhtml">Add statements</span><a id="_idIndexMarker1340"/><span class="koboSpan" id="kobo.2354.1" xmlns="http://www.w3.org/1999/xhtml"> to create a new service collection, add the autogenerated </span><code class="inlineCode"><span class="koboSpan" id="kobo.2355.1" xmlns="http://www.w3.org/1999/xhtml">NorthwindClient</span></code><span class="koboSpan" id="kobo.2356.1" xmlns="http://www.w3.org/1999/xhtml"> to it with the correct URL for the service, and then get and use the dependency service to fetch the seafood products, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2357.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.2358.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.Extensions.DependencyInjection; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2359.1" xmlns="http://www.w3.org/1999/xhtml">// To use ServiceCollection.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2360.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.2361.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.GraphQL.Client.Console; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2362.1" xmlns="http://www.w3.org/1999/xhtml">// To use INorthwindClient.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2363.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.2364.1" xmlns="http://www.w3.org/1999/xhtml"> StrawberryShake; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2365.1" xmlns="http://www.w3.org/1999/xhtml">// To use EnsureNoErrors extension method.</span></span><span class="koboSpan" id="kobo.2366.1" xmlns="http://www.w3.org/1999/xhtml">
ServiceCollection serviceCollection = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2367.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2368.1" xmlns="http://www.w3.org/1999/xhtml">();
serviceCollection
  .AddNorthwindClient() </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2369.1" xmlns="http://www.w3.org/1999/xhtml">// Strawberry Shake extension method.</span></span><span class="koboSpan" id="kobo.2370.1" xmlns="http://www.w3.org/1999/xhtml">
  .ConfigureHttpClient(client =&gt; 
    client.BaseAddress = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2371.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2372.1" xmlns="http://www.w3.org/1999/xhtml"> Uri(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2373.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5121/graphql"</span></span><span class="koboSpan" id="kobo.2374.1" xmlns="http://www.w3.org/1999/xhtml">));
IServiceProvider services = serviceCollection.BuildServiceProvider();
INorthwindClient client = services.GetRequiredService&lt;INorthwindClient&gt;();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2375.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.2376.1" xmlns="http://www.w3.org/1999/xhtml"> result = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2377.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2378.1" xmlns="http://www.w3.org/1999/xhtml"> client.SeafoodProducts.ExecuteAsync();
result.EnsureNoErrors();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2379.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.2380.1" xmlns="http://www.w3.org/1999/xhtml"> (result.Data </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2381.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.2382.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.2383.1" xmlns="http://www.w3.org/1999/xhtml">)
{
  WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2384.1" xmlns="http://www.w3.org/1999/xhtml">"No data!"</span></span><span class="koboSpan" id="kobo.2385.1" xmlns="http://www.w3.org/1999/xhtml">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2386.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.2387.1" xmlns="http://www.w3.org/1999/xhtml">; 
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2388.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.2389.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2390.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.2391.1" xmlns="http://www.w3.org/1999/xhtml"> product </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2392.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.2393.1" xmlns="http://www.w3.org/1999/xhtml"> result.Data.ProductsInCategory)
{
  WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2394.1" xmlns="http://www.w3.org/1999/xhtml">"{0}: {1}"</span></span><span class="koboSpan" id="kobo.2395.1" xmlns="http://www.w3.org/1999/xhtml">,
    product.ProductId, product.ProductName);
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2396.1" xmlns="http://www.w3.org/1999/xhtml">Run the console app</span><a id="_idIndexMarker1341"/><span class="koboSpan" id="kobo.2397.1" xmlns="http://www.w3.org/1999/xhtml"> and note the results, as shown</span><a id="_idIndexMarker1342"/><span class="koboSpan" id="kobo.2398.1" xmlns="http://www.w3.org/1999/xhtml"> in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2399.1" xmlns="http://www.w3.org/1999/xhtml">10: Ikura
13: Konbu
18: Carnarvon Tigers
30: Nord-Ost Matjeshering
36: Inlagd Sill
37: Gravad lax
40: Boston Crab Meat
41: Jack's New England Clam Chowder
45: Rogede sild
46: Spegesild
58: Escargots de Bourgogne
73: Röd Kaviar
</span></code></pre>
</li>
</ol>
<h1 class="heading-1" id="_idParaDest-461"><span class="koboSpan" id="kobo.2400.1" xmlns="http://www.w3.org/1999/xhtml">Implementing GraphQL mutations</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2401.1" xmlns="http://www.w3.org/1999/xhtml">Most services need to modify</span><a id="_idIndexMarker1343"/><span class="koboSpan" id="kobo.2402.1" xmlns="http://www.w3.org/1999/xhtml"> data as well as</span><a id="_idIndexMarker1344"/><span class="koboSpan" id="kobo.2403.1" xmlns="http://www.w3.org/1999/xhtml"> query it. </span><span class="koboSpan" id="kobo.2403.2" xmlns="http://www.w3.org/1999/xhtml">GraphQL calls these </span><strong class="keyWord"><span class="koboSpan" id="kobo.2404.1" xmlns="http://www.w3.org/1999/xhtml">mutations</span></strong><span class="koboSpan" id="kobo.2405.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2405.2" xmlns="http://www.w3.org/1999/xhtml">A mutation has three related components:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2406.1" xmlns="http://www.w3.org/1999/xhtml">The mutation itself, which defines</span><a id="_idIndexMarker1345"/><span class="koboSpan" id="kobo.2407.1" xmlns="http://www.w3.org/1999/xhtml"> the change that will be made to the graph. </span><span class="koboSpan" id="kobo.2407.2" xmlns="http://www.w3.org/1999/xhtml">It should be named using a verb, a noun, and use camel casing, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2408.1" xmlns="http://www.w3.org/1999/xhtml">addProduct</span></code><span class="koboSpan" id="kobo.2409.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2410.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2411.1" xmlns="http://www.w3.org/1999/xhtml">input</span></strong><span class="koboSpan" id="kobo.2412.1" xmlns="http://www.w3.org/1999/xhtml"> is the input for a mutation, and it should have the same name as the mutation with a suffix of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2413.1" xmlns="http://www.w3.org/1999/xhtml">Input</span></code><span class="koboSpan" id="kobo.2414.1" xmlns="http://www.w3.org/1999/xhtml">, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2415.1" xmlns="http://www.w3.org/1999/xhtml">AddProductInput</span></code><span class="koboSpan" id="kobo.2416.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2416.2" xmlns="http://www.w3.org/1999/xhtml">Although there is only one input, it is an object graph, so it can be as complex as you need.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2417.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2418.1" xmlns="http://www.w3.org/1999/xhtml">payload</span></strong><span class="koboSpan" id="kobo.2419.1" xmlns="http://www.w3.org/1999/xhtml"> is the returned document for a mutation, and it should have the same name as the mutation with a suffix of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2420.1" xmlns="http://www.w3.org/1999/xhtml">Payload</span></code><span class="koboSpan" id="kobo.2421.1" xmlns="http://www.w3.org/1999/xhtml">, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2422.1" xmlns="http://www.w3.org/1999/xhtml">AddProductPayload</span></code><span class="koboSpan" id="kobo.2423.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2423.2" xmlns="http://www.w3.org/1999/xhtml">Although there is only one payload, it is an object graph, so it can be as complex as you need.</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-462"><span class="koboSpan" id="kobo.2424.1" xmlns="http://www.w3.org/1999/xhtml">Adding mutations to the GraphQL service</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2425.1" xmlns="http://www.w3.org/1999/xhtml">Let’s define mutations</span><a id="_idIndexMarker1346"/><span class="koboSpan" id="kobo.2426.1" xmlns="http://www.w3.org/1999/xhtml"> for adding, and later, we will define some</span><a id="_idIndexMarker1347"/><span class="koboSpan" id="kobo.2427.1" xmlns="http://www.w3.org/1999/xhtml"> to update and delete products:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2428.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2429.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.2430.1" xmlns="http://www.w3.org/1999/xhtml"> project/folder, add a class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2431.1" xmlns="http://www.w3.org/1999/xhtml">Mutation.cs</span></code><span class="koboSpan" id="kobo.2432.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2433.1" xmlns="http://www.w3.org/1999/xhtml">In the class file, define a record and two classes to represent the three types needed to perform an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2434.1" xmlns="http://www.w3.org/1999/xhtml">addProduct</span></code><span class="koboSpan" id="kobo.2435.1" xmlns="http://www.w3.org/1999/xhtml"> mutation, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2436.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.2437.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.EntityModels; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2438.1" xmlns="http://www.w3.org/1999/xhtml">// To use Product.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2439.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2440.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.2441.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-comment"><span class="koboSpan" id="kobo.2442.1" xmlns="http://www.w3.org/1999/xhtml">// Inputs are readonly so we will use a record.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2443.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2444.1" xmlns="http://www.w3.org/1999/xhtml">record</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2445.1" xmlns="http://www.w3.org/1999/xhtml">AddProductInput</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2446.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2447.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2448.1" xmlns="http://www.w3.org/1999/xhtml"> ProductName,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2449.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2450.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2450.2" xmlns="http://www.w3.org/1999/xhtml">SupplierId,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2451.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2452.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2452.2" xmlns="http://www.w3.org/1999/xhtml">CategoryId,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2453.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2454.1" xmlns="http://www.w3.org/1999/xhtml"> QuantityPerUnit,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2455.1" xmlns="http://www.w3.org/1999/xhtml">decimal</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2456.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2456.2" xmlns="http://www.w3.org/1999/xhtml">UnitPrice,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2457.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2458.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2458.2" xmlns="http://www.w3.org/1999/xhtml">UnitsInStock,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2459.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2460.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2460.2" xmlns="http://www.w3.org/1999/xhtml">UnitsOnOrder,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2461.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2462.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2462.2" xmlns="http://www.w3.org/1999/xhtml">ReorderLevel,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2463.1" xmlns="http://www.w3.org/1999/xhtml">bool</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2464.1" xmlns="http://www.w3.org/1999/xhtml"> Discontinued</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2465.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2466.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2467.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2468.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2469.1" xmlns="http://www.w3.org/1999/xhtml">AddProductPayload</span></span><span class="koboSpan" id="kobo.2470.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2471.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2472.1" xmlns="http://www.w3.org/1999/xhtml">AddProductPayload</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2473.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2474.1" xmlns="http://www.w3.org/1999/xhtml">Product product</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2475.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2476.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    Product = product;
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2477.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.2478.1" xmlns="http://www.w3.org/1999/xhtml"> Product Product { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2479.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.2480.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2481.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2482.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2483.1" xmlns="http://www.w3.org/1999/xhtml">Mutation</span></span><span class="koboSpan" id="kobo.2484.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2485.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2486.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2487.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;AddProductPayload&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2488.1" xmlns="http://www.w3.org/1999/xhtml">AddProductAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2489.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2490.1" xmlns="http://www.w3.org/1999/xhtml">    AddProductInput input, NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2491.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2492.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2493.1" xmlns="http://www.w3.org/1999/xhtml">// This could be a good place to use a tool like AutoMapper,</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.2494.1" xmlns="http://www.w3.org/1999/xhtml">// but we will do the mapping between two objects manually.</span></span><span class="koboSpan" id="kobo.2495.1" xmlns="http://www.w3.org/1999/xhtml">
    Product product = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2496.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2497.1" xmlns="http://www.w3.org/1999/xhtml">()
    {
      ProductName = input.ProductName,
      SupplierId = input.SupplierId,
      CategoryId = input.CategoryId,
      QuantityPerUnit = input.QuantityPerUnit,
      UnitPrice = input.UnitPrice,
      UnitsInStock = input.UnitsInStock,
      UnitsOnOrder = input.UnitsOnOrder,
      ReorderLevel = input.ReorderLevel,
      Discontinued = input.Discontinued
    };
    db.Products.Add(product);
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2498.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.2499.1" xmlns="http://www.w3.org/1999/xhtml"> affectedRows = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2500.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2501.1" xmlns="http://www.w3.org/1999/xhtml"> db.SaveChangesAsync();
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2502.1" xmlns="http://www.w3.org/1999/xhtml">// We could use affectedRows to return an error</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.2503.1" xmlns="http://www.w3.org/1999/xhtml">// or some other action if it is 0.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2504.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2505.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2506.1" xmlns="http://www.w3.org/1999/xhtml"> AddProductPayload(product);
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2507.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2508.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.2509.1" xmlns="http://www.w3.org/1999/xhtml">, add a call to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2510.1" xmlns="http://www.w3.org/1999/xhtml">AddMutationType&lt;T&gt;</span></code><span class="koboSpan" id="kobo.2511.1" xmlns="http://www.w3.org/1999/xhtml"> method</span><a id="_idIndexMarker1348"/><span class="koboSpan" id="kobo.2512.1" xmlns="http://www.w3.org/1999/xhtml"> to register your </span><code class="inlineCode"><span class="koboSpan" id="kobo.2513.1" xmlns="http://www.w3.org/1999/xhtml">Mutation</span></code><span class="koboSpan" id="kobo.2514.1" xmlns="http://www.w3.org/1999/xhtml"> class, as highlighted</span><a id="_idIndexMarker1349"/><span class="koboSpan" id="kobo.2515.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2516.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services
  .AddGraphQLServer()
  .AddFiltering()
  .AddSorting()
  .RegisterDbContext&lt;NorthwindContext&gt;()
  .AddQueryType&lt;Query&gt;()
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2517.1" xmlns="http://www.w3.org/1999/xhtml">  .AddMutationType&lt;Mutation&gt;();</span></strong></span>
</code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-463"><span class="koboSpan" id="kobo.2518.1" xmlns="http://www.w3.org/1999/xhtml">Exploring the add product mutation</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2519.1" xmlns="http://www.w3.org/1999/xhtml">Now, we can explore</span><a id="_idIndexMarker1350"/><span class="koboSpan" id="kobo.2520.1" xmlns="http://www.w3.org/1999/xhtml"> mutations using Banana Cake Pop:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2521.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2522.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.2523.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2524.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2525.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2526.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.2527.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.2528.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2529.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.2530.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2531.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2532.1" xmlns="http://www.w3.org/1999/xhtml">Schema Definition</span></strong><span class="koboSpan" id="kobo.2533.1" xmlns="http://www.w3.org/1999/xhtml"> tab, and note the mutation type, as partially shown in </span><em class="italic"><span class="koboSpan" id="kobo.2534.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.11</span></em><span class="koboSpan" id="kobo.2535.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2536.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2537.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.11: Schema to mutate a product using GraphQL</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.2538.1" xmlns="http://www.w3.org/1999/xhtml">Note the full schema</span><a id="_idIndexMarker1351"/><span class="koboSpan" id="kobo.2539.1" xmlns="http://www.w3.org/1999/xhtml"> definitions for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2540.1" xmlns="http://www.w3.org/1999/xhtml">addProduct</span></code><span class="koboSpan" id="kobo.2541.1" xmlns="http://www.w3.org/1999/xhtml"> mutation and its related types, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2542.1" xmlns="http://www.w3.org/1999/xhtml">type Mutation </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2543.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2544.1" xmlns="http://www.w3.org/1999/xhtml">
  addProduct(input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2545.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2546.1" xmlns="http://www.w3.org/1999/xhtml"> AddProductInput!)</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2547.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2548.1" xmlns="http://www.w3.org/1999/xhtml"> AddProductPayload!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2549.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2550.1" xmlns="http://www.w3.org/1999/xhtml">
type Product </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2551.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2552.1" xmlns="http://www.w3.org/1999/xhtml">
  productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2553.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2554.1" xmlns="http://www.w3.org/1999/xhtml"> Int!
  </span><span class="koboSpan" id="kobo.2554.2" xmlns="http://www.w3.org/1999/xhtml">productName</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2555.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2556.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.2556.2" xmlns="http://www.w3.org/1999/xhtml">supplierId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2557.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2558.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2559.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2560.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  quantityPerUnit</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2561.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2562.1" xmlns="http://www.w3.org/1999/xhtml"> String
  unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2563.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2564.1" xmlns="http://www.w3.org/1999/xhtml"> Decimal
  unitsInStock</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2565.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2566.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  unitsOnOrder</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2567.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2568.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  reorderLevel</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2569.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2570.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  discontinued</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2571.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2572.1" xmlns="http://www.w3.org/1999/xhtml"> Boolean!
  </span><span class="koboSpan" id="kobo.2572.2" xmlns="http://www.w3.org/1999/xhtml">category</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2573.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2574.1" xmlns="http://www.w3.org/1999/xhtml"> Category
  supplier</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2575.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2576.1" xmlns="http://www.w3.org/1999/xhtml"> Supplier
  orderDetails</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2577.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2578.1" xmlns="http://www.w3.org/1999/xhtml">[</span></span><span class="koboSpan" id="kobo.2579.1" xmlns="http://www.w3.org/1999/xhtml">OrderDetail!</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2580.1" xmlns="http://www.w3.org/1999/xhtml">]</span></span><span class="koboSpan" id="kobo.2581.1" xmlns="http://www.w3.org/1999/xhtml">!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2582.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2583.1" xmlns="http://www.w3.org/1999/xhtml">
...
</span><span class="koboSpan" id="kobo.2583.2" xmlns="http://www.w3.org/1999/xhtml">type AddProductPayload </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2584.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2585.1" xmlns="http://www.w3.org/1999/xhtml">
  product</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2586.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2587.1" xmlns="http://www.w3.org/1999/xhtml"> Product!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2588.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2589.1" xmlns="http://www.w3.org/1999/xhtml">
input AddProductInput </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2590.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2591.1" xmlns="http://www.w3.org/1999/xhtml">
  productName</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2592.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2593.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.2593.2" xmlns="http://www.w3.org/1999/xhtml">supplierId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2594.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2595.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2596.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2597.1" xmlns="http://www.w3.org/1999/xhtml"> Int
  quantityPerUnit</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2598.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2599.1" xmlns="http://www.w3.org/1999/xhtml"> String!
  </span><span class="koboSpan" id="kobo.2599.2" xmlns="http://www.w3.org/1999/xhtml">unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2600.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2601.1" xmlns="http://www.w3.org/1999/xhtml"> Decimal
  unitsInStock</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2602.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2603.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  unitsOnOrder</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2604.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2605.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  reorderLevel</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2606.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2607.1" xmlns="http://www.w3.org/1999/xhtml"> Short
  discontinued</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2608.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span><span class="koboSpan" id="kobo.2609.1" xmlns="http://www.w3.org/1999/xhtml"> Boolean!
</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2610.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2611.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2612.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.2613.1" xmlns="http://www.w3.org/1999/xhtml"> tab and, if necessary, create a new blank document, and then enter a mutation to add a new product named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2614.1" xmlns="http://www.w3.org/1999/xhtml">Tasty Burgers</span></code><span class="koboSpan" id="kobo.2615.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.2615.2" xmlns="http://www.w3.org/1999/xhtml">Then, from the returned </span><code class="inlineCode"><span class="koboSpan" id="kobo.2616.1" xmlns="http://www.w3.org/1999/xhtml">product</span></code><span class="koboSpan" id="kobo.2617.1" xmlns="http://www.w3.org/1999/xhtml"> object, just select</span><a id="_idIndexMarker1352"/><span class="koboSpan" id="kobo.2618.1" xmlns="http://www.w3.org/1999/xhtml"> the ID and name, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2619.1" xmlns="http://www.w3.org/1999/xhtml">mutation AddProduct </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2620.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2621.1" xmlns="http://www.w3.org/1999/xhtml">
  addProduct(
    input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2622.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2623.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2624.1" xmlns="http://www.w3.org/1999/xhtml">
      productName</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2625.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2626.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2627.1" xmlns="http://www.w3.org/1999/xhtml">Tasty Burgers"</span></span><span class="koboSpan" id="kobo.2628.1" xmlns="http://www.w3.org/1999/xhtml">
      supplierId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2629.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2630.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.2631.1" xmlns="http://www.w3.org/1999/xhtml">
      categoryId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2632.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2633.1" xmlns="http://www.w3.org/1999/xhtml">2</span></span><span class="koboSpan" id="kobo.2634.1" xmlns="http://www.w3.org/1999/xhtml">
      quantityPerUnit</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2635.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2636.1" xmlns="http://www.w3.org/1999/xhtml">"6 per box"</span></span><span class="koboSpan" id="kobo.2637.1" xmlns="http://www.w3.org/1999/xhtml">
      unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2638.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2639.1" xmlns="http://www.w3.org/1999/xhtml">40</span></span><span class="koboSpan" id="kobo.2640.1" xmlns="http://www.w3.org/1999/xhtml">
      unitsInStock</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2641.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2642.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2643.1" xmlns="http://www.w3.org/1999/xhtml">
      unitsOnOrder</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2644.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2645.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2646.1" xmlns="http://www.w3.org/1999/xhtml">
      reorderLevel</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2647.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2648.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2649.1" xmlns="http://www.w3.org/1999/xhtml">
      discontinued</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2650.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2651.1" xmlns="http://www.w3.org/1999/xhtml">false</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2652.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2653.1" xmlns="http://www.w3.org/1999/xhtml">
  )
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2654.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2655.1" xmlns="http://www.w3.org/1999/xhtml">
    product </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2656.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2657.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2658.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2659.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2660.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2661.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.2662.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.2663.1" xmlns="http://www.w3.org/1999/xhtml">, and note that the new product has been successfully added and assigned the next sequential number by the SQL Server database, which could be any number over 77, depending</span><a id="_idIndexMarker1353"/><span class="koboSpan" id="kobo.2664.1" xmlns="http://www.w3.org/1999/xhtml"> on if you have already added some other products, as shown in the following output and in </span><em class="italic"><span class="koboSpan" id="kobo.2665.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.12</span></em><span class="koboSpan" id="kobo.2666.1" xmlns="http://www.w3.org/1999/xhtml">:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2667.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "addProduct": {
      "product": {
        "productId": 79,
        "productName": "Tasty Burgers",
      }
    }
  }
}
</span></code></pre>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.2668.1" xmlns="http://www.w3.org/1999/xhtml">Warning!</span></strong><span class="koboSpan" id="kobo.2669.1" xmlns="http://www.w3.org/1999/xhtml"> Please make a note of the ID assigned to the new product you have added. </span><span class="koboSpan" id="kobo.2669.2" xmlns="http://www.w3.org/1999/xhtml">In the next section, you will update this product and then delete it. </span><span class="koboSpan" id="kobo.2669.3" xmlns="http://www.w3.org/1999/xhtml">You cannot delete any of the existing products with IDs between 1 and 77 because they are related to other tables, and doing so would throw a referential integrity exception!</span></p>
</div>
</li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2670.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2671.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.12: Adding a new product using a GraphQL mutation</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.2672.1" xmlns="http://www.w3.org/1999/xhtml">Close the browser, and shut down</span><a id="_idIndexMarker1354"/><span class="koboSpan" id="kobo.2673.1" xmlns="http://www.w3.org/1999/xhtml"> the web server.</span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-464"><span class="koboSpan" id="kobo.2674.1" xmlns="http://www.w3.org/1999/xhtml">Implementing updates and deletes as mutations</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2675.1" xmlns="http://www.w3.org/1999/xhtml">Next, we will define mutations</span><a id="_idIndexMarker1355"/><span class="koboSpan" id="kobo.2676.1" xmlns="http://www.w3.org/1999/xhtml"> to update just the unit price </span><a id="_idIndexMarker1356"/><span class="koboSpan" id="kobo.2677.1" xmlns="http://www.w3.org/1999/xhtml">for a product, all the “units” fields</span><a id="_idIndexMarker1357"/><span class="koboSpan" id="kobo.2678.1" xmlns="http://www.w3.org/1999/xhtml"> for a product, and</span><a id="_idIndexMarker1358"/><span class="koboSpan" id="kobo.2679.1" xmlns="http://www.w3.org/1999/xhtml"> delete a product:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2680.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2681.1" xmlns="http://www.w3.org/1999/xhtml">Mutation.cs</span></code><span class="koboSpan" id="kobo.2682.1" xmlns="http://www.w3.org/1999/xhtml">, define three </span><code class="inlineCode"><span class="koboSpan" id="kobo.2683.1" xmlns="http://www.w3.org/1999/xhtml">record</span></code><span class="koboSpan" id="kobo.2684.1" xmlns="http://www.w3.org/1999/xhtml"> types to represent the inputs needed to perform two </span><code class="inlineCode"><span class="koboSpan" id="kobo.2685.1" xmlns="http://www.w3.org/1999/xhtml">updateProduct</span></code><span class="koboSpan" id="kobo.2686.1" xmlns="http://www.w3.org/1999/xhtml"> and one </span><code class="inlineCode"><span class="koboSpan" id="kobo.2687.1" xmlns="http://www.w3.org/1999/xhtml">deleteProduct</span></code><span class="koboSpan" id="kobo.2688.1" xmlns="http://www.w3.org/1999/xhtml"> mutations, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2689.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2690.1" xmlns="http://www.w3.org/1999/xhtml">record</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2691.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPriceInput</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2692.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2693.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2694.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2694.2" xmlns="http://www.w3.org/1999/xhtml">ProductId,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2695.1" xmlns="http://www.w3.org/1999/xhtml">decimal</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2696.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2696.2" xmlns="http://www.w3.org/1999/xhtml">UnitPrice</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2697.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2698.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2699.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2700.1" xmlns="http://www.w3.org/1999/xhtml">record</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2701.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductUnitsInput</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2702.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2703.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2704.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2704.2" xmlns="http://www.w3.org/1999/xhtml">ProductId,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2705.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2706.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2706.2" xmlns="http://www.w3.org/1999/xhtml">UnitsInStock,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2707.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2708.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2708.2" xmlns="http://www.w3.org/1999/xhtml">UnitsOnOrder,</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2709.1" xmlns="http://www.w3.org/1999/xhtml">short</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2710.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2710.2" xmlns="http://www.w3.org/1999/xhtml">ReorderLevel</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2711.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2712.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2713.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2714.1" xmlns="http://www.w3.org/1999/xhtml">record</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2715.1" xmlns="http://www.w3.org/1999/xhtml">DeleteProductInput</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2716.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2717.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2718.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.2718.2" xmlns="http://www.w3.org/1999/xhtml">ProductId</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2719.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2720.1" xmlns="http://www.w3.org/1999/xhtml">;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2721.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2722.1" xmlns="http://www.w3.org/1999/xhtml">Mutation.cs</span></code><span class="koboSpan" id="kobo.2723.1" xmlns="http://www.w3.org/1999/xhtml">, define two class</span><a id="_idIndexMarker1359"/><span class="koboSpan" id="kobo.2724.1" xmlns="http://www.w3.org/1999/xhtml"> types to represent the types needed </span><a id="_idIndexMarker1360"/><span class="koboSpan" id="kobo.2725.1" xmlns="http://www.w3.org/1999/xhtml">to return the results from</span><a id="_idIndexMarker1361"/><span class="koboSpan" id="kobo.2726.1" xmlns="http://www.w3.org/1999/xhtml"> an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2727.1" xmlns="http://www.w3.org/1999/xhtml">update</span></code><span class="koboSpan" id="kobo.2728.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.2729.1" xmlns="http://www.w3.org/1999/xhtml">delete</span></code><span class="koboSpan" id="kobo.2730.1" xmlns="http://www.w3.org/1999/xhtml"> mutation, including if the action was successful, as shown</span><a id="_idIndexMarker1362"/><span class="koboSpan" id="kobo.2731.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2732.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2733.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2734.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPayload</span></span><span class="koboSpan" id="kobo.2735.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2736.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2737.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPayload</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2738.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2739.1" xmlns="http://www.w3.org/1999/xhtml">Product? </span><span class="koboSpan" id="kobo.2739.2" xmlns="http://www.w3.org/1999/xhtml">product, </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2740.1" xmlns="http://www.w3.org/1999/xhtml">bool</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2741.1" xmlns="http://www.w3.org/1999/xhtml"> updated</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2742.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2743.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    Product = product;
    Success = updated;
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2744.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="koboSpan" id="kobo.2745.1" xmlns="http://www.w3.org/1999/xhtml"> Product? </span><span class="koboSpan" id="kobo.2745.2" xmlns="http://www.w3.org/1999/xhtml">Product { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2746.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.2747.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2748.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.2749.1" xmlns="http://www.w3.org/1999/xhtml">bool</span></span><span class="koboSpan" id="kobo.2750.1" xmlns="http://www.w3.org/1999/xhtml"> Success { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2751.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.2752.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2753.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2754.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2755.1" xmlns="http://www.w3.org/1999/xhtml">DeleteProductPayload</span></span><span class="koboSpan" id="kobo.2756.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2757.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.2758.1" xmlns="http://www.w3.org/1999/xhtml">DeleteProductPayload</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2759.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2760.1" xmlns="http://www.w3.org/1999/xhtml">bool</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2761.1" xmlns="http://www.w3.org/1999/xhtml"> deleted</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2762.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2763.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    Success = deleted;
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2764.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.2765.1" xmlns="http://www.w3.org/1999/xhtml">bool</span></span><span class="koboSpan" id="kobo.2766.1" xmlns="http://www.w3.org/1999/xhtml"> Success { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2767.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.2768.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2769.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.2770.1" xmlns="http://www.w3.org/1999/xhtml">Mutation.cs</span></code><span class="koboSpan" id="kobo.2771.1" xmlns="http://www.w3.org/1999/xhtml">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2772.1" xmlns="http://www.w3.org/1999/xhtml">Mutation</span></code><span class="koboSpan" id="kobo.2773.1" xmlns="http://www.w3.org/1999/xhtml"> class, define three methods to implement two </span><code class="inlineCode"><span class="koboSpan" id="kobo.2774.1" xmlns="http://www.w3.org/1999/xhtml">updateProduct</span></code><span class="koboSpan" id="kobo.2775.1" xmlns="http://www.w3.org/1999/xhtml"> and one </span><code class="inlineCode"><span class="koboSpan" id="kobo.2776.1" xmlns="http://www.w3.org/1999/xhtml">deleteProduct</span></code><span class="koboSpan" id="kobo.2777.1" xmlns="http://www.w3.org/1999/xhtml"> mutations, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2778.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2779.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2780.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;UpdateProductPayload&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2781.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPriceAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2782.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2783.1" xmlns="http://www.w3.org/1999/xhtml">  UpdateProductPriceInput input, NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2784.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2785.1" xmlns="http://www.w3.org/1999/xhtml">
{
  Product? </span><span class="koboSpan" id="kobo.2785.2" xmlns="http://www.w3.org/1999/xhtml">product = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2786.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2787.1" xmlns="http://www.w3.org/1999/xhtml"> db.Products.FindAsync(input.ProductId);
  </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2788.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.2789.1" xmlns="http://www.w3.org/1999/xhtml"> affectedRows = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2790.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2791.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2792.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.2793.1" xmlns="http://www.w3.org/1999/xhtml"> (product </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2794.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2795.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.2796.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.2797.1" xmlns="http://www.w3.org/1999/xhtml">)
  {
    product.UnitPrice = input.UnitPrice;
    affectedRows = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2798.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2799.1" xmlns="http://www.w3.org/1999/xhtml"> db.SaveChangesAsync();
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2800.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2801.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2802.1" xmlns="http://www.w3.org/1999/xhtml"> UpdateProductPayload(product, 
    updated: affectedRows == </span><span class="hljs-number"><span class="koboSpan" id="kobo.2803.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.2804.1" xmlns="http://www.w3.org/1999/xhtml">);
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2805.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2806.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2807.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;UpdateProductPayload&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2808.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductUnitsAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2809.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2810.1" xmlns="http://www.w3.org/1999/xhtml">  UpdateProductUnitsInput input, NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2811.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2812.1" xmlns="http://www.w3.org/1999/xhtml">
{
  Product? </span><span class="koboSpan" id="kobo.2812.2" xmlns="http://www.w3.org/1999/xhtml">product = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2813.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2814.1" xmlns="http://www.w3.org/1999/xhtml"> db.Products.FindAsync(input.ProductId);
  </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2815.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.2816.1" xmlns="http://www.w3.org/1999/xhtml"> affectedRows = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2817.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2818.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2819.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.2820.1" xmlns="http://www.w3.org/1999/xhtml"> (product </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2821.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2822.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.2823.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.2824.1" xmlns="http://www.w3.org/1999/xhtml">)
  {
    product.UnitsInStock = input.UnitsInStock;
    product.UnitsOnOrder = input.UnitsOnOrder;
    product.ReorderLevel = input.ReorderLevel;
    affectedRows = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2825.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2826.1" xmlns="http://www.w3.org/1999/xhtml"> db.SaveChangesAsync();
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2827.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2828.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2829.1" xmlns="http://www.w3.org/1999/xhtml"> UpdateProductPayload(product,
    updated: affectedRows == </span><span class="hljs-number"><span class="koboSpan" id="kobo.2830.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.2831.1" xmlns="http://www.w3.org/1999/xhtml">);
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2832.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2833.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2834.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;DeleteProductPayload&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.2835.1" xmlns="http://www.w3.org/1999/xhtml">DeleteProductAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2836.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.2837.1" xmlns="http://www.w3.org/1999/xhtml">  DeleteProductInput input, NorthwindContext db</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2838.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.2839.1" xmlns="http://www.w3.org/1999/xhtml">
{
  Product? </span><span class="koboSpan" id="kobo.2839.2" xmlns="http://www.w3.org/1999/xhtml">product = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2840.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2841.1" xmlns="http://www.w3.org/1999/xhtml"> db.Products.FindAsync(input.ProductId);
  </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2842.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.2843.1" xmlns="http://www.w3.org/1999/xhtml"> affectedRows = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2844.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2845.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2846.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.2847.1" xmlns="http://www.w3.org/1999/xhtml"> (product </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2848.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2849.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.2850.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.2851.1" xmlns="http://www.w3.org/1999/xhtml">)
  {
    db.Products.Remove(product);
    affectedRows = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2852.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.2853.1" xmlns="http://www.w3.org/1999/xhtml"> db.SaveChangesAsync();
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2854.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2855.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.2856.1" xmlns="http://www.w3.org/1999/xhtml"> DeleteProductPayload(
    deleted: affectedRows == </span><span class="hljs-number"><span class="koboSpan" id="kobo.2857.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.2858.1" xmlns="http://www.w3.org/1999/xhtml">);
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2859.1" xmlns="http://www.w3.org/1999/xhtml">If your database server</span><a id="_idIndexMarker1363"/><span class="koboSpan" id="kobo.2860.1" xmlns="http://www.w3.org/1999/xhtml"> is not running, for example, because you are hosting</span><a id="_idIndexMarker1364"/><span class="koboSpan" id="kobo.2861.1" xmlns="http://www.w3.org/1999/xhtml"> it in Docker, a virtual</span><a id="_idIndexMarker1365"/><span class="koboSpan" id="kobo.2862.1" xmlns="http://www.w3.org/1999/xhtml"> machine, or in the cloud, then</span><a id="_idIndexMarker1366"/><span class="koboSpan" id="kobo.2863.1" xmlns="http://www.w3.org/1999/xhtml"> make sure to start it.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2864.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2865.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.2866.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2867.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.2868.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2869.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.2870.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.2871.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2872.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.2873.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2874.1" xmlns="http://www.w3.org/1999/xhtml">Write a named query to request products that you have added, for example, with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2875.1" xmlns="http://www.w3.org/1999/xhtml">productId</span></code><span class="koboSpan" id="kobo.2876.1" xmlns="http://www.w3.org/1999/xhtml"> greater than </span><code class="inlineCode"><span class="koboSpan" id="kobo.2877.1" xmlns="http://www.w3.org/1999/xhtml">77</span></code><span class="koboSpan" id="kobo.2878.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2879.1" xmlns="http://www.w3.org/1999/xhtml">query NewProducts </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2880.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2881.1" xmlns="http://www.w3.org/1999/xhtml">
  products(where</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2882.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2883.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2884.1" xmlns="http://www.w3.org/1999/xhtml"> productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2885.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2886.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2887.1" xmlns="http://www.w3.org/1999/xhtml"> gt</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2888.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2889.1" xmlns="http://www.w3.org/1999/xhtml">77</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2890.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2891.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2892.1" xmlns="http://www.w3.org/1999/xhtml">) </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2893.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2894.1" xmlns="http://www.w3.org/1999/xhtml">
    productId
    productName
    unitPrice
    unitsInStock
    unitsOnOrder
    reorderLevel
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2895.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2896.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2897.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.2898.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.2899.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response includes the new product you previously added with a unit price of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2900.1" xmlns="http://www.w3.org/1999/xhtml">40</span></code><span class="koboSpan" id="kobo.2901.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2902.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": [
      {
        "productId": 79,
        "productName": "Tasty Burgers",
        "unitPrice": 40,
        "unitsInStock": 0,
        "unitsOnOrder": 0,
        "reorderLevel": 0
      }
    ]
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2903.1" xmlns="http://www.w3.org/1999/xhtml">Make a note of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2904.1" xmlns="http://www.w3.org/1999/xhtml">productId</span></code><span class="koboSpan" id="kobo.2905.1" xmlns="http://www.w3.org/1999/xhtml"> of the product you added. </span><span class="koboSpan" id="kobo.2905.2" xmlns="http://www.w3.org/1999/xhtml">In my case, it is </span><code class="inlineCode"><span class="koboSpan" id="kobo.2906.1" xmlns="http://www.w3.org/1999/xhtml">79</span></code><span class="koboSpan" id="kobo.2907.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2908.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.2909.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.2910.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2911.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.2912.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2913.1" xmlns="http://www.w3.org/1999/xhtml">Enter a mutation to update the unit</span><a id="_idIndexMarker1367"/><span class="koboSpan" id="kobo.2914.1" xmlns="http://www.w3.org/1999/xhtml"> price of your new product to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2915.1" xmlns="http://www.w3.org/1999/xhtml">75</span></code><span class="koboSpan" id="kobo.2916.1" xmlns="http://www.w3.org/1999/xhtml">, and then</span><a id="_idIndexMarker1368"/><span class="koboSpan" id="kobo.2917.1" xmlns="http://www.w3.org/1999/xhtml"> from the returned </span><code class="inlineCode"><span class="koboSpan" id="kobo.2918.1" xmlns="http://www.w3.org/1999/xhtml">product</span></code><span class="koboSpan" id="kobo.2919.1" xmlns="http://www.w3.org/1999/xhtml"> object, just </span><a id="_idIndexMarker1369"/><span class="koboSpan" id="kobo.2920.1" xmlns="http://www.w3.org/1999/xhtml">select the ID, name, unit </span><a id="_idIndexMarker1370"/><span class="koboSpan" id="kobo.2921.1" xmlns="http://www.w3.org/1999/xhtml">price, and units in stock, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2922.1" xmlns="http://www.w3.org/1999/xhtml">mutation UpdateProductPrice </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2923.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2924.1" xmlns="http://www.w3.org/1999/xhtml">
  updateProductPrice(
    input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2925.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2926.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2927.1" xmlns="http://www.w3.org/1999/xhtml">
      productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2928.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2929.1" xmlns="http://www.w3.org/1999/xhtml">79</span></span><span class="koboSpan" id="kobo.2930.1" xmlns="http://www.w3.org/1999/xhtml">
      unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2931.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2932.1" xmlns="http://www.w3.org/1999/xhtml">75</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2933.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2934.1" xmlns="http://www.w3.org/1999/xhtml">
  ) 
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2935.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2936.1" xmlns="http://www.w3.org/1999/xhtml">
    product </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2937.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2938.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      productName
      unitPrice
      unitsInStock
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2939.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2940.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2941.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2942.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.2943.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.2944.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2945.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "updateProductPrice": {
      "product": {
        "productId": 79,
        "productName": "Tasty Burgers",
        "unitPrice": 75,
        "unitsInStock": 0
      }
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2946.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2947.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.2948.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new </span><a id="_idIndexMarker1371"/><span class="koboSpan" id="kobo.2949.1" xmlns="http://www.w3.org/1999/xhtml">tab, enter a mutation to update</span><a id="_idIndexMarker1372"/><span class="koboSpan" id="kobo.2950.1" xmlns="http://www.w3.org/1999/xhtml"> the units of an existing product, and then</span><a id="_idIndexMarker1373"/><span class="koboSpan" id="kobo.2951.1" xmlns="http://www.w3.org/1999/xhtml"> from the returned </span><code class="inlineCode"><span class="koboSpan" id="kobo.2952.1" xmlns="http://www.w3.org/1999/xhtml">product</span></code><span class="koboSpan" id="kobo.2953.1" xmlns="http://www.w3.org/1999/xhtml"> object just select the ID, name, unit price, and</span><a id="_idIndexMarker1374"/><span class="koboSpan" id="kobo.2954.1" xmlns="http://www.w3.org/1999/xhtml"> units in stock, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2955.1" xmlns="http://www.w3.org/1999/xhtml">mutation UpdateProductUnits </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2956.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2957.1" xmlns="http://www.w3.org/1999/xhtml">
  updateProductUnits(
    input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2958.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2959.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2960.1" xmlns="http://www.w3.org/1999/xhtml">
      productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2961.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2962.1" xmlns="http://www.w3.org/1999/xhtml">79</span></span><span class="koboSpan" id="kobo.2963.1" xmlns="http://www.w3.org/1999/xhtml">
      unitsInStock</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2964.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2965.1" xmlns="http://www.w3.org/1999/xhtml">20</span></span><span class="koboSpan" id="kobo.2966.1" xmlns="http://www.w3.org/1999/xhtml">
      unitsOnOrder</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2967.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2968.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.2969.1" xmlns="http://www.w3.org/1999/xhtml">
      reorderLevel</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2970.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2971.1" xmlns="http://www.w3.org/1999/xhtml">10</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2972.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.2973.1" xmlns="http://www.w3.org/1999/xhtml">
  ) 
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2974.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2975.1" xmlns="http://www.w3.org/1999/xhtml">
    success
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2976.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.2977.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2978.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.2979.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.2980.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2981.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "updateProductUnits": {
      "success": true
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2982.1" xmlns="http://www.w3.org/1999/xhtml">In the query tab to request new products, click </span><strong class="screenText"><span class="koboSpan" id="kobo.2983.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.2984.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2985.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": [
      {
        "productId": 79,
        "productName": "Tasty Burgers",
        "unitPrice": 75,
        "unitsInStock": 20,
        "unitsOnOrder": 0,
        "reorderLevel": 10
      }
    ]
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2986.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2987.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.2988.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab, and enter</span><a id="_idIndexMarker1375"/><span class="koboSpan" id="kobo.2989.1" xmlns="http://www.w3.org/1999/xhtml"> a mutation to delete the product</span><a id="_idIndexMarker1376"/><span class="koboSpan" id="kobo.2990.1" xmlns="http://www.w3.org/1999/xhtml"> and show if it was</span><a id="_idIndexMarker1377"/><span class="koboSpan" id="kobo.2991.1" xmlns="http://www.w3.org/1999/xhtml"> successful, as shown</span><a id="_idIndexMarker1378"/><span class="koboSpan" id="kobo.2992.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2993.1" xmlns="http://www.w3.org/1999/xhtml">mutation DeleteProduct </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2994.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2995.1" xmlns="http://www.w3.org/1999/xhtml">
  deleteProduct(
    input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2996.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.2997.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.2998.1" xmlns="http://www.w3.org/1999/xhtml">
      productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.2999.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.3000.1" xmlns="http://www.w3.org/1999/xhtml">79</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.3001.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.3002.1" xmlns="http://www.w3.org/1999/xhtml">
  ) 
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3003.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3004.1" xmlns="http://www.w3.org/1999/xhtml">
    success
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3005.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.3006.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.3007.1" xmlns="http://www.w3.org/1999/xhtml">Warning!</span></strong><span class="koboSpan" id="kobo.3008.1" xmlns="http://www.w3.org/1999/xhtml"> You will not be able to delete products that are referenced in other tables. </span><span class="koboSpan" id="kobo.3008.2" xmlns="http://www.w3.org/1999/xhtml">IDs 1 to 77 will throw a referential integrity exception.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="17"><span class="koboSpan" id="kobo.3009.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.3010.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.3011.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.3012.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "deleteProduct": {
      "success": true
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3013.1" xmlns="http://www.w3.org/1999/xhtml">Confirm that the product was deleted by re-running the query for new products, and note that you get an empty array, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.3014.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "products": []
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3015.1" xmlns="http://www.w3.org/1999/xhtml">Close the </span><a id="_idIndexMarker1379"/><span class="koboSpan" id="kobo.3016.1" xmlns="http://www.w3.org/1999/xhtml">browser, and shut</span><a id="_idIndexMarker1380"/><span class="koboSpan" id="kobo.3017.1" xmlns="http://www.w3.org/1999/xhtml"> down</span><a id="_idIndexMarker1381"/><span class="koboSpan" id="kobo.3018.1" xmlns="http://www.w3.org/1999/xhtml"> the web</span><a id="_idIndexMarker1382"/><span class="koboSpan" id="kobo.3019.1" xmlns="http://www.w3.org/1999/xhtml"> server.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-465"><span class="koboSpan" id="kobo.3020.1" xmlns="http://www.w3.org/1999/xhtml">Implementing GraphQL subscriptions</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3021.1" xmlns="http://www.w3.org/1999/xhtml">GraphQL subscriptions, by default, work over WebSockets</span><a id="_idIndexMarker1383"/><span class="koboSpan" id="kobo.3022.1" xmlns="http://www.w3.org/1999/xhtml"> but can also</span><a id="_idIndexMarker1384"/><span class="koboSpan" id="kobo.3023.1" xmlns="http://www.w3.org/1999/xhtml"> work over </span><strong class="keyWord"><span class="koboSpan" id="kobo.3024.1" xmlns="http://www.w3.org/1999/xhtml">Server-Sent Events</span></strong><span class="koboSpan" id="kobo.3025.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.3026.1" xmlns="http://www.w3.org/1999/xhtml">SSE</span></strong><span class="koboSpan" id="kobo.3027.1" xmlns="http://www.w3.org/1999/xhtml">), SignalR, or even gRPC.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3028.1" xmlns="http://www.w3.org/1999/xhtml">Imagine that a client app wants to be notified when a product has its unit price reduced. </span><span class="koboSpan" id="kobo.3028.2" xmlns="http://www.w3.org/1999/xhtml">It would be great if the client could subscribe to an event that gets triggered whenever a unit price is reduced, instead of having to query for changes to the unit prices.</span></p>
<h2 class="heading-2" id="_idParaDest-466"><span class="koboSpan" id="kobo.3029.1" xmlns="http://www.w3.org/1999/xhtml">Adding a subscription and topic to the GraphQL service</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3030.1" xmlns="http://www.w3.org/1999/xhtml">Let’s add this feature</span><a id="_idIndexMarker1385"/><span class="koboSpan" id="kobo.3031.1" xmlns="http://www.w3.org/1999/xhtml"> to our GraphQL service </span><a id="_idIndexMarker1386"/><span class="koboSpan" id="kobo.3032.1" xmlns="http://www.w3.org/1999/xhtml">using subscriptions:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.3033.1" xmlns="http://www.w3.org/1999/xhtml">Add a new class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.3034.1" xmlns="http://www.w3.org/1999/xhtml">ProductDiscount.cs</span></code><span class="koboSpan" id="kobo.3035.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3036.1" xmlns="http://www.w3.org/1999/xhtml">Modify the contents</span><a id="_idIndexMarker1387"/><span class="koboSpan" id="kobo.3037.1" xmlns="http://www.w3.org/1999/xhtml"> to define a model to notify a client about</span><a id="_idIndexMarker1388"/><span class="koboSpan" id="kobo.3038.1" xmlns="http://www.w3.org/1999/xhtml"> a product’s unit price reduction, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.3039.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3040.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.3041.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3042.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3043.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3044.1" xmlns="http://www.w3.org/1999/xhtml">ProductDiscount</span></span><span class="koboSpan" id="kobo.3045.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3046.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.3047.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.3048.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.3048.2" xmlns="http://www.w3.org/1999/xhtml">ProductId { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3049.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.3050.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3051.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.3052.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3053.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.3054.1" xmlns="http://www.w3.org/1999/xhtml">decimal</span></span><span class="koboSpan" id="kobo.3055.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.3055.2" xmlns="http://www.w3.org/1999/xhtml">OriginalUnitPrice { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3056.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.3057.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3058.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.3059.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3060.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.3061.1" xmlns="http://www.w3.org/1999/xhtml">decimal</span></span><span class="koboSpan" id="kobo.3062.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.3062.2" xmlns="http://www.w3.org/1999/xhtml">NewUnitPrice { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3063.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.3064.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3065.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.3066.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3067.1" xmlns="http://www.w3.org/1999/xhtml">Add a new class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.3068.1" xmlns="http://www.w3.org/1999/xhtml">Subscription.cs</span></code><span class="koboSpan" id="kobo.3069.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3070.1" xmlns="http://www.w3.org/1999/xhtml">Modify the contents to define a subscription</span><a id="_idIndexMarker1389"/><span class="koboSpan" id="kobo.3071.1" xmlns="http://www.w3.org/1999/xhtml"> to an event (aka a topic) named </span><code class="inlineCode"><span class="koboSpan" id="kobo.3072.1" xmlns="http://www.w3.org/1999/xhtml">OnProductDiscounted</span></code><span class="koboSpan" id="kobo.3073.1" xmlns="http://www.w3.org/1999/xhtml"> that a client</span><a id="_idIndexMarker1390"/><span class="koboSpan" id="kobo.3074.1" xmlns="http://www.w3.org/1999/xhtml"> can subscribe</span><a id="_idIndexMarker1391"/><span class="koboSpan" id="kobo.3075.1" xmlns="http://www.w3.org/1999/xhtml"> to, as shown in the following</span><a id="_idIndexMarker1392"/><span class="koboSpan" id="kobo.3076.1" xmlns="http://www.w3.org/1999/xhtml"> code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.3077.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3078.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></span><span class="koboSpan" id="kobo.3079.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3080.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3081.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3082.1" xmlns="http://www.w3.org/1999/xhtml">Subscription</span></span><span class="koboSpan" id="kobo.3083.1" xmlns="http://www.w3.org/1999/xhtml">
{
  [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.3084.1" xmlns="http://www.w3.org/1999/xhtml">Subscribe</span></span><span class="koboSpan" id="kobo.3085.1" xmlns="http://www.w3.org/1999/xhtml">]
  [</span><span class="hljs-meta"><span class="koboSpan" id="kobo.3086.1" xmlns="http://www.w3.org/1999/xhtml">Topic</span></span><span class="koboSpan" id="kobo.3087.1" xmlns="http://www.w3.org/1999/xhtml">]
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3088.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.3089.1" xmlns="http://www.w3.org/1999/xhtml"> ProductDiscount </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.3090.1" xmlns="http://www.w3.org/1999/xhtml">OnProductDiscounted</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.3091.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.3092.1" xmlns="http://www.w3.org/1999/xhtml">    [EventMessage] ProductDiscount productDiscount</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.3093.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.3094.1" xmlns="http://www.w3.org/1999/xhtml">
      =&gt; productDiscount;
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3095.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.3096.1" xmlns="http://www.w3.org/1999/xhtml">Mutation.cs</span></code><span class="koboSpan" id="kobo.3097.1" xmlns="http://www.w3.org/1999/xhtml">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3098.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPriceAsync</span></code><span class="koboSpan" id="kobo.3099.1" xmlns="http://www.w3.org/1999/xhtml"> method, add statements to send a message over the topic whenever a product has its unit price reduced, as highlighted in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.3100.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3101.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.3102.1" xmlns="http://www.w3.org/1999/xhtml"> Task&lt;UpdateProductPayload&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.3103.1" xmlns="http://www.w3.org/1999/xhtml">UpdateProductPriceAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.3104.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.3105.1" xmlns="http://www.w3.org/1999/xhtml">  UpdateProductPriceInput input, NorthwindContext db</span></span><span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.3106.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.3107.1" xmlns="http://www.w3.org/1999/xhtml">  ITopicEventSender eventSender</span></strong></span><span class="hljs-function"><span class="koboSpan" id="kobo.3108.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.3109.1" xmlns="http://www.w3.org/1999/xhtml">
{
  Product? </span><span class="koboSpan" id="kobo.3109.2" xmlns="http://www.w3.org/1999/xhtml">product = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3110.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.3111.1" xmlns="http://www.w3.org/1999/xhtml"> db.Products.FindAsync(input.ProductId);
  </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.3112.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.3113.1" xmlns="http://www.w3.org/1999/xhtml"> affectedRows = </span><span class="hljs-number"><span class="koboSpan" id="kobo.3114.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.3115.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3116.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.3117.1" xmlns="http://www.w3.org/1999/xhtml"> (product </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3118.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3119.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.3120.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.3121.1" xmlns="http://www.w3.org/1999/xhtml">)
  {
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3122.1" xmlns="http://www.w3.org/1999/xhtml">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3123.1" xmlns="http://www.w3.org/1999/xhtml"> (input.UnitPrice &lt; product.UnitPrice)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3124.1" xmlns="http://www.w3.org/1999/xhtml">    {</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.3125.1" xmlns="http://www.w3.org/1999/xhtml">// If the product has been discounted,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.3126.1" xmlns="http://www.w3.org/1999/xhtml">// send a message to subscribers.</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3127.1" xmlns="http://www.w3.org/1999/xhtml">      ProductDiscount productDiscount = </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3128.1" xmlns="http://www.w3.org/1999/xhtml">new</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3129.1" xmlns="http://www.w3.org/1999/xhtml">()</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3130.1" xmlns="http://www.w3.org/1999/xhtml">      {</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3131.1" xmlns="http://www.w3.org/1999/xhtml">        ProductId = input.ProductId,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3132.1" xmlns="http://www.w3.org/1999/xhtml">        OriginalUnitPrice = product.UnitPrice,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3133.1" xmlns="http://www.w3.org/1999/xhtml">        NewUnitPrice = input.UnitPrice</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3134.1" xmlns="http://www.w3.org/1999/xhtml">      };</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3135.1" xmlns="http://www.w3.org/1999/xhtml">await</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3136.1" xmlns="http://www.w3.org/1999/xhtml"> eventSender.SendAsync(topicName:</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3137.1" xmlns="http://www.w3.org/1999/xhtml">nameof</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3138.1" xmlns="http://www.w3.org/1999/xhtml">(Subscription.OnProductDiscounted),</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3139.1" xmlns="http://www.w3.org/1999/xhtml">        message: productDiscount);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3140.1" xmlns="http://www.w3.org/1999/xhtml">    }</span></strong></span><span class="koboSpan" id="kobo.3141.1" xmlns="http://www.w3.org/1999/xhtml">
    product.UnitPrice = input.UnitPrice;
    affectedRows = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3142.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.3143.1" xmlns="http://www.w3.org/1999/xhtml"> db.SaveChangesAsync();
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3144.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3145.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.3146.1" xmlns="http://www.w3.org/1999/xhtml"> UpdateProductPayload(product,
    updated: affectedRows == </span><span class="hljs-number"><span class="koboSpan" id="kobo.3147.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.3148.1" xmlns="http://www.w3.org/1999/xhtml">);
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3149.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.3150.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.3151.1" xmlns="http://www.w3.org/1999/xhtml">, configure the GraphQL service</span><a id="_idIndexMarker1393"/><span class="koboSpan" id="kobo.3152.1" xmlns="http://www.w3.org/1999/xhtml"> to register the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3153.1" xmlns="http://www.w3.org/1999/xhtml">Subscription</span></code><span class="koboSpan" id="kobo.3154.1" xmlns="http://www.w3.org/1999/xhtml"> class</span><a id="_idIndexMarker1394"/><span class="koboSpan" id="kobo.3155.1" xmlns="http://www.w3.org/1999/xhtml"> and to store active subscriptions</span><a id="_idIndexMarker1395"/><span class="koboSpan" id="kobo.3156.1" xmlns="http://www.w3.org/1999/xhtml"> in-memory, as highlighted</span><a id="_idIndexMarker1396"/><span class="koboSpan" id="kobo.3157.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3158.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services
  .AddGraphQLServer()
  .AddFiltering()
  .AddSorting()
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3159.1" xmlns="http://www.w3.org/1999/xhtml">  .AddSubscriptionType&lt;Subscription&gt;()</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3160.1" xmlns="http://www.w3.org/1999/xhtml">  .AddInMemorySubscriptions()</span></strong></span><span class="koboSpan" id="kobo.3161.1" xmlns="http://www.w3.org/1999/xhtml">
  .RegisterDbContext&lt;NorthwindContext&gt;()
  .AddQueryType&lt;Query&gt;()
  .AddMutationType&lt;Mutation&gt;();
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.3162.1" xmlns="http://www.w3.org/1999/xhtml">As well as in-memory, you can use Redis and other data stores to keep track of active subscriptions.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.3163.1" xmlns="http://www.w3.org/1999/xhtml">Optionally, after building</span><a id="_idIndexMarker1397"/><span class="koboSpan" id="kobo.3164.1" xmlns="http://www.w3.org/1999/xhtml"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3165.1" xmlns="http://www.w3.org/1999/xhtml">app</span></code><span class="koboSpan" id="kobo.3166.1" xmlns="http://www.w3.org/1999/xhtml">, configure</span><a id="_idIndexMarker1398"/><span class="koboSpan" id="kobo.3167.1" xmlns="http://www.w3.org/1999/xhtml"> the use</span><a id="_idIndexMarker1399"/><span class="koboSpan" id="kobo.3168.1" xmlns="http://www.w3.org/1999/xhtml"> of WebSockets, as shown</span><a id="_idIndexMarker1400"/><span class="koboSpan" id="kobo.3169.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3170.1" xmlns="http://www.w3.org/1999/xhtml">app.UseWebSockets(); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.3171.1" xmlns="http://www.w3.org/1999/xhtml">// For subscriptions.</span></span>
</code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.3172.1" xmlns="http://www.w3.org/1999/xhtml">This is optional because the GraphQL service can fall back to using SSE over </span><code class="inlineCode"><span class="koboSpan" id="kobo.3173.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.3174.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-467"><span class="koboSpan" id="kobo.3175.1" xmlns="http://www.w3.org/1999/xhtml">Exploring subscribing to a topic</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3176.1" xmlns="http://www.w3.org/1999/xhtml">Let’s subscribe to a topic</span><a id="_idIndexMarker1401"/><span class="koboSpan" id="kobo.3177.1" xmlns="http://www.w3.org/1999/xhtml"> and see the results:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.3178.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3179.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.GraphQL.Service</span></code><span class="koboSpan" id="kobo.3180.1" xmlns="http://www.w3.org/1999/xhtml"> project, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3181.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.3182.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3183.1" xmlns="http://www.w3.org/1999/xhtml">In </span><strong class="screenText"><span class="koboSpan" id="kobo.3184.1" xmlns="http://www.w3.org/1999/xhtml">Banana Cake Pop</span></strong><span class="koboSpan" id="kobo.3185.1" xmlns="http://www.w3.org/1999/xhtml">, click the </span><strong class="screenText"><span class="koboSpan" id="kobo.3186.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.3187.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3188.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.3189.1" xmlns="http://www.w3.org/1999/xhtml">Schema Reference</span></strong><span class="koboSpan" id="kobo.3190.1" xmlns="http://www.w3.org/1999/xhtml"> tab, click the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3191.1" xmlns="http://www.w3.org/1999/xhtml">Subscription</span></code><span class="koboSpan" id="kobo.3192.1" xmlns="http://www.w3.org/1999/xhtml"> type, and note the topic named </span><strong class="screenText"><span class="koboSpan" id="kobo.3193.1" xmlns="http://www.w3.org/1999/xhtml">onProductDiscounted</span></strong><span class="koboSpan" id="kobo.3194.1" xmlns="http://www.w3.org/1999/xhtml">, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.3195.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.13</span></em><span class="koboSpan" id="kobo.3196.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.3197.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_13.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.3198.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.13: A subscription with a topic</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.3199.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.3200.1" xmlns="http://www.w3.org/1999/xhtml">Operations</span></strong><span class="koboSpan" id="kobo.3201.1" xmlns="http://www.w3.org/1999/xhtml">, enter a subscription to the topic, and choose all the fields to show in the results, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3202.1" xmlns="http://www.w3.org/1999/xhtml">subscription </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3203.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3204.1" xmlns="http://www.w3.org/1999/xhtml">
  onProductDiscounted </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3205.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3206.1" xmlns="http://www.w3.org/1999/xhtml">
    productId
    originalUnitPrice
    newUnitPrice
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3207.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.3208.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3209.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.3210.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.3211.1" xmlns="http://www.w3.org/1999/xhtml">, and note that the subscription starts but no results are shown yet.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3212.1" xmlns="http://www.w3.org/1999/xhtml">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.3213.1" xmlns="http://www.w3.org/1999/xhtml">+</span></strong><span class="koboSpan" id="kobo.3214.1" xmlns="http://www.w3.org/1999/xhtml"> to open a new tab, and enter a mutation</span><a id="_idIndexMarker1402"/><span class="koboSpan" id="kobo.3215.1" xmlns="http://www.w3.org/1999/xhtml"> to update the unit price of the existing product </span><code class="inlineCode"><span class="koboSpan" id="kobo.3216.1" xmlns="http://www.w3.org/1999/xhtml">1</span></code><span class="koboSpan" id="kobo.3217.1" xmlns="http://www.w3.org/1999/xhtml"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3218.1" xmlns="http://www.w3.org/1999/xhtml">8.99</span></code><span class="koboSpan" id="kobo.3219.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.3219.2" xmlns="http://www.w3.org/1999/xhtml">Then, from the returned </span><code class="inlineCode"><span class="koboSpan" id="kobo.3220.1" xmlns="http://www.w3.org/1999/xhtml">product</span></code><span class="koboSpan" id="kobo.3221.1" xmlns="http://www.w3.org/1999/xhtml"> object, select the ID and unit price, and show if the update succeeded, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3222.1" xmlns="http://www.w3.org/1999/xhtml">mutation UpdateProductPrice </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3223.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3224.1" xmlns="http://www.w3.org/1999/xhtml">
  updateProductPrice(
    input</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3225.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.3226.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3227.1" xmlns="http://www.w3.org/1999/xhtml">
      productId</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3228.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.3229.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span><span class="koboSpan" id="kobo.3230.1" xmlns="http://www.w3.org/1999/xhtml">
      unitPrice</span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3231.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.3232.1" xmlns="http://www.w3.org/1999/xhtml">8.99</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.3233.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.3234.1" xmlns="http://www.w3.org/1999/xhtml">
  ) 
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3235.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3236.1" xmlns="http://www.w3.org/1999/xhtml">
    product </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3237.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.3238.1" xmlns="http://www.w3.org/1999/xhtml">
      productId
      unitPrice
    </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3239.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.3240.1" xmlns="http://www.w3.org/1999/xhtml">
    success
  </span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.3241.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.3242.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3243.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.3244.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.3245.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.3246.1" xmlns="http://www.w3.org/1999/xhtml">{
  "data": {
    "updateProductPrice": {
      "product": {
        "productId": 1,
        "unitPrice": 8.99
      },
      "success": true
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3247.1" xmlns="http://www.w3.org/1999/xhtml">Switch back to the tab with the subscription, and note the response and that the subscription is still active, indicated by the spinners on the tab and the </span><strong class="screenText"><span class="koboSpan" id="kobo.3248.1" xmlns="http://www.w3.org/1999/xhtml">Cancel</span></strong><span class="koboSpan" id="kobo.3249.1" xmlns="http://www.w3.org/1999/xhtml"> button, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.3250.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.14</span></em><span class="koboSpan" id="kobo.3251.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.3252.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_12_14.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.3253.1" xmlns="http://www.w3.org/1999/xhtml">Figure 12.14: An active subscription shows a spinner</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.3254.1" xmlns="http://www.w3.org/1999/xhtml">Switch back to the tab with the update mutation, change the unit price to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3255.1" xmlns="http://www.w3.org/1999/xhtml">7.99</span></code><span class="koboSpan" id="kobo.3256.1" xmlns="http://www.w3.org/1999/xhtml">, and click </span><strong class="screenText"><span class="koboSpan" id="kobo.3257.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.3258.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.3258.2" xmlns="http://www.w3.org/1999/xhtml">Then, switch back to the tab with the subscription, and note that it receives that update notification too.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3259.1" xmlns="http://www.w3.org/1999/xhtml">Switch back to the tab with the update mutation, change the unit price to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3260.1" xmlns="http://www.w3.org/1999/xhtml">9.99</span></code><span class="koboSpan" id="kobo.3261.1" xmlns="http://www.w3.org/1999/xhtml">, and click </span><strong class="screenText"><span class="koboSpan" id="kobo.3262.1" xmlns="http://www.w3.org/1999/xhtml">Run</span></strong><span class="koboSpan" id="kobo.3263.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.3263.2" xmlns="http://www.w3.org/1999/xhtml">Then, switch back to the tab with the subscription, and note that it has not been sent any notifications because the unit price was increased, not reduced.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3264.1" xmlns="http://www.w3.org/1999/xhtml">Close the browser, and shut down</span><a id="_idIndexMarker1403"/><span class="koboSpan" id="kobo.3265.1" xmlns="http://www.w3.org/1999/xhtml"> the web server.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-468"><span class="koboSpan" id="kobo.3266.1" xmlns="http://www.w3.org/1999/xhtml">Practicing and exploring</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3267.1" xmlns="http://www.w3.org/1999/xhtml">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</span></p>
<h2 class="heading-2" id="_idParaDest-469"><span class="koboSpan" id="kobo.3268.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 12.1 – Test your knowledge</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3269.1" xmlns="http://www.w3.org/1999/xhtml">Answer the following questions:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.3270.1" xmlns="http://www.w3.org/1999/xhtml">What transport protocol does a GraphQL service use?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3271.1" xmlns="http://www.w3.org/1999/xhtml">What media type does GraphQL use for its queries?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3272.1" xmlns="http://www.w3.org/1999/xhtml">How can you parameterize GraphQL queries?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3273.1" xmlns="http://www.w3.org/1999/xhtml">What are the benefits of using Strawberry Shake over a regular HTTP client for GraphQL queries?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.3274.1" xmlns="http://www.w3.org/1999/xhtml">How might you insert a new product into the Northwind database? </span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-470"><span class="koboSpan" id="kobo.3275.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 12.2 – Explore topics</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3276.1" xmlns="http://www.w3.org/1999/xhtml">Use the links on the following page to learn more details about the topics covered in this chapter:</span></p>
<p class="normal"><a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-12---combining-data-sources-using-graphql"><span class="url"><span class="koboSpan" id="kobo.3277.1" xmlns="http://www.w3.org/1999/xhtml">https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-12---combining-data-sources-using-graphql</span></span></a></p>
<h2 class="heading-2" id="_idParaDest-471"><span class="koboSpan" id="kobo.3278.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 12.3 – Practice building .NET clients</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3279.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.3280.1" xmlns="http://www.w3.org/1999/xhtml">HomeController.cs</span></code><span class="koboSpan" id="kobo.3281.1" xmlns="http://www.w3.org/1999/xhtml">, add an action method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.3282.1" xmlns="http://www.w3.org/1999/xhtml">Categories</span></code><span class="koboSpan" id="kobo.3283.1" xmlns="http://www.w3.org/1999/xhtml"> , and implement it to query the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3284.1" xmlns="http://www.w3.org/1999/xhtml">categories</span></code><span class="koboSpan" id="kobo.3285.1" xmlns="http://www.w3.org/1999/xhtml"> field with a variable for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3286.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.3287.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.3287.2" xmlns="http://www.w3.org/1999/xhtml">On the page, allow the visitor to submit an </span><code class="inlineCode"><span class="koboSpan" id="kobo.3288.1" xmlns="http://www.w3.org/1999/xhtml">id</span></code><span class="koboSpan" id="kobo.3289.1" xmlns="http://www.w3.org/1999/xhtml">, and note the category information and a list of its products.</span></p>
<h1 class="heading-1" id="_idParaDest-472"><span class="koboSpan" id="kobo.3290.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3291.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you learned about:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.3292.1" xmlns="http://www.w3.org/1999/xhtml">Some of the concepts of GraphQL.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3293.1" xmlns="http://www.w3.org/1999/xhtml">How to build a </span><code class="inlineCode"><span class="koboSpan" id="kobo.3294.1" xmlns="http://www.w3.org/1999/xhtml">Query</span></code><span class="koboSpan" id="kobo.3295.1" xmlns="http://www.w3.org/1999/xhtml"> class with fields that represent entities that can be queried.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3296.1" xmlns="http://www.w3.org/1999/xhtml">How to use the Banana Cake Pop tool to explore a GraphQL service schema.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3297.1" xmlns="http://www.w3.org/1999/xhtml">How to use the REST Client extension to POST to a GraphQL service.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3298.1" xmlns="http://www.w3.org/1999/xhtml">How to create a .NET client for a GraphQL service.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3299.1" xmlns="http://www.w3.org/1999/xhtml">How to implement GraphQL mutations.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3300.1" xmlns="http://www.w3.org/1999/xhtml">How to implement GraphQL subscriptions.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.3301.1" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, you will learn about the gRPC service technology that can be used to implement efficient microservices.</span></p>
<h1 class="heading-1" id="_idParaDest-473"><span class="koboSpan" id="kobo.3302.1" xmlns="http://www.w3.org/1999/xhtml">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3303.1" xmlns="http://www.w3.org/1999/xhtml">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="https://packt.link/apps_and_services_dotnet8"><span class="url"><span class="koboSpan" id="kobo.3304.1" xmlns="http://www.w3.org/1999/xhtml">https://packt.link/apps_and_services_dotnet8</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.3305.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/QR_Code3048220001028652625.png"/></span></p>
</div>
</body>
</html>
