<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<title>Chapter_11</title>
<link href="../Styles/syntax-highlighting.css" rel="stylesheet" type="text/css"/>
<link href="../Styles/epub.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body id="Chapter_11" lang="en-US" xml:lang="en-US">
<div class="Basic-Text-Frame" id="_idContainer357">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">11</span></h1>
<h1 class="chapterTitle" id="_idParaDest-411"><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Broadcasting Real-Time Communication Using SignalR</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you will be introduced to SignalR, a technology that enables a developer to create a service that can have multiple clients and broadcast messages to all of them or a subset of them live in real time. </span><span class="koboSpan" id="kobo.3.2" xmlns="http://www.w3.org/1999/xhtml">The canonical example is a group chat app. </span><span class="koboSpan" id="kobo.3.3" xmlns="http://www.w3.org/1999/xhtml">Other examples include notification systems and dashboards that need instantly up-to-date information like stock prices.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">This chapter will cover the following topics:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">Understanding SignalR</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">Building a live communication service using SignalR</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">Building a web client using the SignalR JavaScript library</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Building a .NET console app client</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">Streaming data using SignalR</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-412"><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">Understanding SignalR</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">To understand the problem that </span><a id="_idIndexMarker1140"/><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">SignalR solves, we need to understand what web development is like without it. </span><span class="koboSpan" id="kobo.12.2" xmlns="http://www.w3.org/1999/xhtml">The foundation of the web is HTTP, which for more than 30 years has been great for building general-purpose websites and services. </span><span class="koboSpan" id="kobo.12.3" xmlns="http://www.w3.org/1999/xhtml">However, the web was not designed for specialized scenarios that require a web page to be instantaneously updated with new information as it becomes available. </span></p>
<h2 class="heading-2" id="_idParaDest-413"><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">The history of real-time communication on the web</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">To understand the benefits of SignalR, it helps to know the history of HTTP and how organizations worked to </span><a id="_idIndexMarker1141"/><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">make it better for real-time communication between clients and servers. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">In the early days of the Web in the 1990s, browsers had to make a full-page HTTP </span><code class="inlineCode"><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">GET</span></code><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml"> request to the web server to get fresh information to show to the visitor. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">In late 1999, Microsoft released Internet Explorer 5 with a component named </span><strong class="keyWord"><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">XMLHttpRequest</span></strong><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml"> that could </span><a id="_idIndexMarker1142"/><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">make asynchronous HTTP calls in the background. </span><span class="koboSpan" id="kobo.22.2" xmlns="http://www.w3.org/1999/xhtml">This, alongside </span><strong class="keyWord"><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">dynamic HTML</span></strong><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">DHTML</span></strong><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">), allowed</span><a id="_idIndexMarker1143"/><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml"> parts of the web page to be updated with fresh data smoothly.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">The benefits of this technique were obvious, and soon, all browsers added the same component.</span></p>
<h2 class="heading-2" id="_idParaDest-414"><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">AJAX</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">Google took maximum advantage of this capability to build clever web applications such as Google Maps and Gmail. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">A few years later, the technique became popularly known as </span><strong class="keyWord"><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">Asynchronous JavaScript and XML </span></strong><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">(</span><strong class="keyWord"><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">AJAX</span></strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">AJAX still uses HTTP to communicate, however, and that </span><a id="_idIndexMarker1144"/><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">has limitations:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">First, HTTP is a request-response communication protocol, meaning that the server cannot push data to the client. </span><span class="koboSpan" id="kobo.37.2" xmlns="http://www.w3.org/1999/xhtml">It must wait for the client to make a request. </span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">Second, HTTP request and response messages have headers with lots of potentially unnecessary overhead. </span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-415"><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">WebSocket</span></h2>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">WebSocket</span></strong><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml"> is full-duplex, meaning </span><a id="_idIndexMarker1145"/><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">that either the client or server can initiate communicating new data. </span><span class="koboSpan" id="kobo.42.2" xmlns="http://www.w3.org/1999/xhtml">WebSocket uses the same TCP connection for the life cycle of the connection. </span><span class="koboSpan" id="kobo.42.3" xmlns="http://www.w3.org/1999/xhtml">It is also more efficient in the message sizes that it sends because they are minimally framed with 2 bytes.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">WebSocket works over HTTP ports </span><code class="inlineCode"><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">80</span></code><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">443</span></code><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml"> so it is compatible with the HTTP protocol, and the WebSocket handshake uses the HTTP </span><strong class="screenText"><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">Upgrade</span></strong><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml"> header to switch from the HTTP protocol to the WebSocket protocol.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">Modern web apps are expected to deliver up-to-date information. </span><span class="koboSpan" id="kobo.50.2" xmlns="http://www.w3.org/1999/xhtml">Live chat is the canonical example, but there are lots of potential applications, from stock prices to games.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">Whenever you need the server to push updates to the web page, you need a web-compatible, real-time </span><a id="_idIndexMarker1146"/><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">communication technology. </span><span class="koboSpan" id="kobo.52.2" xmlns="http://www.w3.org/1999/xhtml">WebSocket could be used, but it is not supported by all clients. </span><span class="koboSpan" id="kobo.52.3" xmlns="http://www.w3.org/1999/xhtml">You can check which clients support WebSocket using the</span><a id="_idIndexMarker1147"/><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"> web page found at the following link: </span><a href="https://caniuse.com/websockets"><span class="url"><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">https://caniuse.com/websockets</span></span></a><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">WebSocket or WebSockets? </span><span class="koboSpan" id="kobo.56.2" xmlns="http://www.w3.org/1999/xhtml">“The </span><strong class="keyWord"><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">WebSocket</span></strong><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml"> protocol was standardized by the IETF as RFC 6455 in 2011. </span><span class="koboSpan" id="kobo.58.2" xmlns="http://www.w3.org/1999/xhtml">The</span><a id="_idIndexMarker1148"/><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml"> current API specification allowing web applications to use this protocol is known as </span><em class="italic"><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">WebSockets</span></em><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">.” </span><span class="koboSpan" id="kobo.61.2" xmlns="http://www.w3.org/1999/xhtml">From the Wikipedia page found at the following link: </span><a href="https://en.wikipedia.org/wiki/WebSocket"><span class="url"><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">https://en.wikipedia.org/wiki/WebSocket</span></span></a><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-416"><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">Introducing SignalR</span></h2>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core SignalR</span></strong><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml"> is an open-source</span><a id="_idIndexMarker1149"/><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml"> library that simplifies adding real-time web functionality to apps by being an abstraction over multiple underlying communication technologies, which allows you to add real-time communication capabilities using C# code.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">The developer does not need to understand or implement the underlying technology used, and SignalR will automatically switch between underlying technologies depending on what the visitor’s web browser supports. </span><span class="koboSpan" id="kobo.68.2" xmlns="http://www.w3.org/1999/xhtml">For example, SignalR will use WebSocket when it’s available and gracefully falls back on other technologies such as AJAX long polling when it isn’t, while your application code stays the same.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">SignalR is an API for </span><a id="_idIndexMarker1150"/><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">server-to-client </span><strong class="keyWord"><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">remote procedure calls</span></strong><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">RPCs</span></strong><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.74.2" xmlns="http://www.w3.org/1999/xhtml">The RPCs call JavaScript functions on clients from server-side .NET code. </span><span class="koboSpan" id="kobo.74.3" xmlns="http://www.w3.org/1999/xhtml">SignalR has hubs to define the pipeline and handles the message dispatching automatically using two built-in hub protocols: JSON and a binary one based on MessagePack.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">On the server side, SignalR runs everywhere that ASP.NET Core runs: Windows, macOS, or Linux servers. </span><span class="koboSpan" id="kobo.75.2" xmlns="http://www.w3.org/1999/xhtml">SignalR supports the following client platforms:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">JavaScript </span><a id="_idIndexMarker1151"/><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">clients for current browsers including Chrome, Firefox, Safari, and Edge.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">.NET clients including Blazor, .NET MAUI, and Xamarin for Android and iOS mobile apps.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">Java 8 and later.</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-417"><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">Azure SignalR Service</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">Earlier, I mentioned that it would be good practice to separate the SignalR service hosting project from the web project that uses the JavaScript library to act as a client. </span><span class="koboSpan" id="kobo.81.2" xmlns="http://www.w3.org/1999/xhtml">This is because a SignalR service potentially needs to handle lots of simultaneous client requests and respond quickly to them all.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">Once you separate the</span><a id="_idIndexMarker1152"/><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml"> SignalR hosting, you can take advantage of </span><strong class="keyWord"><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">Azure SignalR Service</span></strong><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.85.2" xmlns="http://www.w3.org/1999/xhtml">This offers global reach and a world-class data center and network, and it scales to millions of connections while meeting SLAs like providing compliance and high security.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">You can learn more about Azure SignalR Service at the following link: </span><a href="https://learn.microsoft.com/en-us/azure/azure-signalr/signalr-overview"><span class="url"><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">https://learn.microsoft.com/en-us/azure/azure-signalr/signalr-overview</span></span></a><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-418"><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">Designing method signatures</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">When designing the method signatures for a SignalR service, it is good practice to define methods with a</span><a id="_idIndexMarker1153"/><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"> single message parameter rather than multiple simple type parameters. </span><span class="koboSpan" id="kobo.91.2" xmlns="http://www.w3.org/1999/xhtml">This good practice is not enforced by the technology with SignalR, so you will have to be disciplined.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">For example, instead of passing multiple </span><code class="inlineCode"><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml"> (or other type) values, define a type with multiple properties to use as the single </span><code class="inlineCode"><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">Message</span></code><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml"> parameter, as shown in the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">// Bad practice: RPC method with multiple parameters.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml"> to, </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"> body</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">// Good practice: single parameter using a complex type.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"> Message</span></span><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"> To { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">; }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml"> Body { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">void</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">Message message</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">The reason for this good practice is that it allows future changes like adding a third property for the message </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">Title</span></code><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.134.2" xmlns="http://www.w3.org/1999/xhtml">For the bad practice example, a third </span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml"> parameter named </span><code class="inlineCode"><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">title</span></code><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml"> would need to be added and existing clients would get errors because they are not sending the extra </span><code class="inlineCode"><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"> value. </span><span class="koboSpan" id="kobo.140.2" xmlns="http://www.w3.org/1999/xhtml">But using the good practice example will not break the method signature so existing clients can continue to call it as before the change. </span><span class="koboSpan" id="kobo.140.3" xmlns="http://www.w3.org/1999/xhtml">On the server side, the extra </span><code class="inlineCode"><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">Title</span></code><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"> property will just have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">null</span></code><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml"> value that can be checked for, and </span><a id="_idIndexMarker1154"/><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">perhaps be set to a default value. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">SignalR method parameters are serialized as JSON, so all nested objects are accessible in JavaScript if needed.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">Now that we’ve explored the fundamentals of SignalR and its various aspects like good practices for method signature design, let’s walk through how to build a live communication service using SignalR.</span></p>
<h1 class="heading-1" id="_idParaDest-419"><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">Building a live communication service using SignalR</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">The SignalR </span><em class="italic"><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">server</span></em><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml"> library is included in ASP.NET Core, but the JavaScript </span><em class="italic"><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">client</span></em><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"> library is not automatically included in the </span><a id="_idIndexMarker1155"/><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">project. </span><span class="koboSpan" id="kobo.154.2" xmlns="http://www.w3.org/1999/xhtml">Remember, SignalR supports multiple client types, and a web page using JavaScript is just one of them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">We will use the </span><strong class="keyWord"><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">Library Manager CLI</span></strong><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml"> to get the client</span><a id="_idIndexMarker1156"/><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml"> library from </span><strong class="keyWord"><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">unpkg</span></strong><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">, a </span><strong class="keyWord"><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml">content delivery network</span></strong><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml">CDN</span></strong><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">) that can deliver anything found in the Node.js</span><a id="_idIndexMarker1157"/><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"> package manager.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">Let’s add a SignalR server-side</span><a id="_idIndexMarker1158"/><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml"> hub and client-side JavaScript to </span><a id="_idIndexMarker1159"/><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">an ASP.NET Core MVC project to implement a chat feature that allows visitors to send messages to:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">Everyone currently using the website.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">Dynamically defined groups.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">A single specified user.</span></li>
</ul>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Good Practice</span></strong><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">: In a production solution, it would be better to host the SignalR hub in a separate web project so that it can be hosted and scaled independently from the rest of the website. </span><span class="koboSpan" id="kobo.173.2" xmlns="http://www.w3.org/1999/xhtml">Live communication can often put excessive load on a</span><a id="_idIndexMarker1160"/><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml"> website.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-420"><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">Defining some shared models</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">First, we will define two</span><a id="_idIndexMarker1161"/><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml"> shared models that can be used on both the server-side and client-side .NET projects that will work with our chat service:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to create a new project, as defined in the following list:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">Class Library</span></strong><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml">classlib</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml">Chapter11</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml"> project, rename the </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">Class1.cs</span></code><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml"> file to </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">UserModel.cs</span></code><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">Modify its contents to define a model for registering a user’s name, unique connection ID, and the groups that they belong to, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Chat.Models</span></span><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">UserModel</span></span><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml"> Name { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml"> ConnectionId { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.222.2" xmlns="http://www.w3.org/1999/xhtml">Groups { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">; } </span><span class="hljs-comment"><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">// comma-separated list</span></span><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml">
}
</span></code></pre>
<div class="packt_tip">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">Good Practice</span></strong><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml">: In a real-world app, you would want to use a collection of </span><code class="inlineCode"><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml"> values for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">Groups</span></code><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"> property, but this coding task is not about how to provide a web user experience for editing multiple </span><code class="inlineCode"><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml"> values. </span><span class="koboSpan" id="kobo.236.2" xmlns="http://www.w3.org/1999/xhtml">We will provide a simple text box instead and focus on learning SignalR.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">MessageModel.cs</span></code><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.241.2" xmlns="http://www.w3.org/1999/xhtml">Modify its contents to define a message model with properties for whom the message is </span><a id="_idIndexMarker1162"/><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">sent to and who the message was sent from, and the message body, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Chat.Models</span></span><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">MessageModel</span></span><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml"> From { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"> To { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">; } = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">!;
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.270.2" xmlns="http://www.w3.org/1999/xhtml">Body { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">get</span></span><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">set</span></span><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">; }
}
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-421"><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">Enabling a server-side SignalR hub</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">Next, we will enable a SignalR</span><a id="_idIndexMarker1163"/><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"> hub on the server side in an ASP.NET Core MVC project:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to</span><a id="_idIndexMarker1164"/><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml"> add a new project, as defined in the following list:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">ASP.NET Core Web App (Model-View-Controller)</span></strong><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">mvc</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">Chapter11</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">Authentication type: None.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">Configure for HTTPS: Selected.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">Enable Docker: Cleared.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">Do not use top-level statements: Cleared.</span></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml"> project, treat warnings as errors and add a project reference to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"> project, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;ProjectReference
    Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">"..\Northwind.Common\Northwind.Common.csproj"</span></span><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">Properties</span></code><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"> folder, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">launchSettings.json</span></code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml"> profile, modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">applicationUrl</span></code><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> to use port </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">5111</span></code><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">5112</span></code><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">http</span></code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">, as shown highlighted in the following configuration:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-attr"><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">https</span></strong></span><span class="hljs-attr"><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">"commandName"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">"Project"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">"dotnetRunMessages"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml">"launchBrowser"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml">,</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">"applicationUrl"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">:</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5111;http://localhost:5112"</span></strong><strong class="hljs-punctuation-slc"><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">,</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">"environmentVariables"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">"ASPNETCORE_ENVIRONMENT"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">:</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">"Development"</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">ChatHub.cs</span></code><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">. </span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">ChatHub.cs</span></code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">, modify</span><a id="_idIndexMarker1165"/><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"> its contents to inherit from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">Hub</span></code><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml"> class and implement</span><a id="_idIndexMarker1166"/><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml"> two methods that can be called by a client, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.AspNetCore.SignalR; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">// To use Hub.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.Chat.Models; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">// To use UserModel, MessageModel.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Hubs</span></span><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">ChatHub</span></span><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml"> : </span><span class="hljs-title"><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">Hub</span></span><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">// A new instance of ChatHub is created to process each method so we</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">// must store user names, connection IDs, and groups in a static field.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">private</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">static</span></span><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml"> Dictionary&lt;</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">, UserModel&gt; Users = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">Register</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">UserModel newUser</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    UserModel user;
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml"> action = </span><span class="hljs-string"><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">registered as a new user"</span></span><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">;
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">// Try to get a stored user with a match on new user.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml"> (Users.ContainsKey(newUser.Name))
    {
      user = Users[newUser.Name];
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml">// Remove any existing group registrations.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml"> (user.Groups </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">)
      {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">group</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml"> user.Groups.Split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">','</span></span><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">))
        {
          </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml"> Groups.RemoveFromGroupAsync(user.ConnectionId, </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">group</span></span><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">);
        }
      }
      user.Groups = newUser.Groups;
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">// Connection ID might have changed if the browser </span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">// refreshed so update it.</span></span><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">
      user.ConnectionId = Context.ConnectionId;
      action = </span><span class="hljs-string"><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">"updated your registered user"</span></span><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml">;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">else</span></span><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">
    {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">.IsNullOrEmpty(newUser.Name))
      {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">// Assign a GUID for name if they are anonymous.</span></span><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">
        newUser.Name = Guid.NewGuid().ToString();
      }
      newUser.ConnectionId = Context.ConnectionId;
      Users.Add(key: newUser.Name, </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">: newUser);
      user = newUser;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"> (user.Groups </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">is</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml">not</span></span> <span class="hljs-literal"><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">null</span></span><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">)
    {
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">// A user does not have to belong to any groups</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">// but if they do, register them with the Hub.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">group</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml"> user.Groups.Split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">','</span></span><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">))
      {
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml"> Groups.AddToGroupAsync(user.ConnectionId, </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">group</span></span><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">);
      }
    }
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">// Send a message to the registering user informing of success.</span></span><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">
    MessageModel message = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">() 
    { 
      From = </span><span class="hljs-string"><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">"SignalR Hub"</span></span><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">, To = user.Name, 
      Body = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">.Format(
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">You have successfully {0} with connection ID {1}."</span></span><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">,
        arg0: action, arg1: user.ConnectionId)
    };
    IClientProxy proxy = Clients.Client(user.ConnectionId);
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml"> proxy.SendAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">"ReceiveMessage"</span></span><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">, message);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">MessageModel message</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    IClientProxy proxy;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">.IsNullOrEmpty(message.To))
    {
      message.To = </span><span class="hljs-string"><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">"Everyone"</span></span><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">;
      proxy = Clients.All;
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml"> proxy.SendAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">"ReceiveMessage"</span></span><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml">, message);
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">;
    }
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml">// Split To into a list of user and group names.</span></span>
<span class="hljs-built_in"><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml">[] userAndGroupList = message.To.Split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">','</span></span><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml">);
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">// Each item could be a user or group name.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml"> userOrGroup </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"> userAndGroupList)
    {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml"> (Users.ContainsKey(userOrGroup))
      {
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml">// If the item is in Users then send the message to that user</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml">// by looking up their connection ID in the dictionary.</span></span><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">
        message.To = </span><span class="hljs-string"><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">$"User: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">{Users[userOrGroup].Name}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">;
        proxy = Clients.Client(Users[userOrGroup].ConnectionId);
      }
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">else</span></span> <span class="hljs-comment"><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml">// Assume the item is a group name to send the message to.</span></span><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml">
      {
        message.To = </span><span class="hljs-string"><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">$"Group: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">{userOrGroup}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">;
        proxy = Clients.Group(userOrGroup);
      }
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml"> proxy.SendAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml">"ReceiveMessage"</span></span><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">, message);
    }
  }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">Note the following:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">ChatHub</span></code><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml"> has a private field to store a list of registered users. </span><span class="koboSpan" id="kobo.520.2" xmlns="http://www.w3.org/1999/xhtml">It is a dictionary with their name as a unique key.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml">ChatHub</span></code><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml"> has two methods that a client can call: </span><code class="inlineCode"><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml">Register</span></code><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></code><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">Register</span></code><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml"> has a single parameter of type </span><code class="inlineCode"><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml">UserModel</span></code><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.530.2" xmlns="http://www.w3.org/1999/xhtml">The user’s name, connection ID, and groups are stored in the static dictionary so that the user’s name</span><a id="_idIndexMarker1167"/><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml"> can be used to look up the connection ID later and send messages directly to that one user. </span><span class="koboSpan" id="kobo.531.2" xmlns="http://www.w3.org/1999/xhtml">After registering a new user or updating the registration of an existing user, a message is sent back to the client informing them of success.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></code><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml"> has a single parameter of type </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">MessageModel</span></code><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.535.2" xmlns="http://www.w3.org/1999/xhtml">The method branches based on the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">To</span></code><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml"> property. </span><span class="koboSpan" id="kobo.537.2" xmlns="http://www.w3.org/1999/xhtml">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml">To</span></code><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"> does not have a value, it calls the </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml">All</span></code><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml"> property to get a proxy that will communicate with every client. </span><span class="koboSpan" id="kobo.541.2" xmlns="http://www.w3.org/1999/xhtml">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml">To</span></code><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml"> has a value, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"> is split using comma separators into an array. </span><span class="koboSpan" id="kobo.545.2" xmlns="http://www.w3.org/1999/xhtml">Each item in the array is checked to see if it matches a user in </span><code class="inlineCode"><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml">Users</span></code><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.547.2" xmlns="http://www.w3.org/1999/xhtml">If it matches, it calls</span><a id="_idIndexMarker1168"/><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">Client</span></code><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml"> method to get a proxy that will communicate just with that one client. </span><span class="koboSpan" id="kobo.550.2" xmlns="http://www.w3.org/1999/xhtml">If it does not match, the item might be a group, so it calls the </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">Group</span></code><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml"> method to get a proxy that will communicate with just the members of that group. </span><span class="koboSpan" id="kobo.552.2" xmlns="http://www.w3.org/1999/xhtml">Finally, it sends the message asynchronously using the proxy.</span></li>
</ul></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">, import the namespace for your SignalR hub, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.SignalR.Service.Hubs; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml">// To use ChatHub.</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">In the section that configures services, add a statement to add support for SignalR to the services collection, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">builder.Services.AddSignalR();
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml">In the section that configures the HTTP pipeline, before the call to map controller </span><a id="_idIndexMarker1169"/><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">routes, add a statement to map the relative URL path </span><code class="inlineCode"><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml">/chat</span></code><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml"> to</span><a id="_idIndexMarker1170"/><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml"> your SignalR hub, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">app.MapHub&lt;ChatHub&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml">"/chat"</span></span><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">);
</span></code></pre>
</li>
</ol>
<h1 class="heading-1" id="_idParaDest-422"><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">Building a web client using the SignalR JavaScript library</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml">Next, we will add the</span><a id="_idIndexMarker1171"/><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml"> SignalR client-side JavaScript library so that </span><a id="_idIndexMarker1172"/><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">we can use it on a web page:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">Open a command prompt or terminal for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml"> project/folder.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">Install the Library Manager CLI tool, as shown in the following command:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml">dotnet tool install -g Microsoft.Web.LibraryManager.Cli
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">This tool might already be installed globally. </span><span class="koboSpan" id="kobo.578.2" xmlns="http://www.w3.org/1999/xhtml">To update it to the latest version, repeat the command but replace </span><code class="inlineCode"><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml">install</span></code><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">update</span></code><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">Enter a command to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">signalr.js</span></code><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml">signalr.min.js</span></code><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml"> libraries to the project from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml">unpkg</span></code><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml"> source, as shown in the following command:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">libman install @microsoft/signalr@latest -p unpkg -d wwwroot/js/signalr --files dist/browser/signalr.js --files dist/browser/signalr.min.js
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">Never copy long commands from a PDF and paste them directly to the command prompt. </span><span class="koboSpan" id="kobo.591.2" xmlns="http://www.w3.org/1999/xhtml">Always clean them up in a basic text editor to remove extraneous new lines and so on and then recopy them. </span><span class="koboSpan" id="kobo.591.3" xmlns="http://www.w3.org/1999/xhtml">To make it easier to enter long command lines, you can copy them from the following link: </span><a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/command-lines.md"><span class="url"><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">https://github.com/markjprice/apps-services-net8/blob/main/docs/command-lines.md</span></span></a></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">Note the success message, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">wwwroot/js/signalr/dist/browser/signalr.js written to disk
wwwroot/js/signalr/dist/browser/signalr.min.js written to disk
Installed library "@microsoft/signalr@latest" to "wwwroot/js/signalr"
</span></code></pre>
</li>
</ol>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">Visual Studio 2022 also has a GUI for adding client-side JavaScript libraries. </span><span class="koboSpan" id="kobo.595.2" xmlns="http://www.w3.org/1999/xhtml">To use it, right-click a web </span><a id="_idIndexMarker1173"/><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">project and then navigate to </span><strong class="screenText"><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml">Add</span></strong><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml"> | </span><strong class="screenText"><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml">Client Side Libraries</span></strong><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-423"><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml">Adding a chat page to the MVC website</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">Next, we will add </span><a id="_idIndexMarker1174"/><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">chat functionality to</span><a id="_idIndexMarker1175"/><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml"> the home page:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">Views/Home</span></code><span class="koboSpan" id="kobo.607.1" xmlns="http://www.w3.org/1999/xhtml">, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.608.1" xmlns="http://www.w3.org/1999/xhtml">Index.cshtml</span></code><span class="koboSpan" id="kobo.609.1" xmlns="http://www.w3.org/1999/xhtml">, modify its contents, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.610.1" xmlns="http://www.w3.org/1999/xhtml">@using Northwind.Chat.Models
@{
  ViewData["Title"] = "SignalR Chat";
}
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.611.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.612.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.613.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.614.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.615.1" xmlns="http://www.w3.org/1999/xhtml">"container"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.616.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.617.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.618.1" xmlns="http://www.w3.org/1999/xhtml">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.619.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.620.1" xmlns="http://www.w3.org/1999/xhtml">@ViewData["Title"]</span><span class="hljs-tag"><span class="koboSpan" id="kobo.621.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.622.1" xmlns="http://www.w3.org/1999/xhtml">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.623.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.624.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.625.1" xmlns="http://www.w3.org/1999/xhtml">hr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.626.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.627.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.628.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.629.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.630.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.631.1" xmlns="http://www.w3.org/1999/xhtml">"row"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.632.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.633.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.634.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.635.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.636.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.637.1" xmlns="http://www.w3.org/1999/xhtml">"col"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.638.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.639.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.640.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.641.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.642.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span><span class="hljs-tag"><span class="koboSpan" id="kobo.643.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.644.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.645.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.646.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.647.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.648.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.649.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.650.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.651.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.652.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.653.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.654.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.655.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.656.1" xmlns="http://www.w3.org/1999/xhtml">"myName"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.657.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.658.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.659.1" xmlns="http://www.w3.org/1999/xhtml">"form-label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.660.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.661.1" xmlns="http://www.w3.org/1999/xhtml">My name</span><span class="hljs-tag"><span class="koboSpan" id="kobo.662.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.663.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.664.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.665.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.666.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.667.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.668.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.669.1" xmlns="http://www.w3.org/1999/xhtml">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.670.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.671.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.672.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.673.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.674.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.675.1" xmlns="http://www.w3.org/1999/xhtml">"myName"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.676.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.677.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.678.1" xmlns="http://www.w3.org/1999/xhtml">"Alice"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.679.1" xmlns="http://www.w3.org/1999/xhtml">required</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.680.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.681.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.682.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.683.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.684.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.685.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.686.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.687.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.688.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.689.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.690.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.691.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.692.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.693.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.694.1" xmlns="http://www.w3.org/1999/xhtml">"myGroups"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.695.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.696.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.697.1" xmlns="http://www.w3.org/1999/xhtml">"form-label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.698.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.699.1" xmlns="http://www.w3.org/1999/xhtml">My groups</span><span class="hljs-tag"><span class="koboSpan" id="kobo.700.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.701.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.702.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.703.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.704.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.705.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.706.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.707.1" xmlns="http://www.w3.org/1999/xhtml">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.708.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.709.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.710.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.711.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.712.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.713.1" xmlns="http://www.w3.org/1999/xhtml">"myGroups"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.714.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.715.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.716.1" xmlns="http://www.w3.org/1999/xhtml">"Sales,IT"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.717.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.718.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.719.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.720.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.721.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.722.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.723.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.724.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.725.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.726.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.727.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.728.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.729.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.730.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.731.1" xmlns="http://www.w3.org/1999/xhtml">"button"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.732.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.733.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.734.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.735.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.736.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.737.1" xmlns="http://www.w3.org/1999/xhtml">"registerButton"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.738.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.739.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.740.1" xmlns="http://www.w3.org/1999/xhtml">"Register User"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.741.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.742.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.743.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.744.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.745.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.746.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.747.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.748.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.749.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.750.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.751.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.752.1" xmlns="http://www.w3.org/1999/xhtml">"col"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.753.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.754.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.755.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.756.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.757.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span><span class="hljs-tag"><span class="koboSpan" id="kobo.758.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.759.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.760.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.761.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.762.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.763.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.764.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.765.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.766.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.767.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.768.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.769.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.770.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.771.1" xmlns="http://www.w3.org/1999/xhtml">"from"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.772.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.773.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.774.1" xmlns="http://www.w3.org/1999/xhtml">"form-label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.775.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.776.1" xmlns="http://www.w3.org/1999/xhtml">From</span><span class="hljs-tag"><span class="koboSpan" id="kobo.777.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.778.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.779.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.780.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.781.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.782.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.783.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.784.1" xmlns="http://www.w3.org/1999/xhtml">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.785.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.786.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.787.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.788.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.789.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.790.1" xmlns="http://www.w3.org/1999/xhtml">"from"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.791.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.792.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.793.1" xmlns="http://www.w3.org/1999/xhtml">"Alice"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.794.1" xmlns="http://www.w3.org/1999/xhtml">readonly</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.795.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.796.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.797.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.798.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.799.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.800.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.801.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.802.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.803.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.804.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.805.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.806.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.807.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.808.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.809.1" xmlns="http://www.w3.org/1999/xhtml">"to"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.810.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.811.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.812.1" xmlns="http://www.w3.org/1999/xhtml">"form-label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.813.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.814.1" xmlns="http://www.w3.org/1999/xhtml">To</span><span class="hljs-tag"><span class="koboSpan" id="kobo.815.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.816.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.817.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.818.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.819.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.820.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.821.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.822.1" xmlns="http://www.w3.org/1999/xhtml">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.823.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.824.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.825.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.826.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.827.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.828.1" xmlns="http://www.w3.org/1999/xhtml">"to"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.829.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.830.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.831.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.832.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.833.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.834.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.835.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.836.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.837.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.838.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.839.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.840.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.841.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.842.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.843.1" xmlns="http://www.w3.org/1999/xhtml">"body"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.844.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.845.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.846.1" xmlns="http://www.w3.org/1999/xhtml">"form-label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.847.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.848.1" xmlns="http://www.w3.org/1999/xhtml">Body</span><span class="hljs-tag"><span class="koboSpan" id="kobo.849.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.850.1" xmlns="http://www.w3.org/1999/xhtml">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.851.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.852.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.853.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.854.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.855.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.856.1" xmlns="http://www.w3.org/1999/xhtml">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.857.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.858.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.859.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.860.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.861.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.862.1" xmlns="http://www.w3.org/1999/xhtml">"body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.863.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.864.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.865.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.866.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.867.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.868.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.869.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.870.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.871.1" xmlns="http://www.w3.org/1999/xhtml">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.872.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.873.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.874.1" xmlns="http://www.w3.org/1999/xhtml">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.875.1" xmlns="http://www.w3.org/1999/xhtml">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.876.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.877.1" xmlns="http://www.w3.org/1999/xhtml">"button"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.878.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.879.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.880.1" xmlns="http://www.w3.org/1999/xhtml">"form-control"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.881.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.882.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.883.1" xmlns="http://www.w3.org/1999/xhtml">"sendButton"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.884.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.885.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.886.1" xmlns="http://www.w3.org/1999/xhtml">"Send Message"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.887.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.888.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.889.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.890.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.891.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.892.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.893.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.894.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.895.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.896.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.897.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.898.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.899.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.900.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.901.1" xmlns="http://www.w3.org/1999/xhtml">"row"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.902.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.903.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.904.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.905.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.906.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.907.1" xmlns="http://www.w3.org/1999/xhtml">"col"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.908.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.909.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.910.1" xmlns="http://www.w3.org/1999/xhtml">hr</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.911.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.912.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.913.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.914.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span><span class="koboSpan" id="kobo.915.1" xmlns="http://www.w3.org/1999/xhtml">Messages received</span><span class="hljs-tag"><span class="koboSpan" id="kobo.916.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.917.1" xmlns="http://www.w3.org/1999/xhtml">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.918.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.919.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.920.1" xmlns="http://www.w3.org/1999/xhtml">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.921.1" xmlns="http://www.w3.org/1999/xhtml">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.922.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.923.1" xmlns="http://www.w3.org/1999/xhtml">"messages"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.924.1" xmlns="http://www.w3.org/1999/xhtml">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.925.1" xmlns="http://www.w3.org/1999/xhtml">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.926.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.927.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.928.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.929.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.930.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.931.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.932.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.933.1" xmlns="http://www.w3.org/1999/xhtml">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.934.1" xmlns="http://www.w3.org/1999/xhtml">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.935.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.936.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.937.1" xmlns="http://www.w3.org/1999/xhtml">script</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.938.1" xmlns="http://www.w3.org/1999/xhtml">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.939.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.940.1" xmlns="http://www.w3.org/1999/xhtml">"~/js/signalr/dist/browser/signalr.js"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.941.1" xmlns="http://www.w3.org/1999/xhtml">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.942.1" xmlns="http://www.w3.org/1999/xhtml">script</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.943.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.944.1" xmlns="http://www.w3.org/1999/xhtml">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.945.1" xmlns="http://www.w3.org/1999/xhtml">script</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.946.1" xmlns="http://www.w3.org/1999/xhtml">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.947.1" xmlns="http://www.w3.org/1999/xhtml">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.948.1" xmlns="http://www.w3.org/1999/xhtml">"~/js/chat.js"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.949.1" xmlns="http://www.w3.org/1999/xhtml">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.950.1" xmlns="http://www.w3.org/1999/xhtml">script</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.951.1" xmlns="http://www.w3.org/1999/xhtml">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.952.1" xmlns="http://www.w3.org/1999/xhtml">Note the following:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.953.1" xmlns="http://www.w3.org/1999/xhtml">There are </span><a id="_idIndexMarker1176"/><span class="koboSpan" id="kobo.954.1" xmlns="http://www.w3.org/1999/xhtml">three sections on the page: </span><strong class="screenText"><span class="koboSpan" id="kobo.955.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.956.1" xmlns="http://www.w3.org/1999/xhtml">, </span><strong class="screenText"><span class="koboSpan" id="kobo.957.1" xmlns="http://www.w3.org/1999/xhtml">Send</span></strong> <strong class="screenText"><span class="koboSpan" id="kobo.958.1" xmlns="http://www.w3.org/1999/xhtml">Message</span></strong><span class="koboSpan" id="kobo.959.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><strong class="screenText"><span class="koboSpan" id="kobo.960.1" xmlns="http://www.w3.org/1999/xhtml">Messages received</span></strong><span class="koboSpan" id="kobo.961.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.962.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong class="screenText"><span class="koboSpan" id="kobo.963.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.964.1" xmlns="http://www.w3.org/1999/xhtml"> section has two inputs for the visitor’s name, a comma-separated list of the groups that they want to be a member of, and a</span><a id="_idIndexMarker1177"/><span class="koboSpan" id="kobo.965.1" xmlns="http://www.w3.org/1999/xhtml"> button to click to register.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.966.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong class="screenText"><span class="koboSpan" id="kobo.967.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.968.1" xmlns="http://www.w3.org/1999/xhtml"> section has three inputs for the name of the user that the message is from, the names of users and groups that the message will be sent to, and the body of the message – and a button to click to send the message. </span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.969.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong class="screenText"><span class="koboSpan" id="kobo.970.1" xmlns="http://www.w3.org/1999/xhtml">Messages received</span></strong><span class="koboSpan" id="kobo.971.1" xmlns="http://www.w3.org/1999/xhtml"> section has a bullet list element that will be dynamically populated with a list item when a message is received.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.972.1" xmlns="http://www.w3.org/1999/xhtml">There are two script elements for the SignalR JavaScript client-side library and the</span><a id="_idIndexMarker1178"/><span class="koboSpan" id="kobo.973.1" xmlns="http://www.w3.org/1999/xhtml"> JavaScript implementation of the chat client.</span></li>
</ul></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.974.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.975.1" xmlns="http://www.w3.org/1999/xhtml">wwwroot/js</span></code><span class="koboSpan" id="kobo.976.1" xmlns="http://www.w3.org/1999/xhtml">, add a new JavaScript file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.977.1" xmlns="http://www.w3.org/1999/xhtml">chat.js</span></code><span class="koboSpan" id="kobo.978.1" xmlns="http://www.w3.org/1999/xhtml"> and modify its contents, as shown</span><a id="_idIndexMarker1179"/><span class="koboSpan" id="kobo.979.1" xmlns="http://www.w3.org/1999/xhtml"> in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.980.1" xmlns="http://www.w3.org/1999/xhtml">"use strict"</span></span><span class="koboSpan" id="kobo.981.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.982.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.983.1" xmlns="http://www.w3.org/1999/xhtml"> connection = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.984.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.985.1" xmlns="http://www.w3.org/1999/xhtml"> signalR.</span><span class="hljs-title"><span class="koboSpan" id="kobo.986.1" xmlns="http://www.w3.org/1999/xhtml">HubConnectionBuilder</span></span><span class="koboSpan" id="kobo.987.1" xmlns="http://www.w3.org/1999/xhtml">()
  .</span><span class="hljs-title"><span class="koboSpan" id="kobo.988.1" xmlns="http://www.w3.org/1999/xhtml">withUrl</span></span><span class="koboSpan" id="kobo.989.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.990.1" xmlns="http://www.w3.org/1999/xhtml">"/chat"</span></span><span class="koboSpan" id="kobo.991.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.992.1" xmlns="http://www.w3.org/1999/xhtml">build</span></span><span class="koboSpan" id="kobo.993.1" xmlns="http://www.w3.org/1999/xhtml">();
</span><span class="hljs-variable"><span class="koboSpan" id="kobo.994.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.995.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.996.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.997.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.998.1" xmlns="http://www.w3.org/1999/xhtml">"registerButton"</span></span><span class="koboSpan" id="kobo.999.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1000.1" xmlns="http://www.w3.org/1999/xhtml">disabled</span></span><span class="koboSpan" id="kobo.1001.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1002.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="koboSpan" id="kobo.1003.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-variable"><span class="koboSpan" id="kobo.1004.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1005.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1006.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1007.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1008.1" xmlns="http://www.w3.org/1999/xhtml">"sendButton"</span></span><span class="koboSpan" id="kobo.1009.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1010.1" xmlns="http://www.w3.org/1999/xhtml">disabled</span></span><span class="koboSpan" id="kobo.1011.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1012.1" xmlns="http://www.w3.org/1999/xhtml">true</span></span><span class="koboSpan" id="kobo.1013.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-variable"><span class="koboSpan" id="kobo.1014.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1015.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1016.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1017.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1018.1" xmlns="http://www.w3.org/1999/xhtml">"myName"</span></span><span class="koboSpan" id="kobo.1019.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1020.1" xmlns="http://www.w3.org/1999/xhtml">addEventListener</span></span><span class="koboSpan" id="kobo.1021.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1022.1" xmlns="http://www.w3.org/1999/xhtml">"input"</span></span><span class="koboSpan" id="kobo.1023.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1024.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1025.1" xmlns="http://www.w3.org/1999/xhtml"> () {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1026.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1027.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1028.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1029.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1030.1" xmlns="http://www.w3.org/1999/xhtml">"from"</span></span><span class="koboSpan" id="kobo.1031.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1032.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1033.1" xmlns="http://www.w3.org/1999/xhtml"> = 
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1034.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1035.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1036.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1037.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1038.1" xmlns="http://www.w3.org/1999/xhtml">"myName"</span></span><span class="koboSpan" id="kobo.1039.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1040.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1041.1" xmlns="http://www.w3.org/1999/xhtml">;
  }
);
connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1042.1" xmlns="http://www.w3.org/1999/xhtml">start</span></span><span class="koboSpan" id="kobo.1043.1" xmlns="http://www.w3.org/1999/xhtml">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.1044.1" xmlns="http://www.w3.org/1999/xhtml">then</span></span><span class="koboSpan" id="kobo.1045.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1046.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1047.1" xmlns="http://www.w3.org/1999/xhtml"> () {
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1048.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1049.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1050.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1051.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1052.1" xmlns="http://www.w3.org/1999/xhtml">"registerButton"</span></span><span class="koboSpan" id="kobo.1053.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1054.1" xmlns="http://www.w3.org/1999/xhtml">disabled</span></span><span class="koboSpan" id="kobo.1055.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1056.1" xmlns="http://www.w3.org/1999/xhtml">false</span></span><span class="koboSpan" id="kobo.1057.1" xmlns="http://www.w3.org/1999/xhtml">;
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1058.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1059.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1060.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1061.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1062.1" xmlns="http://www.w3.org/1999/xhtml">"sendButton"</span></span><span class="koboSpan" id="kobo.1063.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1064.1" xmlns="http://www.w3.org/1999/xhtml">disabled</span></span><span class="koboSpan" id="kobo.1065.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1066.1" xmlns="http://www.w3.org/1999/xhtml">false</span></span><span class="koboSpan" id="kobo.1067.1" xmlns="http://www.w3.org/1999/xhtml">;
}).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1068.1" xmlns="http://www.w3.org/1999/xhtml">catch</span></span><span class="koboSpan" id="kobo.1069.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1070.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1071.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1072.1" xmlns="http://www.w3.org/1999/xhtml">err</span></span><span class="koboSpan" id="kobo.1073.1" xmlns="http://www.w3.org/1999/xhtml">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1074.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.1075.1" xmlns="http://www.w3.org/1999/xhtml">console</span></span><span class="koboSpan" id="kobo.1076.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1077.1" xmlns="http://www.w3.org/1999/xhtml">error</span></span><span class="koboSpan" id="kobo.1078.1" xmlns="http://www.w3.org/1999/xhtml">(err.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1079.1" xmlns="http://www.w3.org/1999/xhtml">toString</span></span><span class="koboSpan" id="kobo.1080.1" xmlns="http://www.w3.org/1999/xhtml">());
});
connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1081.1" xmlns="http://www.w3.org/1999/xhtml">on</span></span><span class="koboSpan" id="kobo.1082.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1083.1" xmlns="http://www.w3.org/1999/xhtml">"ReceiveMessage"</span></span><span class="koboSpan" id="kobo.1084.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1085.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1086.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1087.1" xmlns="http://www.w3.org/1999/xhtml">received</span></span><span class="koboSpan" id="kobo.1088.1" xmlns="http://www.w3.org/1999/xhtml">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1089.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.1090.1" xmlns="http://www.w3.org/1999/xhtml"> li = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1091.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1092.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1093.1" xmlns="http://www.w3.org/1999/xhtml">createElement</span></span><span class="koboSpan" id="kobo.1094.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1095.1" xmlns="http://www.w3.org/1999/xhtml">"li"</span></span><span class="koboSpan" id="kobo.1096.1" xmlns="http://www.w3.org/1999/xhtml">);
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1097.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1098.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1099.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1100.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1101.1" xmlns="http://www.w3.org/1999/xhtml">"messages"</span></span><span class="koboSpan" id="kobo.1102.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1103.1" xmlns="http://www.w3.org/1999/xhtml">appendChild</span></span><span class="koboSpan" id="kobo.1104.1" xmlns="http://www.w3.org/1999/xhtml">(li);
  li.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1105.1" xmlns="http://www.w3.org/1999/xhtml">textContent</span></span><span class="koboSpan" id="kobo.1106.1" xmlns="http://www.w3.org/1999/xhtml"> =
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1107.1" xmlns="http://www.w3.org/1999/xhtml">// This string must use backticks ` to enable an interpolated </span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1108.1" xmlns="http://www.w3.org/1999/xhtml">// string. </span><span class="koboSpan" id="kobo.1108.2" xmlns="http://www.w3.org/1999/xhtml">If you use single quotes ' then it will not work!</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1109.1" xmlns="http://www.w3.org/1999/xhtml">`To </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1110.1" xmlns="http://www.w3.org/1999/xhtml">${received.to}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1111.1" xmlns="http://www.w3.org/1999/xhtml">, From </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1112.1" xmlns="http://www.w3.org/1999/xhtml">${received.</span></span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1113.1" xmlns="http://www.w3.org/1999/xhtml">from</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1114.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1115.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1116.1" xmlns="http://www.w3.org/1999/xhtml">${received.body}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1117.1" xmlns="http://www.w3.org/1999/xhtml">`</span></span><span class="koboSpan" id="kobo.1118.1" xmlns="http://www.w3.org/1999/xhtml">;
});
</span><span class="hljs-variable"><span class="koboSpan" id="kobo.1119.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1120.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1121.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1122.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1123.1" xmlns="http://www.w3.org/1999/xhtml">"registerButton"</span></span><span class="koboSpan" id="kobo.1124.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1125.1" xmlns="http://www.w3.org/1999/xhtml">addEventListener</span></span><span class="koboSpan" id="kobo.1126.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1127.1" xmlns="http://www.w3.org/1999/xhtml">"click"</span></span><span class="koboSpan" id="kobo.1128.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1129.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1130.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1131.1" xmlns="http://www.w3.org/1999/xhtml">event</span></span><span class="koboSpan" id="kobo.1132.1" xmlns="http://www.w3.org/1999/xhtml">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1133.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.1134.1" xmlns="http://www.w3.org/1999/xhtml"> registermodel = {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1135.1" xmlns="http://www.w3.org/1999/xhtml">name</span></span><span class="koboSpan" id="kobo.1136.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1137.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1138.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1139.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1140.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1141.1" xmlns="http://www.w3.org/1999/xhtml">"myName"</span></span><span class="koboSpan" id="kobo.1142.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1143.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1144.1" xmlns="http://www.w3.org/1999/xhtml">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1145.1" xmlns="http://www.w3.org/1999/xhtml">groups</span></span><span class="koboSpan" id="kobo.1146.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1147.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1148.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1149.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1150.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1151.1" xmlns="http://www.w3.org/1999/xhtml">"myGroups"</span></span><span class="koboSpan" id="kobo.1152.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1153.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1154.1" xmlns="http://www.w3.org/1999/xhtml">
    };
    connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1155.1" xmlns="http://www.w3.org/1999/xhtml">invoke</span></span><span class="koboSpan" id="kobo.1156.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1157.1" xmlns="http://www.w3.org/1999/xhtml">"Register"</span></span><span class="koboSpan" id="kobo.1158.1" xmlns="http://www.w3.org/1999/xhtml">, registermodel).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1159.1" xmlns="http://www.w3.org/1999/xhtml">catch</span></span><span class="koboSpan" id="kobo.1160.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1161.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1162.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1163.1" xmlns="http://www.w3.org/1999/xhtml">err</span></span><span class="koboSpan" id="kobo.1164.1" xmlns="http://www.w3.org/1999/xhtml">) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1165.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.1166.1" xmlns="http://www.w3.org/1999/xhtml">console</span></span><span class="koboSpan" id="kobo.1167.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1168.1" xmlns="http://www.w3.org/1999/xhtml">error</span></span><span class="koboSpan" id="kobo.1169.1" xmlns="http://www.w3.org/1999/xhtml">(err.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1170.1" xmlns="http://www.w3.org/1999/xhtml">toString</span></span><span class="koboSpan" id="kobo.1171.1" xmlns="http://www.w3.org/1999/xhtml">());
    });
    event.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1172.1" xmlns="http://www.w3.org/1999/xhtml">preventDefault</span></span><span class="koboSpan" id="kobo.1173.1" xmlns="http://www.w3.org/1999/xhtml">();
  });
</span><span class="hljs-variable"><span class="koboSpan" id="kobo.1174.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1175.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1176.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1177.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1178.1" xmlns="http://www.w3.org/1999/xhtml">"sendButton"</span></span><span class="koboSpan" id="kobo.1179.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1180.1" xmlns="http://www.w3.org/1999/xhtml">addEventListener</span></span><span class="koboSpan" id="kobo.1181.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1182.1" xmlns="http://www.w3.org/1999/xhtml">"click"</span></span><span class="koboSpan" id="kobo.1183.1" xmlns="http://www.w3.org/1999/xhtml">,
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1184.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1185.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1186.1" xmlns="http://www.w3.org/1999/xhtml">event</span></span><span class="koboSpan" id="kobo.1187.1" xmlns="http://www.w3.org/1999/xhtml">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1188.1" xmlns="http://www.w3.org/1999/xhtml">var</span></span><span class="koboSpan" id="kobo.1189.1" xmlns="http://www.w3.org/1999/xhtml"> messagemodel = {
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1190.1" xmlns="http://www.w3.org/1999/xhtml">from</span></span><span class="koboSpan" id="kobo.1191.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1192.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1193.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1194.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1195.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1196.1" xmlns="http://www.w3.org/1999/xhtml">"from"</span></span><span class="koboSpan" id="kobo.1197.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1198.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1199.1" xmlns="http://www.w3.org/1999/xhtml">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1200.1" xmlns="http://www.w3.org/1999/xhtml">to</span></span><span class="koboSpan" id="kobo.1201.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1202.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1203.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1204.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1205.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1206.1" xmlns="http://www.w3.org/1999/xhtml">"to"</span></span><span class="koboSpan" id="kobo.1207.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1208.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1209.1" xmlns="http://www.w3.org/1999/xhtml">,
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1210.1" xmlns="http://www.w3.org/1999/xhtml">body</span></span><span class="koboSpan" id="kobo.1211.1" xmlns="http://www.w3.org/1999/xhtml">: </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1212.1" xmlns="http://www.w3.org/1999/xhtml">document</span></span><span class="koboSpan" id="kobo.1213.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1214.1" xmlns="http://www.w3.org/1999/xhtml">getElementById</span></span><span class="koboSpan" id="kobo.1215.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1216.1" xmlns="http://www.w3.org/1999/xhtml">"body"</span></span><span class="koboSpan" id="kobo.1217.1" xmlns="http://www.w3.org/1999/xhtml">).</span><span class="hljs-property"><span class="koboSpan" id="kobo.1218.1" xmlns="http://www.w3.org/1999/xhtml">value</span></span><span class="koboSpan" id="kobo.1219.1" xmlns="http://www.w3.org/1999/xhtml">
    };
    connection.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1220.1" xmlns="http://www.w3.org/1999/xhtml">invoke</span></span><span class="koboSpan" id="kobo.1221.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1222.1" xmlns="http://www.w3.org/1999/xhtml">"SendMessage"</span></span><span class="koboSpan" id="kobo.1223.1" xmlns="http://www.w3.org/1999/xhtml">, messagemodel).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1224.1" xmlns="http://www.w3.org/1999/xhtml">catch</span></span><span class="koboSpan" id="kobo.1225.1" xmlns="http://www.w3.org/1999/xhtml">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1226.1" xmlns="http://www.w3.org/1999/xhtml">function</span></span><span class="koboSpan" id="kobo.1227.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-params"><span class="koboSpan" id="kobo.1228.1" xmlns="http://www.w3.org/1999/xhtml">err</span></span><span class="koboSpan" id="kobo.1229.1" xmlns="http://www.w3.org/1999/xhtml">) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1230.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.1231.1" xmlns="http://www.w3.org/1999/xhtml">console</span></span><span class="koboSpan" id="kobo.1232.1" xmlns="http://www.w3.org/1999/xhtml">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1233.1" xmlns="http://www.w3.org/1999/xhtml">error</span></span><span class="koboSpan" id="kobo.1234.1" xmlns="http://www.w3.org/1999/xhtml">(err.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1235.1" xmlns="http://www.w3.org/1999/xhtml">toString</span></span><span class="koboSpan" id="kobo.1236.1" xmlns="http://www.w3.org/1999/xhtml">());
    });
    event.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1237.1" xmlns="http://www.w3.org/1999/xhtml">preventDefault</span></span><span class="koboSpan" id="kobo.1238.1" xmlns="http://www.w3.org/1999/xhtml">();
});
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1239.1" xmlns="http://www.w3.org/1999/xhtml">Note the</span><a id="_idIndexMarker1180"/><span class="koboSpan" id="kobo.1240.1" xmlns="http://www.w3.org/1999/xhtml"> following:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1241.1" xmlns="http://www.w3.org/1999/xhtml">The script creates a SignalR hub connection builder specifying the relative URL path to the chat hub on the server </span><code class="inlineCode"><span class="koboSpan" id="kobo.1242.1" xmlns="http://www.w3.org/1999/xhtml">/chat</span></code><span class="koboSpan" id="kobo.1243.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1244.1" xmlns="http://www.w3.org/1999/xhtml">The script </span><a id="_idIndexMarker1181"/><span class="koboSpan" id="kobo.1245.1" xmlns="http://www.w3.org/1999/xhtml">disables the </span><strong class="screenText"><span class="koboSpan" id="kobo.1246.1" xmlns="http://www.w3.org/1999/xhtml">Register</span></strong><span class="koboSpan" id="kobo.1247.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><strong class="screenText"><span class="koboSpan" id="kobo.1248.1" xmlns="http://www.w3.org/1999/xhtml">Send</span></strong><span class="koboSpan" id="kobo.1249.1" xmlns="http://www.w3.org/1999/xhtml"> buttons until the connection is successfully established to the server-side hub.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1250.1" xmlns="http://www.w3.org/1999/xhtml">An </span><code class="inlineCode"><span class="koboSpan" id="kobo.1251.1" xmlns="http://www.w3.org/1999/xhtml">input</span></code><span class="koboSpan" id="kobo.1252.1" xmlns="http://www.w3.org/1999/xhtml"> event handler is added to the </span><strong class="screenText"><span class="koboSpan" id="kobo.1253.1" xmlns="http://www.w3.org/1999/xhtml">My name</span></strong><span class="koboSpan" id="kobo.1254.1" xmlns="http://www.w3.org/1999/xhtml"> text box to keep it synchronized with the </span><strong class="screenText"><span class="koboSpan" id="kobo.1255.1" xmlns="http://www.w3.org/1999/xhtml">From</span></strong><span class="koboSpan" id="kobo.1256.1" xmlns="http://www.w3.org/1999/xhtml"> text box.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1257.1" xmlns="http://www.w3.org/1999/xhtml">When the connection gets a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1258.1" xmlns="http://www.w3.org/1999/xhtml">ReceiveMessage</span></code><span class="koboSpan" id="kobo.1259.1" xmlns="http://www.w3.org/1999/xhtml"> call from the server-side hub, it adds a list item element to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1260.1" xmlns="http://www.w3.org/1999/xhtml">messages</span></code><span class="koboSpan" id="kobo.1261.1" xmlns="http://www.w3.org/1999/xhtml"> bullet list. </span><span class="koboSpan" id="kobo.1261.2" xmlns="http://www.w3.org/1999/xhtml">The content of the list item contains details of the message like </span><code class="inlineCode"><span class="koboSpan" id="kobo.1262.1" xmlns="http://www.w3.org/1999/xhtml">from</span></code><span class="koboSpan" id="kobo.1263.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1264.1" xmlns="http://www.w3.org/1999/xhtml">to</span></code><span class="koboSpan" id="kobo.1265.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1266.1" xmlns="http://www.w3.org/1999/xhtml">body</span></code><span class="koboSpan" id="kobo.1267.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1267.2" xmlns="http://www.w3.org/1999/xhtml">For the two models that we defined in C#, note that JavaScript uses</span><a id="_idIndexMarker1182"/><span class="koboSpan" id="kobo.1268.1" xmlns="http://www.w3.org/1999/xhtml"> camelCase compared to C#, which uses PascalCase. </span></li>
</ul>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1269.1" xmlns="http://www.w3.org/1999/xhtml">The message is formatted using a JavaScript interpolated </span><code class="inlineCode"><span class="koboSpan" id="kobo.1270.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.1271.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.1271.2" xmlns="http://www.w3.org/1999/xhtml">This feature requires backticks </span><code class="inlineCode"><span class="koboSpan" id="kobo.1272.1" xmlns="http://www.w3.org/1999/xhtml">`</span></code><span class="koboSpan" id="kobo.1273.1" xmlns="http://www.w3.org/1999/xhtml"> at the start and end of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1274.1" xmlns="http://www.w3.org/1999/xhtml">string</span></code><span class="koboSpan" id="kobo.1275.1" xmlns="http://www.w3.org/1999/xhtml"> value and the use of curly brackets </span><code class="inlineCode"><span class="koboSpan" id="kobo.1276.1" xmlns="http://www.w3.org/1999/xhtml">${}</span></code><span class="koboSpan" id="kobo.1277.1" xmlns="http://www.w3.org/1999/xhtml"> for dynamic placeholders.</span></p>
</div>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1278.1" xmlns="http://www.w3.org/1999/xhtml">A </span><code class="inlineCode"><span class="koboSpan" id="kobo.1279.1" xmlns="http://www.w3.org/1999/xhtml">click</span></code><span class="koboSpan" id="kobo.1280.1" xmlns="http://www.w3.org/1999/xhtml"> event handler is added to the </span><strong class="screenText"><span class="koboSpan" id="kobo.1281.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.1282.1" xmlns="http://www.w3.org/1999/xhtml"> button that creates a </span><a id="_idIndexMarker1183"/><span class="koboSpan" id="kobo.1283.1" xmlns="http://www.w3.org/1999/xhtml">register model with the user’s name and their groups and then invokes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1284.1" xmlns="http://www.w3.org/1999/xhtml">Register</span></code><span class="koboSpan" id="kobo.1285.1" xmlns="http://www.w3.org/1999/xhtml"> method on the server side.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1286.1" xmlns="http://www.w3.org/1999/xhtml">A </span><code class="inlineCode"><span class="koboSpan" id="kobo.1287.1" xmlns="http://www.w3.org/1999/xhtml">click</span></code><span class="koboSpan" id="kobo.1288.1" xmlns="http://www.w3.org/1999/xhtml"> event handler is added to the </span><strong class="screenText"><span class="koboSpan" id="kobo.1289.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1290.1" xmlns="http://www.w3.org/1999/xhtml"> button that creates a message model with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1291.1" xmlns="http://www.w3.org/1999/xhtml">from</span></code><span class="koboSpan" id="kobo.1292.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1293.1" xmlns="http://www.w3.org/1999/xhtml">to</span></code><span class="koboSpan" id="kobo.1294.1" xmlns="http://www.w3.org/1999/xhtml">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1295.1" xmlns="http://www.w3.org/1999/xhtml">body</span></code><span class="koboSpan" id="kobo.1296.1" xmlns="http://www.w3.org/1999/xhtml">, and then invokes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1297.1" xmlns="http://www.w3.org/1999/xhtml">SendMessage</span></code><span class="koboSpan" id="kobo.1298.1" xmlns="http://www.w3.org/1999/xhtml"> method on the server side.</span></li>
</ul></li>
</ol>
<h2 class="heading-2" id="_idParaDest-424"><span class="koboSpan" id="kobo.1299.1" xmlns="http://www.w3.org/1999/xhtml">Testing the chat feature</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1300.1" xmlns="http://www.w3.org/1999/xhtml">Now we are ready to</span><a id="_idIndexMarker1184"/><span class="koboSpan" id="kobo.1301.1" xmlns="http://www.w3.org/1999/xhtml"> try sending chat messages between multiple website visitors:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1302.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1303.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1304.1" xmlns="http://www.w3.org/1999/xhtml"> project website using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1305.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1306.1" xmlns="http://www.w3.org/1999/xhtml"> profile:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1307.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio 2022, then select the </span><strong class="screenText"><span class="koboSpan" id="kobo.1308.1" xmlns="http://www.w3.org/1999/xhtml">https</span></strong><span class="koboSpan" id="kobo.1309.1" xmlns="http://www.w3.org/1999/xhtml"> profile in the toolbar, and then start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1310.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1311.1" xmlns="http://www.w3.org/1999/xhtml"> project without debugging.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1312.1" xmlns="http://www.w3.org/1999/xhtml">If you are using Visual Studio Code, then at the command prompt or terminal, enter the following command:
            </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1313.1" xmlns="http://www.w3.org/1999/xhtml">dotnet run --launch-profile https
</span></code></pre>
</li>
<li class="bulletList"><span class="koboSpan" id="kobo.1314.1" xmlns="http://www.w3.org/1999/xhtml">On Windows, if Windows Defender Firewall blocks access, then click </span><strong class="screenText"><span class="koboSpan" id="kobo.1315.1" xmlns="http://www.w3.org/1999/xhtml">Allow access</span></strong><span class="koboSpan" id="kobo.1316.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1317.1" xmlns="http://www.w3.org/1999/xhtml">Start Chrome and navigate to </span><code class="codeHighlighted" style="font-weight: bold;"><span class="koboSpan" id="kobo.1318.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost:5111/</span></code><span class="koboSpan" id="kobo.1319.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1320.1" xmlns="http://www.w3.org/1999/xhtml">Note that </span><code class="inlineCode"><span class="koboSpan" id="kobo.1321.1" xmlns="http://www.w3.org/1999/xhtml">Alice</span></code><span class="koboSpan" id="kobo.1322.1" xmlns="http://www.w3.org/1999/xhtml"> is already entered for the name, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1323.1" xmlns="http://www.w3.org/1999/xhtml">Sales,IT</span></code><span class="koboSpan" id="kobo.1324.1" xmlns="http://www.w3.org/1999/xhtml"> is already entered for her groups. </span><span class="koboSpan" id="kobo.1324.2" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1325.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.1326.1" xmlns="http://www.w3.org/1999/xhtml">, and note the response back from the </span><strong class="screenText"><span class="koboSpan" id="kobo.1327.1" xmlns="http://www.w3.org/1999/xhtml">SignalR Chat</span></strong><span class="koboSpan" id="kobo.1328.1" xmlns="http://www.w3.org/1999/xhtml">, as</span><a id="_idIndexMarker1185"/><span class="koboSpan" id="kobo.1329.1" xmlns="http://www.w3.org/1999/xhtml"> shown in </span><em class="italic"><span class="koboSpan" id="kobo.1330.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.1</span></em><span class="koboSpan" id="kobo.1331.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1332.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1333.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.1: Registering a new user in chat</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.1334.1" xmlns="http://www.w3.org/1999/xhtml">Open a new Chrome window or start another browser like Firefox or Edge.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1335.1" xmlns="http://www.w3.org/1999/xhtml">Navigate to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1336.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost:5111/</span></code><span class="koboSpan" id="kobo.1337.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1338.1" xmlns="http://www.w3.org/1999/xhtml">Enter </span><code class="inlineCode"><span class="koboSpan" id="kobo.1339.1" xmlns="http://www.w3.org/1999/xhtml">Bob</span></code><span class="koboSpan" id="kobo.1340.1" xmlns="http://www.w3.org/1999/xhtml"> for the name, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1341.1" xmlns="http://www.w3.org/1999/xhtml">Sales</span></code><span class="koboSpan" id="kobo.1342.1" xmlns="http://www.w3.org/1999/xhtml"> for his groups, and then click </span><strong class="screenText"><span class="koboSpan" id="kobo.1343.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.1344.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1345.1" xmlns="http://www.w3.org/1999/xhtml">Open a new Chrome window or start another browser like Firefox or Edge.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1346.1" xmlns="http://www.w3.org/1999/xhtml">Navigate to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1347.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost:5111/</span></code><span class="koboSpan" id="kobo.1348.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1349.1" xmlns="http://www.w3.org/1999/xhtml">Enter </span><code class="inlineCode"><span class="koboSpan" id="kobo.1350.1" xmlns="http://www.w3.org/1999/xhtml">Charlie</span></code><span class="koboSpan" id="kobo.1351.1" xmlns="http://www.w3.org/1999/xhtml"> for the name, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1352.1" xmlns="http://www.w3.org/1999/xhtml">IT</span></code><span class="koboSpan" id="kobo.1353.1" xmlns="http://www.w3.org/1999/xhtml"> for his groups, and then click </span><strong class="screenText"><span class="koboSpan" id="kobo.1354.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.1355.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1356.1" xmlns="http://www.w3.org/1999/xhtml">Arrange the browser windows so that you can see all three simultaneously.
    </span><div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1357.1" xmlns="http://www.w3.org/1999/xhtml">A great tool for arranging windows is PowerToys and its FancyZones feature. </span><span class="koboSpan" id="kobo.1357.2" xmlns="http://www.w3.org/1999/xhtml">Learn more at the following link: </span><a href="https://learn.microsoft.com/en-us/windows/powertoys/"><span class="url"><span class="koboSpan" id="kobo.1358.1" xmlns="http://www.w3.org/1999/xhtml">https://learn.microsoft.com/en-us/windows/powertoys/</span></span></a><span class="koboSpan" id="kobo.1359.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="11"><span class="koboSpan" id="kobo.1360.1" xmlns="http://www.w3.org/1999/xhtml">In Alice’s browser, enter</span><a id="_idIndexMarker1186"/><span class="koboSpan" id="kobo.1361.1" xmlns="http://www.w3.org/1999/xhtml"> the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1362.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1363.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1364.1" xmlns="http://www.w3.org/1999/xhtml">Sales</span></code></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1365.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1366.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1367.1" xmlns="http://www.w3.org/1999/xhtml">Sell more!</span></code> </li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1368.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1369.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1370.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1371.1" xmlns="http://www.w3.org/1999/xhtml">Note that Alice and Bob receive the message, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1372.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.2</span></em><span class="koboSpan" id="kobo.1373.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1374.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1375.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.2: Alice sends a message to the Sales group</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="14"><span class="koboSpan" id="kobo.1376.1" xmlns="http://www.w3.org/1999/xhtml">In Bob’s browser, enter the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1377.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1378.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1379.1" xmlns="http://www.w3.org/1999/xhtml">IT</span></code></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1380.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1381.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1382.1" xmlns="http://www.w3.org/1999/xhtml">Fix more bugs!</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1383.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1384.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1385.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1386.1" xmlns="http://www.w3.org/1999/xhtml">Note that Alice and Charlie receive the message, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1387.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.3</span></em><span class="koboSpan" id="kobo.1388.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1389.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1390.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.3: Bob sends a message to the IT group</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="17"><span class="koboSpan" id="kobo.1391.1" xmlns="http://www.w3.org/1999/xhtml">In Alice’s browser, enter </span><a id="_idIndexMarker1187"/><span class="koboSpan" id="kobo.1392.1" xmlns="http://www.w3.org/1999/xhtml">the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1393.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1394.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1395.1" xmlns="http://www.w3.org/1999/xhtml">Bob</span></code></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1396.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1397.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1398.1" xmlns="http://www.w3.org/1999/xhtml">Bonjour Bob!</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1399.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1400.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1401.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1402.1" xmlns="http://www.w3.org/1999/xhtml">Note that only Bob receives the message.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1403.1" xmlns="http://www.w3.org/1999/xhtml">In Charlie’s browser, enter the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1404.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1405.1" xmlns="http://www.w3.org/1999/xhtml">: Leave it empty.</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1406.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1407.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1408.1" xmlns="http://www.w3.org/1999/xhtml">Everybody dance now!</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1409.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1410.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1411.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1412.1" xmlns="http://www.w3.org/1999/xhtml">Note that everyone receives the message, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1413.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.4</span></em><span class="koboSpan" id="kobo.1414.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1415.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1416.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.4: Charlie sends a message to everyone</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="23"><span class="koboSpan" id="kobo.1417.1" xmlns="http://www.w3.org/1999/xhtml">In Charlie’s browser, enter </span><a id="_idIndexMarker1188"/><span class="koboSpan" id="kobo.1418.1" xmlns="http://www.w3.org/1999/xhtml">the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1419.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1420.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1421.1" xmlns="http://www.w3.org/1999/xhtml">HR,Alice</span></code> </li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1422.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1423.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1424.1" xmlns="http://www.w3.org/1999/xhtml">Is anyone in HR listening?</span></code> </li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1425.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1426.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1427.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1428.1" xmlns="http://www.w3.org/1999/xhtml">Note that Alice receives the message sent directly to her, but since the HR group does not exist, no one receives the message sent to that group, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1429.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.5</span></em><span class="koboSpan" id="kobo.1430.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1431.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1432.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.5: Charlie sends a message to Alice and a group that does not exist</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="26"><span class="koboSpan" id="kobo.1433.1" xmlns="http://www.w3.org/1999/xhtml">Close the</span><a id="_idIndexMarker1189"/><span class="koboSpan" id="kobo.1434.1" xmlns="http://www.w3.org/1999/xhtml"> browsers and shut down the web server.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-425"><span class="koboSpan" id="kobo.1435.1" xmlns="http://www.w3.org/1999/xhtml">Building a .NET console app client</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1436.1" xmlns="http://www.w3.org/1999/xhtml">You have just </span><a id="_idIndexMarker1190"/><span class="koboSpan" id="kobo.1437.1" xmlns="http://www.w3.org/1999/xhtml">seen a .NET service hosting a SignalR hub, and a JavaScript client exchanging messages with other clients via that SignalR hub. </span><span class="koboSpan" id="kobo.1437.2" xmlns="http://www.w3.org/1999/xhtml">Now, let’s create a .NET client for SignalR. </span></p>
<h2 class="heading-2" id="_idParaDest-426"><span class="koboSpan" id="kobo.1438.1" xmlns="http://www.w3.org/1999/xhtml">Creating a .NET client for SignalR</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1439.1" xmlns="http://www.w3.org/1999/xhtml">We will use a console app, although any .NET project type would need the same package reference</span><a id="_idIndexMarker1191"/><span class="koboSpan" id="kobo.1440.1" xmlns="http://www.w3.org/1999/xhtml"> and implementation </span><a id="_idIndexMarker1192"/><span class="koboSpan" id="kobo.1441.1" xmlns="http://www.w3.org/1999/xhtml">code:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1442.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to add a new project, as defined in the following list:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1443.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.1444.1" xmlns="http://www.w3.org/1999/xhtml">Console Application </span></strong><span class="koboSpan" id="kobo.1445.1" xmlns="http://www.w3.org/1999/xhtml">/ </span><code class="inlineCode"><span class="koboSpan" id="kobo.1446.1" xmlns="http://www.w3.org/1999/xhtml">console</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1447.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1448.1" xmlns="http://www.w3.org/1999/xhtml">Chapter11</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1449.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1450.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1451.1" xmlns="http://www.w3.org/1999/xhtml">Add a package reference for the ASP.NET Core SignalR client and a project reference for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1452.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.1453.1" xmlns="http://www.w3.org/1999/xhtml">, treat warnings as errors, and globally and statically import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1454.1" xmlns="http://www.w3.org/1999/xhtml">System.Console</span></code><span class="koboSpan" id="kobo.1455.1" xmlns="http://www.w3.org/1999/xhtml"> class, as shown in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1456.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1457.1" xmlns="http://www.w3.org/1999/xhtml">"Microsoft.AspNetCore.SignalR.Client"</span></span><span class="koboSpan" id="kobo.1458.1" xmlns="http://www.w3.org/1999/xhtml"> 
                    Version=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1459.1" xmlns="http://www.w3.org/1999/xhtml">"8.0.0"</span></span><span class="koboSpan" id="kobo.1460.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
&lt;ItemGroup&gt;
  &lt;ProjectReference 
    Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1461.1" xmlns="http://www.w3.org/1999/xhtml">"..\Northwind.Common\Northwind.Common.csproj"</span></span><span class="koboSpan" id="kobo.1462.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1463.1" xmlns="http://www.w3.org/1999/xhtml">Build the project to restore</span><a id="_idIndexMarker1193"/><span class="koboSpan" id="kobo.1464.1" xmlns="http://www.w3.org/1999/xhtml"> packages and build referenced projects.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1465.1" xmlns="http://www.w3.org/1999/xhtml">In </span><code class="inlineCode"><span class="koboSpan" id="kobo.1466.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1467.1" xmlns="http://www.w3.org/1999/xhtml">, delete </span><a id="_idIndexMarker1194"/><span class="koboSpan" id="kobo.1468.1" xmlns="http://www.w3.org/1999/xhtml">the existing statements, import namespaces for working with SignalR as a client and the chat models, and then add statements to prompt the user to enter a username and groups to register with, create a hub connection, and finally, listen for received messages, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1469.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1470.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.AspNetCore.SignalR.Client; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1471.1" xmlns="http://www.w3.org/1999/xhtml">// To use HubConnection.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1472.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1473.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.Chat.Models; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1474.1" xmlns="http://www.w3.org/1999/xhtml">// To use UserModel, MessageModel.</span></span><span class="koboSpan" id="kobo.1475.1" xmlns="http://www.w3.org/1999/xhtml">
Write(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1476.1" xmlns="http://www.w3.org/1999/xhtml">"Enter a username (required): "</span></span><span class="koboSpan" id="kobo.1477.1" xmlns="http://www.w3.org/1999/xhtml">);
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1478.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1479.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.1479.2" xmlns="http://www.w3.org/1999/xhtml">username = ReadLine();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1480.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.1481.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1482.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1483.1" xmlns="http://www.w3.org/1999/xhtml">.IsNullOrEmpty(username))
{
  WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1484.1" xmlns="http://www.w3.org/1999/xhtml">"You must enter a username to register with chat!"</span></span><span class="koboSpan" id="kobo.1485.1" xmlns="http://www.w3.org/1999/xhtml">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1486.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.1487.1" xmlns="http://www.w3.org/1999/xhtml">;
}
Write(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1488.1" xmlns="http://www.w3.org/1999/xhtml">"Enter your groups (optional): "</span></span><span class="koboSpan" id="kobo.1489.1" xmlns="http://www.w3.org/1999/xhtml">);
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1490.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1491.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.1491.2" xmlns="http://www.w3.org/1999/xhtml">groups = ReadLine();
HubConnection hubConnection = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1492.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1493.1" xmlns="http://www.w3.org/1999/xhtml"> HubConnectionBuilder()
  .WithUrl(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1494.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5111/chat"</span></span><span class="koboSpan" id="kobo.1495.1" xmlns="http://www.w3.org/1999/xhtml">)
  .Build();
hubConnection.On&lt;MessageModel&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1496.1" xmlns="http://www.w3.org/1999/xhtml">"ReceiveMessage"</span></span><span class="koboSpan" id="kobo.1497.1" xmlns="http://www.w3.org/1999/xhtml">, message =&gt;
{
  WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1498.1" xmlns="http://www.w3.org/1999/xhtml">$"To </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1499.1" xmlns="http://www.w3.org/1999/xhtml">{message.To}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1500.1" xmlns="http://www.w3.org/1999/xhtml">, From </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1501.1" xmlns="http://www.w3.org/1999/xhtml">{message.From}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1502.1" xmlns="http://www.w3.org/1999/xhtml">: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1503.1" xmlns="http://www.w3.org/1999/xhtml">{message.Body}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1504.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.1505.1" xmlns="http://www.w3.org/1999/xhtml">);
});
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1506.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1507.1" xmlns="http://www.w3.org/1999/xhtml"> hubConnection.StartAsync();
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1508.1" xmlns="http://www.w3.org/1999/xhtml">"Successfully started."</span></span><span class="koboSpan" id="kobo.1509.1" xmlns="http://www.w3.org/1999/xhtml">);
UserModel registration = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1510.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1511.1" xmlns="http://www.w3.org/1999/xhtml">()
{
  Name = username,
  Groups = groups
};
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1512.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1513.1" xmlns="http://www.w3.org/1999/xhtml"> hubConnection.InvokeAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1514.1" xmlns="http://www.w3.org/1999/xhtml">"Register"</span></span><span class="koboSpan" id="kobo.1515.1" xmlns="http://www.w3.org/1999/xhtml">, registration);
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1516.1" xmlns="http://www.w3.org/1999/xhtml">"Successfully registered."</span></span><span class="koboSpan" id="kobo.1517.1" xmlns="http://www.w3.org/1999/xhtml">);
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1518.1" xmlns="http://www.w3.org/1999/xhtml">"Listening... </span><span class="koboSpan" id="kobo.1518.2" xmlns="http://www.w3.org/1999/xhtml">(press ENTER to stop.)"</span></span><span class="koboSpan" id="kobo.1519.1" xmlns="http://www.w3.org/1999/xhtml">);
ReadLine();
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-427"><span class="koboSpan" id="kobo.1520.1" xmlns="http://www.w3.org/1999/xhtml">Testing the .NET console app client</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1521.1" xmlns="http://www.w3.org/1999/xhtml">Let’s start the SignalR </span><a id="_idIndexMarker1195"/><span class="koboSpan" id="kobo.1522.1" xmlns="http://www.w3.org/1999/xhtml">service and call it from the console app:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1523.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1524.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1525.1" xmlns="http://www.w3.org/1999/xhtml"> project website using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1526.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1527.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1528.1" xmlns="http://www.w3.org/1999/xhtml">Start Chrome and navigate to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1529.1" xmlns="http://www.w3.org/1999/xhtml">https://localhost:5111/</span></code><span class="koboSpan" id="kobo.1530.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1531.1" xmlns="http://www.w3.org/1999/xhtml">Click </span><strong class="screenText"><span class="koboSpan" id="kobo.1532.1" xmlns="http://www.w3.org/1999/xhtml">Register User</span></strong><span class="koboSpan" id="kobo.1533.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1534.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1535.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console</span></code><span class="koboSpan" id="kobo.1536.1" xmlns="http://www.w3.org/1999/xhtml"> project.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1537.1" xmlns="http://www.w3.org/1999/xhtml">Enter your name and the groups: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1538.1" xmlns="http://www.w3.org/1999/xhtml">Sales,Admins</span></code><span class="koboSpan" id="kobo.1539.1" xmlns="http://www.w3.org/1999/xhtml">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1540.1" xmlns="http://www.w3.org/1999/xhtml">Arrange the browser and console app windows so that you can see both simultaneously.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1541.1" xmlns="http://www.w3.org/1999/xhtml">In Alice’s browser, enter the following:</span><ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1542.1" xmlns="http://www.w3.org/1999/xhtml">To</span></strong><span class="koboSpan" id="kobo.1543.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1544.1" xmlns="http://www.w3.org/1999/xhtml">Sales</span></code> </li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1545.1" xmlns="http://www.w3.org/1999/xhtml">Body</span></strong><span class="koboSpan" id="kobo.1546.1" xmlns="http://www.w3.org/1999/xhtml">: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1547.1" xmlns="http://www.w3.org/1999/xhtml">Go team!</span></code></li>
</ul>
</li>
<li class="numberedList"><strong class="screenText"><span class="koboSpan" id="kobo.1548.1" xmlns="http://www.w3.org/1999/xhtml">C</span></strong><span class="koboSpan" id="kobo.1549.1" xmlns="http://www.w3.org/1999/xhtml">lick </span><strong class="screenText"><span class="koboSpan" id="kobo.1550.1" xmlns="http://www.w3.org/1999/xhtml">Send Message</span></strong><span class="koboSpan" id="kobo.1551.1" xmlns="http://www.w3.org/1999/xhtml">, and note</span><a id="_idIndexMarker1196"/><span class="koboSpan" id="kobo.1552.1" xmlns="http://www.w3.org/1999/xhtml"> that Alice and you receive the message, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1553.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.6</span></em><span class="koboSpan" id="kobo.1554.1" xmlns="http://www.w3.org/1999/xhtml">:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1555.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="" src="../Images/B19587_11_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1556.1" xmlns="http://www.w3.org/1999/xhtml">Figure 11.6: Alice sends a message to the Sales team including a user in a console app</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.1557.1" xmlns="http://www.w3.org/1999/xhtml">In the console app, press </span><em class="italic"><span class="koboSpan" id="kobo.1558.1" xmlns="http://www.w3.org/1999/xhtml">Enter</span></em><span class="koboSpan" id="kobo.1559.1" xmlns="http://www.w3.org/1999/xhtml"> to stop it from listening.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1560.1" xmlns="http://www.w3.org/1999/xhtml">Close Chrome and shut down the web server.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-428"><span class="koboSpan" id="kobo.1561.1" xmlns="http://www.w3.org/1999/xhtml">Streaming data using SignalR</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1562.1" xmlns="http://www.w3.org/1999/xhtml">So far, we have seen how SignalR can broadcast structured messages to one or more clients. </span><span class="koboSpan" id="kobo.1562.2" xmlns="http://www.w3.org/1999/xhtml">This works well with data that is relatively small and structured and exists completely at a</span><a id="_idIndexMarker1197"/><span class="koboSpan" id="kobo.1563.1" xmlns="http://www.w3.org/1999/xhtml"> point in time. </span><span class="koboSpan" id="kobo.1563.2" xmlns="http://www.w3.org/1999/xhtml">But what about data that comes in parts over time? </span></p>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.1564.1" xmlns="http://www.w3.org/1999/xhtml">Streams</span></strong><span class="koboSpan" id="kobo.1565.1" xmlns="http://www.w3.org/1999/xhtml"> can be used for</span><a id="_idIndexMarker1198"/><span class="koboSpan" id="kobo.1566.1" xmlns="http://www.w3.org/1999/xhtml"> these scenarios. </span><span class="koboSpan" id="kobo.1566.2" xmlns="http://www.w3.org/1999/xhtml">SignalR supports</span><a id="_idIndexMarker1199"/><span class="koboSpan" id="kobo.1567.1" xmlns="http://www.w3.org/1999/xhtml"> both service-to-client (downloading data from a stream) and client-to-service (uploading data to a stream).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1568.1" xmlns="http://www.w3.org/1999/xhtml">To enable download streaming, a hub method must return </span><code class="inlineCode"><span class="koboSpan" id="kobo.1569.1" xmlns="http://www.w3.org/1999/xhtml">IAsyncEnumerable&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1570.1" xmlns="http://www.w3.org/1999/xhtml"> (only supported by C# 8 or later) or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1571.1" xmlns="http://www.w3.org/1999/xhtml">ChannelReader&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1572.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1573.1" xmlns="http://www.w3.org/1999/xhtml">To enable upload streaming, a hub method must accept a parameter of type </span><code class="inlineCode"><span class="koboSpan" id="kobo.1574.1" xmlns="http://www.w3.org/1999/xhtml">IAsyncEnumerable&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1575.1" xmlns="http://www.w3.org/1999/xhtml"> (only supported by C# 8 or later) or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1576.1" xmlns="http://www.w3.org/1999/xhtml">ChannelReader&lt;T&gt;</span></code><span class="koboSpan" id="kobo.1577.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<h2 class="heading-2" id="_idParaDest-429"><span class="koboSpan" id="kobo.1578.1" xmlns="http://www.w3.org/1999/xhtml">Defining a hub for streaming</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1579.1" xmlns="http://www.w3.org/1999/xhtml">Let’s add some streaming </span><a id="_idIndexMarker1200"/><span class="koboSpan" id="kobo.1580.1" xmlns="http://www.w3.org/1999/xhtml">methods to see how they work in </span><a id="_idIndexMarker1201"/><span class="koboSpan" id="kobo.1581.1" xmlns="http://www.w3.org/1999/xhtml">action:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1582.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1583.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.1584.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a new file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1585.1" xmlns="http://www.w3.org/1999/xhtml">StockPrice.cs</span></code><span class="koboSpan" id="kobo.1586.1" xmlns="http://www.w3.org/1999/xhtml"> and modify its content to define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1587.1" xmlns="http://www.w3.org/1999/xhtml">record</span></code><span class="koboSpan" id="kobo.1588.1" xmlns="http://www.w3.org/1999/xhtml"> for stock price data, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1589.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1590.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Streams</span></span><span class="koboSpan" id="kobo.1591.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1592.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1593.1" xmlns="http://www.w3.org/1999/xhtml">record</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1594.1" xmlns="http://www.w3.org/1999/xhtml">StockPrice</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1595.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1596.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1597.1" xmlns="http://www.w3.org/1999/xhtml"> Stock, </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1598.1" xmlns="http://www.w3.org/1999/xhtml">double</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1599.1" xmlns="http://www.w3.org/1999/xhtml"> Price</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1600.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1601.1" xmlns="http://www.w3.org/1999/xhtml">;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1602.1" xmlns="http://www.w3.org/1999/xhtml">Build the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1603.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1604.1" xmlns="http://www.w3.org/1999/xhtml"> project to update its referenced projects.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1605.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1606.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1607.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a new class named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1608.1" xmlns="http://www.w3.org/1999/xhtml">StockPriceHub.cs</span></code><span class="koboSpan" id="kobo.1609.1" xmlns="http://www.w3.org/1999/xhtml">, and modify its contents to define a hub with two streaming methods, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1610.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1611.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.AspNetCore.SignalR; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1612.1" xmlns="http://www.w3.org/1999/xhtml">// To use Hub.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1613.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1614.1" xmlns="http://www.w3.org/1999/xhtml"> System.Runtime.CompilerServices; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1615.1" xmlns="http://www.w3.org/1999/xhtml">// To use [EnumeratorCancellation].</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1616.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1617.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.SignalR.Streams; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1618.1" xmlns="http://www.w3.org/1999/xhtml">// To use StockPrice.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1619.1" xmlns="http://www.w3.org/1999/xhtml">namespace</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1620.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Hubs</span></span><span class="koboSpan" id="kobo.1621.1" xmlns="http://www.w3.org/1999/xhtml">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1622.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1623.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1624.1" xmlns="http://www.w3.org/1999/xhtml">StockPriceHub</span></span><span class="koboSpan" id="kobo.1625.1" xmlns="http://www.w3.org/1999/xhtml"> : </span><span class="hljs-title"><span class="koboSpan" id="kobo.1626.1" xmlns="http://www.w3.org/1999/xhtml">Hub</span></span><span class="koboSpan" id="kobo.1627.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1628.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1629.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1630.1" xmlns="http://www.w3.org/1999/xhtml"> IAsyncEnumerable&lt;StockPrice&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1631.1" xmlns="http://www.w3.org/1999/xhtml">GetStockPriceUpdates</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1632.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span>
<span class="hljs-params"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1633.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1634.1" xmlns="http://www.w3.org/1999/xhtml"> stock,</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.1635.1" xmlns="http://www.w3.org/1999/xhtml">    [EnumeratorCancellation] CancellationToken cancellationToken</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1636.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1637.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1638.1" xmlns="http://www.w3.org/1999/xhtml">double</span></span><span class="koboSpan" id="kobo.1639.1" xmlns="http://www.w3.org/1999/xhtml"> currentPrice = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1640.1" xmlns="http://www.w3.org/1999/xhtml">267.10</span></span><span class="koboSpan" id="kobo.1641.1" xmlns="http://www.w3.org/1999/xhtml">; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1642.1" xmlns="http://www.w3.org/1999/xhtml">// Simulated initial price.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1643.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="koboSpan" id="kobo.1644.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1645.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.1646.1" xmlns="http://www.w3.org/1999/xhtml"> i = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1647.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.1648.1" xmlns="http://www.w3.org/1999/xhtml">; i &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.1649.1" xmlns="http://www.w3.org/1999/xhtml">10</span></span><span class="koboSpan" id="kobo.1650.1" xmlns="http://www.w3.org/1999/xhtml">; i++)
    {
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1651.1" xmlns="http://www.w3.org/1999/xhtml">// Check the cancellation token regularly so that the server will stop</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1652.1" xmlns="http://www.w3.org/1999/xhtml">// producing items if the client disconnects.</span></span><span class="koboSpan" id="kobo.1653.1" xmlns="http://www.w3.org/1999/xhtml">
      cancellationToken.ThrowIfCancellationRequested();
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1654.1" xmlns="http://www.w3.org/1999/xhtml">// Increment or decrement the current price by a random amount.</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1655.1" xmlns="http://www.w3.org/1999/xhtml">// The compiler does not need the extra parentheses but it</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1656.1" xmlns="http://www.w3.org/1999/xhtml">// is clearer for humans if you put them in.</span></span><span class="koboSpan" id="kobo.1657.1" xmlns="http://www.w3.org/1999/xhtml">
      currentPrice += (Random.Shared.NextDouble() * </span><span class="hljs-number"><span class="koboSpan" id="kobo.1658.1" xmlns="http://www.w3.org/1999/xhtml">10.0</span></span><span class="koboSpan" id="kobo.1659.1" xmlns="http://www.w3.org/1999/xhtml">) - </span><span class="hljs-number"><span class="koboSpan" id="kobo.1660.1" xmlns="http://www.w3.org/1999/xhtml">5.0</span></span><span class="koboSpan" id="kobo.1661.1" xmlns="http://www.w3.org/1999/xhtml">;
      StockPrice stockPrice = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1662.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1663.1" xmlns="http://www.w3.org/1999/xhtml">(stock, currentPrice);
     Console.WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1664.1" xmlns="http://www.w3.org/1999/xhtml">"[{0}] {1} at {2:C}"</span></span><span class="koboSpan" id="kobo.1665.1" xmlns="http://www.w3.org/1999/xhtml">,
       DateTime.UtcNow, stockPrice.Stock, stockPrice.Price);
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1666.1" xmlns="http://www.w3.org/1999/xhtml">yield</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1667.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span><span class="koboSpan" id="kobo.1668.1" xmlns="http://www.w3.org/1999/xhtml"> stockPrice;
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1669.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1670.1" xmlns="http://www.w3.org/1999/xhtml"> Task.Delay(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1671.1" xmlns="http://www.w3.org/1999/xhtml">4000</span></span><span class="koboSpan" id="kobo.1672.1" xmlns="http://www.w3.org/1999/xhtml">, cancellationToken); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1673.1" xmlns="http://www.w3.org/1999/xhtml">// milliseconds</span></span><span class="koboSpan" id="kobo.1674.1" xmlns="http://www.w3.org/1999/xhtml">
    }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1675.1" xmlns="http://www.w3.org/1999/xhtml">public</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1676.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1677.1" xmlns="http://www.w3.org/1999/xhtml"> Task </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1678.1" xmlns="http://www.w3.org/1999/xhtml">UploadStocks</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1679.1" xmlns="http://www.w3.org/1999/xhtml">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1680.1" xmlns="http://www.w3.org/1999/xhtml">IAsyncEnumerable&lt;</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1681.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1682.1" xmlns="http://www.w3.org/1999/xhtml">&gt; stocks</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1683.1" xmlns="http://www.w3.org/1999/xhtml">)</span></span><span class="koboSpan" id="kobo.1684.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1685.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1686.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.1687.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1688.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1689.1" xmlns="http://www.w3.org/1999/xhtml"> stock </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1690.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.1691.1" xmlns="http://www.w3.org/1999/xhtml"> stocks)
    {
      Console.WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1692.1" xmlns="http://www.w3.org/1999/xhtml">$"Receiving </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1693.1" xmlns="http://www.w3.org/1999/xhtml">{stock}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1694.1" xmlns="http://www.w3.org/1999/xhtml"> from client..."</span></span><span class="koboSpan" id="kobo.1695.1" xmlns="http://www.w3.org/1999/xhtml">);
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1696.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1697.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1698.1" xmlns="http://www.w3.org/1999/xhtml"> project, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1699.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1700.1" xmlns="http://www.w3.org/1999/xhtml">, register the</span><a id="_idIndexMarker1202"/><span class="koboSpan" id="kobo.1701.1" xmlns="http://www.w3.org/1999/xhtml"> stock price hub after the statement that registers the chat hub, as shown in the</span><a id="_idIndexMarker1203"/><span class="koboSpan" id="kobo.1702.1" xmlns="http://www.w3.org/1999/xhtml"> following code:
        </span><pre class="programlisting code"><code class="hljs-code"><code class="codeHighlighted" style="font-weight: bold;"><span class="koboSpan" id="kobo.1703.1" xmlns="http://www.w3.org/1999/xhtml">app.MapHub&lt;StockPriceHub&gt;("/stockprice");</span></code>
</code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-430"><span class="koboSpan" id="kobo.1704.1" xmlns="http://www.w3.org/1999/xhtml">Creating a .NET console app client for streaming</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1705.1" xmlns="http://www.w3.org/1999/xhtml">Now, we can create a simple client to download a stream of data from the SignalR hub and upload a stream</span><a id="_idIndexMarker1204"/><span class="koboSpan" id="kobo.1706.1" xmlns="http://www.w3.org/1999/xhtml"> of data to the SignalR hub:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1707.1" xmlns="http://www.w3.org/1999/xhtml">Use your preferred code editor to add a new project, as defined in the following list:</span><ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1708.1" xmlns="http://www.w3.org/1999/xhtml">Project template: </span><strong class="screenText"><span class="koboSpan" id="kobo.1709.1" xmlns="http://www.w3.org/1999/xhtml">Console Application</span></strong><span class="koboSpan" id="kobo.1710.1" xmlns="http://www.w3.org/1999/xhtml"> / </span><code class="inlineCode"><span class="koboSpan" id="kobo.1711.1" xmlns="http://www.w3.org/1999/xhtml">console</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1712.1" xmlns="http://www.w3.org/1999/xhtml">Solution file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1713.1" xmlns="http://www.w3.org/1999/xhtml">Chapter11</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1714.1" xmlns="http://www.w3.org/1999/xhtml">Project file and folder: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1715.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console.Streams</span></code></li>
</ul>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1716.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1717.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console.Streams</span></code><span class="koboSpan" id="kobo.1718.1" xmlns="http://www.w3.org/1999/xhtml"> project file, treat warnings as errors, add a package reference for the ASP.NET Core SignalR client, add a project reference to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1719.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.Common</span></code><span class="koboSpan" id="kobo.1720.1" xmlns="http://www.w3.org/1999/xhtml">, and globally and statically import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1721.1" xmlns="http://www.w3.org/1999/xhtml">System.Console</span></code><span class="koboSpan" id="kobo.1722.1" xmlns="http://www.w3.org/1999/xhtml"> class, as shown highlighted in the following markup:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1723.1" xmlns="http://www.w3.org/1999/xhtml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1724.1" xmlns="http://www.w3.org/1999/xhtml">"Microsoft.AspNetCore.SignalR.Client"</span></span><span class="koboSpan" id="kobo.1725.1" xmlns="http://www.w3.org/1999/xhtml"> 
                    Version=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1726.1" xmlns="http://www.w3.org/1999/xhtml">"8.0.0"</span></span><span class="koboSpan" id="kobo.1727.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
&lt;ItemGroup&gt;
  &lt;ProjectReference 
    Include=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1728.1" xmlns="http://www.w3.org/1999/xhtml">"..\Northwind.Common\Northwind.Common.csproj"</span></span><span class="koboSpan" id="kobo.1729.1" xmlns="http://www.w3.org/1999/xhtml"> /&gt;
&lt;/ItemGroup&gt;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1730.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1731.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console.Streams</span></code><span class="koboSpan" id="kobo.1732.1" xmlns="http://www.w3.org/1999/xhtml"> project, add a new class file named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1733.1" xmlns="http://www.w3.org/1999/xhtml">Program.Methods.cs</span></code><span class="koboSpan" id="kobo.1734.1" xmlns="http://www.w3.org/1999/xhtml">, and modify its content to define static methods in the partial </span><code class="inlineCode"><span class="koboSpan" id="kobo.1735.1" xmlns="http://www.w3.org/1999/xhtml">Program</span></code><span class="koboSpan" id="kobo.1736.1" xmlns="http://www.w3.org/1999/xhtml"> class to generate ten random four-letter stock </span><a id="_idIndexMarker1205"/><span class="koboSpan" id="kobo.1737.1" xmlns="http://www.w3.org/1999/xhtml">codes asynchronously, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1738.1" xmlns="http://www.w3.org/1999/xhtml">// Defined in the empty default namespace to merge with the auto-</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.1739.1" xmlns="http://www.w3.org/1999/xhtml">// generated partial Program class.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1740.1" xmlns="http://www.w3.org/1999/xhtml">partial</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1741.1" xmlns="http://www.w3.org/1999/xhtml">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1742.1" xmlns="http://www.w3.org/1999/xhtml">Program</span></span><span class="koboSpan" id="kobo.1743.1" xmlns="http://www.w3.org/1999/xhtml">
{
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1744.1" xmlns="http://www.w3.org/1999/xhtml">static</span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1745.1" xmlns="http://www.w3.org/1999/xhtml">async</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1746.1" xmlns="http://www.w3.org/1999/xhtml"> IAsyncEnumerable&lt;</span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1747.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1748.1" xmlns="http://www.w3.org/1999/xhtml">&gt; </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1749.1" xmlns="http://www.w3.org/1999/xhtml">GetStocksAsync</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1750.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.1751.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1752.1" xmlns="http://www.w3.org/1999/xhtml">for</span></span><span class="koboSpan" id="kobo.1753.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1754.1" xmlns="http://www.w3.org/1999/xhtml">int</span></span><span class="koboSpan" id="kobo.1755.1" xmlns="http://www.w3.org/1999/xhtml"> i = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1756.1" xmlns="http://www.w3.org/1999/xhtml">0</span></span><span class="koboSpan" id="kobo.1757.1" xmlns="http://www.w3.org/1999/xhtml">; i &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.1758.1" xmlns="http://www.w3.org/1999/xhtml">10</span></span><span class="koboSpan" id="kobo.1759.1" xmlns="http://www.w3.org/1999/xhtml">; i++)
    {
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1760.1" xmlns="http://www.w3.org/1999/xhtml">// Return a random four-letter stock code.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1761.1" xmlns="http://www.w3.org/1999/xhtml">yield</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1762.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1763.1" xmlns="http://www.w3.org/1999/xhtml">$"</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1764.1" xmlns="http://www.w3.org/1999/xhtml">{AtoZ()}{AtoZ()}{AtoZ()}{AtoZ()}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1765.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.1766.1" xmlns="http://www.w3.org/1999/xhtml">;
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1767.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1768.1" xmlns="http://www.w3.org/1999/xhtml"> Task.Delay(TimeSpan.FromSeconds(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1769.1" xmlns="http://www.w3.org/1999/xhtml">3</span></span><span class="koboSpan" id="kobo.1770.1" xmlns="http://www.w3.org/1999/xhtml">));
    }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1771.1" xmlns="http://www.w3.org/1999/xhtml">static</span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1772.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="koboSpan" id="kobo.1773.1" xmlns="http://www.w3.org/1999/xhtml">AtoZ</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1774.1" xmlns="http://www.w3.org/1999/xhtml">()</span></span><span class="koboSpan" id="kobo.1775.1" xmlns="http://www.w3.org/1999/xhtml">
  {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1776.1" xmlns="http://www.w3.org/1999/xhtml">return</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1777.1" xmlns="http://www.w3.org/1999/xhtml">char</span></span><span class="koboSpan" id="kobo.1778.1" xmlns="http://www.w3.org/1999/xhtml">.ConvertFromUtf32(Random.Shared.Next(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1779.1" xmlns="http://www.w3.org/1999/xhtml">65</span></span><span class="koboSpan" id="kobo.1780.1" xmlns="http://www.w3.org/1999/xhtml">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1781.1" xmlns="http://www.w3.org/1999/xhtml">91</span></span><span class="koboSpan" id="kobo.1782.1" xmlns="http://www.w3.org/1999/xhtml">));
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1783.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1784.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console.Streams</span></code><span class="koboSpan" id="kobo.1785.1" xmlns="http://www.w3.org/1999/xhtml"> project, in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1786.1" xmlns="http://www.w3.org/1999/xhtml">Program.cs</span></code><span class="koboSpan" id="kobo.1787.1" xmlns="http://www.w3.org/1999/xhtml">, delete the existing statements. </span><span class="koboSpan" id="kobo.1787.2" xmlns="http://www.w3.org/1999/xhtml">Import namespaces for working with SignalR as a client, and then add statements to prompt the user to enter a stock, create a hub connection, listen for received streams of stock prices, and then send an asynchronous stream of stocks to the service, as shown in the following code:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1788.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1789.1" xmlns="http://www.w3.org/1999/xhtml"> Microsoft.AspNetCore.SignalR.Client; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1790.1" xmlns="http://www.w3.org/1999/xhtml">// To use HubConnection.</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1791.1" xmlns="http://www.w3.org/1999/xhtml">using</span></span><span class="koboSpan" id="kobo.1792.1" xmlns="http://www.w3.org/1999/xhtml"> Northwind.SignalR.Streams; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1793.1" xmlns="http://www.w3.org/1999/xhtml">// To use StockPrice.</span></span><span class="koboSpan" id="kobo.1794.1" xmlns="http://www.w3.org/1999/xhtml">
Write(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1795.1" xmlns="http://www.w3.org/1999/xhtml">"Enter a stock (press Enter for MSFT): "</span></span><span class="koboSpan" id="kobo.1796.1" xmlns="http://www.w3.org/1999/xhtml">);
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1797.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1798.1" xmlns="http://www.w3.org/1999/xhtml">? </span><span class="koboSpan" id="kobo.1798.2" xmlns="http://www.w3.org/1999/xhtml">stock = ReadLine();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1799.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.1800.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1801.1" xmlns="http://www.w3.org/1999/xhtml">string</span></span><span class="koboSpan" id="kobo.1802.1" xmlns="http://www.w3.org/1999/xhtml">.IsNullOrEmpty(stock))
{
  stock = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1803.1" xmlns="http://www.w3.org/1999/xhtml">"MSFT"</span></span><span class="koboSpan" id="kobo.1804.1" xmlns="http://www.w3.org/1999/xhtml">;
}
HubConnection hubConnection = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1805.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1806.1" xmlns="http://www.w3.org/1999/xhtml"> HubConnectionBuilder()
  .WithUrl(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1807.1" xmlns="http://www.w3.org/1999/xhtml">"https://localhost:5111/stockprice"</span></span><span class="koboSpan" id="kobo.1808.1" xmlns="http://www.w3.org/1999/xhtml">)
  .Build();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1809.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1810.1" xmlns="http://www.w3.org/1999/xhtml"> hubConnection.StartAsync();
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1811.1" xmlns="http://www.w3.org/1999/xhtml">try</span></span><span class="koboSpan" id="kobo.1812.1" xmlns="http://www.w3.org/1999/xhtml">
{
  CancellationTokenSource cts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1813.1" xmlns="http://www.w3.org/1999/xhtml">new</span></span><span class="koboSpan" id="kobo.1814.1" xmlns="http://www.w3.org/1999/xhtml">();
  IAsyncEnumerable&lt;StockPrice&gt; stockPrices = 
    hubConnection.StreamAsync&lt;StockPrice&gt;(
      </span><span class="hljs-string"><span class="koboSpan" id="kobo.1815.1" xmlns="http://www.w3.org/1999/xhtml">"GetStockPriceUpdates"</span></span><span class="koboSpan" id="kobo.1816.1" xmlns="http://www.w3.org/1999/xhtml">, stock, cts.Token);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1817.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1818.1" xmlns="http://www.w3.org/1999/xhtml">foreach</span></span><span class="koboSpan" id="kobo.1819.1" xmlns="http://www.w3.org/1999/xhtml"> (StockPrice sp </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1820.1" xmlns="http://www.w3.org/1999/xhtml">in</span></span><span class="koboSpan" id="kobo.1821.1" xmlns="http://www.w3.org/1999/xhtml"> stockPrices)
  {
    WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1822.1" xmlns="http://www.w3.org/1999/xhtml">$"</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1823.1" xmlns="http://www.w3.org/1999/xhtml">{sp.Stock}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1824.1" xmlns="http://www.w3.org/1999/xhtml"> is now </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1825.1" xmlns="http://www.w3.org/1999/xhtml">{sp.Price:C}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1826.1" xmlns="http://www.w3.org/1999/xhtml">."</span></span><span class="koboSpan" id="kobo.1827.1" xmlns="http://www.w3.org/1999/xhtml">);
    Write(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1828.1" xmlns="http://www.w3.org/1999/xhtml">"Do you want to cancel (y/n)? </span><span class="koboSpan" id="kobo.1828.2" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.1829.1" xmlns="http://www.w3.org/1999/xhtml">);
    ConsoleKey key = ReadKey().Key;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1830.1" xmlns="http://www.w3.org/1999/xhtml">if</span></span><span class="koboSpan" id="kobo.1831.1" xmlns="http://www.w3.org/1999/xhtml"> (key == ConsoleKey.Y)
    {
      cts.Cancel();
    }
    WriteLine();
  }
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1832.1" xmlns="http://www.w3.org/1999/xhtml">catch</span></span><span class="koboSpan" id="kobo.1833.1" xmlns="http://www.w3.org/1999/xhtml"> (Exception ex)
{
  WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1834.1" xmlns="http://www.w3.org/1999/xhtml">$"</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1835.1" xmlns="http://www.w3.org/1999/xhtml">{ex.GetType()}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1836.1" xmlns="http://www.w3.org/1999/xhtml"> says </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.1837.1" xmlns="http://www.w3.org/1999/xhtml">{ex.Message}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1838.1" xmlns="http://www.w3.org/1999/xhtml">"</span></span><span class="koboSpan" id="kobo.1839.1" xmlns="http://www.w3.org/1999/xhtml">);
}
WriteLine();
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1840.1" xmlns="http://www.w3.org/1999/xhtml">"Streaming download completed."</span></span><span class="koboSpan" id="kobo.1841.1" xmlns="http://www.w3.org/1999/xhtml">);
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1842.1" xmlns="http://www.w3.org/1999/xhtml">await</span></span><span class="koboSpan" id="kobo.1843.1" xmlns="http://www.w3.org/1999/xhtml"> hubConnection.SendAsync(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1844.1" xmlns="http://www.w3.org/1999/xhtml">"UploadStocks"</span></span><span class="koboSpan" id="kobo.1845.1" xmlns="http://www.w3.org/1999/xhtml">, GetStocksAsync());
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1846.1" xmlns="http://www.w3.org/1999/xhtml">"Uploading stocks to service... </span><span class="koboSpan" id="kobo.1846.2" xmlns="http://www.w3.org/1999/xhtml">(press ENTER to stop.)"</span></span><span class="koboSpan" id="kobo.1847.1" xmlns="http://www.w3.org/1999/xhtml">);
ReadLine();
WriteLine(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1848.1" xmlns="http://www.w3.org/1999/xhtml">"Ending console app."</span></span><span class="koboSpan" id="kobo.1849.1" xmlns="http://www.w3.org/1999/xhtml">);
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-431"><span class="koboSpan" id="kobo.1850.1" xmlns="http://www.w3.org/1999/xhtml">Testing the streaming service and client</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1851.1" xmlns="http://www.w3.org/1999/xhtml">Finally, we can test the </span><a id="_idIndexMarker1206"/><span class="koboSpan" id="kobo.1852.1" xmlns="http://www.w3.org/1999/xhtml">streaming data functionality:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1853.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1854.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Service.Client.Mvc</span></code><span class="koboSpan" id="kobo.1855.1" xmlns="http://www.w3.org/1999/xhtml"> project website using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1856.1" xmlns="http://www.w3.org/1999/xhtml">https</span></code><span class="koboSpan" id="kobo.1857.1" xmlns="http://www.w3.org/1999/xhtml"> profile without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1858.1" xmlns="http://www.w3.org/1999/xhtml">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1859.1" xmlns="http://www.w3.org/1999/xhtml">Northwind.SignalR.Client.Console.Streams</span></code><span class="koboSpan" id="kobo.1860.1" xmlns="http://www.w3.org/1999/xhtml"> console app without debugging.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1861.1" xmlns="http://www.w3.org/1999/xhtml">Arrange the console windows for the ASP.NET Core MVC website and the client console app so that you can see both side by side.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1862.1" xmlns="http://www.w3.org/1999/xhtml">In the client console app, press </span><em class="keystroke"><span class="koboSpan" id="kobo.1863.1" xmlns="http://www.w3.org/1999/xhtml">Enter</span></em><span class="koboSpan" id="kobo.1864.1" xmlns="http://www.w3.org/1999/xhtml"> to use the Microsoft stock code, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1865.1" xmlns="http://www.w3.org/1999/xhtml">Enter a stock (press Enter for MSFT):
MSFT is now £265.00.
</span><span class="koboSpan" id="kobo.1865.2" xmlns="http://www.w3.org/1999/xhtml">Do you want to cancel (y/n)? 
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1866.1" xmlns="http://www.w3.org/1999/xhtml">In the website console window, wait for about ten seconds, and note that several stock prices have been generated in the service but not yet sent to the client, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1867.1" xmlns="http://www.w3.org/1999/xhtml">info: Microsoft.Hosting.Lifetime[14]
      Now listening on: https://localhost:5131
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5132
info: Microsoft.Hosting.Lifetime[0]
      Application started. </span><span class="koboSpan" id="kobo.1867.2" xmlns="http://www.w3.org/1999/xhtml">Press Ctrl+C to shut down.
</span><span class="koboSpan" id="kobo.1867.3" xmlns="http://www.w3.org/1999/xhtml">info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\apps-services-net7\Chapter13\Northwind.SignalR.Service.Client.Mvc
[12/09/2022 17:52:26] MSFT at £265.00
[12/09/2022 17:52:30] MSFT at £260.78
[12/09/2022 17:52:34] MSFT at £264.86
[12/09/2022 17:52:38] MSFT at £262.10
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1868.1" xmlns="http://www.w3.org/1999/xhtml">In the client console app, press </span><em class="keystroke"><span class="koboSpan" id="kobo.1869.1" xmlns="http://www.w3.org/1999/xhtml">n</span></em><span class="koboSpan" id="kobo.1870.1" xmlns="http://www.w3.org/1999/xhtml"> to receive the next updated price. </span><span class="koboSpan" id="kobo.1870.2" xmlns="http://www.w3.org/1999/xhtml">Keep pressing </span><em class="keystroke"><span class="koboSpan" id="kobo.1871.1" xmlns="http://www.w3.org/1999/xhtml">n</span></em><span class="koboSpan" id="kobo.1872.1" xmlns="http://www.w3.org/1999/xhtml"> until the prices have been sent from the service and read by the client, and then press </span><em class="keystroke"><span class="koboSpan" id="kobo.1873.1" xmlns="http://www.w3.org/1999/xhtml">y</span></em><span class="koboSpan" id="kobo.1874.1" xmlns="http://www.w3.org/1999/xhtml">, and note that a cancellation token is received by the SignalR service so it stops, and the client now starts uploading stocks, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1875.1" xmlns="http://www.w3.org/1999/xhtml">MSFT is now £260.78.
</span><span class="koboSpan" id="kobo.1875.2" xmlns="http://www.w3.org/1999/xhtml">Do you want to cancel (y/n)? </span><span class="koboSpan" id="kobo.1875.3" xmlns="http://www.w3.org/1999/xhtml">n
MSFT is now £264.86.
</span><span class="koboSpan" id="kobo.1875.4" xmlns="http://www.w3.org/1999/xhtml">Do you want to cancel (y/n)? </span><span class="koboSpan" id="kobo.1875.5" xmlns="http://www.w3.org/1999/xhtml">n
MSFT is now £262.10.
</span><span class="koboSpan" id="kobo.1875.6" xmlns="http://www.w3.org/1999/xhtml">Do you want to cancel (y/n)? </span><span class="koboSpan" id="kobo.1875.7" xmlns="http://www.w3.org/1999/xhtml">y
System.Threading.Tasks.TaskCanceledException says A task was canceled.
</span><span class="koboSpan" id="kobo.1875.8" xmlns="http://www.w3.org/1999/xhtml">Streaming download completed.
</span><span class="koboSpan" id="kobo.1875.9" xmlns="http://www.w3.org/1999/xhtml">Uploading stocks to service... </span><span class="koboSpan" id="kobo.1875.10" xmlns="http://www.w3.org/1999/xhtml">(press ENTER to stop.)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1876.1" xmlns="http://www.w3.org/1999/xhtml">In the website console window, note that the random stock codes are received, as shown in the following output:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1877.1" xmlns="http://www.w3.org/1999/xhtml">Receiving PJON from client...
</span><span class="koboSpan" id="kobo.1877.2" xmlns="http://www.w3.org/1999/xhtml">Receiving VWJD from client...
</span><span class="koboSpan" id="kobo.1877.3" xmlns="http://www.w3.org/1999/xhtml">Receiving HMOJ from client...
</span><span class="koboSpan" id="kobo.1877.4" xmlns="http://www.w3.org/1999/xhtml">Receiving QQMQ from client...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1878.1" xmlns="http://www.w3.org/1999/xhtml">Close both </span><a id="_idIndexMarker1207"/><span class="koboSpan" id="kobo.1879.1" xmlns="http://www.w3.org/1999/xhtml">console windows.</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-432"><span class="koboSpan" id="kobo.1880.1" xmlns="http://www.w3.org/1999/xhtml">Practicing and exploring</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1881.1" xmlns="http://www.w3.org/1999/xhtml">Test your knowledge and understanding by answering some questions, getting some hands-on practice, and exploring this chapter’s topics with deeper research.</span></p>
<h2 class="heading-2" id="_idParaDest-433"><span class="koboSpan" id="kobo.1882.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 11.1 – Test your knowledge</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1883.1" xmlns="http://www.w3.org/1999/xhtml">Answer the following questions:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1884.1" xmlns="http://www.w3.org/1999/xhtml">What transports does SignalR use, and which is the default?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1885.1" xmlns="http://www.w3.org/1999/xhtml">What is a good practice for RPC method signature design?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1886.1" xmlns="http://www.w3.org/1999/xhtml">What tool can you use to download the SignalR JavaScript library?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1887.1" xmlns="http://www.w3.org/1999/xhtml">What happens if you send a SignalR message to a client with a connection ID that does not exist? </span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1888.1" xmlns="http://www.w3.org/1999/xhtml">What are the benefits of separating a SignalR service from other ASP.NET Core components? </span></li>
</ol>
<h2 class="heading-2" id="_idParaDest-434"><span class="koboSpan" id="kobo.1889.1" xmlns="http://www.w3.org/1999/xhtml">Exercise 11.2 – Explore topics</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1890.1" xmlns="http://www.w3.org/1999/xhtml">Use the links on the following page to learn more details about the topics covered in this chapter:</span></p>
<p class="normal"><a href="https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-11---broadcasting-real-time-communication-using-signalr"><span class="url"><span class="koboSpan" id="kobo.1891.1" xmlns="http://www.w3.org/1999/xhtml">https://github.com/markjprice/apps-services-net8/blob/main/docs/book-links.md#chapter-11---broadcasting-real-time-communication-using-signalr</span></span></a></p>
<h1 class="heading-1" id="_idParaDest-435"><span class="koboSpan" id="kobo.1892.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1893.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, you learned about:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1894.1" xmlns="http://www.w3.org/1999/xhtml">The history of technologies before SignalR.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1895.1" xmlns="http://www.w3.org/1999/xhtml">The concepts and technologies that underpin SignalR.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1896.1" xmlns="http://www.w3.org/1999/xhtml">Implementing the chat functionality using SignalR, including building a hub hosted in a website project, and clients using JavaScript and a .NET console app.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1897.1" xmlns="http://www.w3.org/1999/xhtml">Downloading and uploading streams of data using SignalR.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1898.1" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, you will learn about GraphQL, another standard that enables client control over the data returned from a service.</span></p>
</div>
</body>
</html>
